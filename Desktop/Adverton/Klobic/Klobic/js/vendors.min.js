function isMobileSafari(){return navigator.userAgent.match(/(iPod|iPhone|iPad)/)}function isMobileDevice(){return testDevice(mobileArray)}function isStupidMobile(){return testDevice(noFontFace)}function isSmallMobile(){return isMobileDevice()&&$(window).width()*$(window).height()<=307200}function testDevice(t){var e;for(e=0;e<t.length;e++)if(navigator.appVersion.indexOf(t[e])>-1)return!0;for(e=0;e<t.length;e++)if(navigator.userAgent.indexOf(t[e])>-1)return!0;return!1}(function(){var t=this,e=t._,i={},n=Array.prototype,r=Object.prototype,a=Function.prototype,o=n.push,s=n.slice,l=n.concat,c=r.toString,u=r.hasOwnProperty,h=n.forEach,d=n.map,f=n.reduce,p=n.reduceRight,g=n.filter,m=n.every,v=n.some,y=n.indexOf,b=n.lastIndexOf,w=Array.isArray,x=Object.keys,I=a.bind,k=function(t){return t instanceof k?t:this instanceof k?void(this._wrapped=t):new k(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):t._=k,k.VERSION="1.4.3";var M=k.each=k.forEach=function(t,e,n){if(null!=t)if(h&&t.forEach===h)t.forEach(e,n);else if(t.length===+t.length){for(var r=0,a=t.length;r<a;r++)if(e.call(n,t[r],r,t)===i)return}else for(var o in t)if(k.has(t,o)&&e.call(n,t[o],o,t)===i)return};k.map=k.collect=function(t,e,i){var n=[];return null==t?n:d&&t.map===d?t.map(e,i):(M(t,function(t,r,a){n[n.length]=e.call(i,t,r,a)}),n)};var T="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),f&&t.reduce===f)return n&&(e=k.bind(e,n)),r?t.reduce(e,i):t.reduce(e);if(M(t,function(t,a,o){r?i=e.call(n,i,t,a,o):(i=t,r=!0)},n),!r)throw new TypeError(T);return i},k.reduceRight=k.foldr=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),p&&t.reduceRight===p)return n&&(e=k.bind(e,n)),r?t.reduceRight(e,i):t.reduceRight(e);var a=t.length;if(a!==+a){var o=k.keys(t);a=o.length}if(M(t,function(s,l,c){l=o?o[--a]:--a,r?i=e.call(n,i,t[l],l,c):(i=t[l],r=!0)}),!r)throw new TypeError(T);return i},k.find=k.detect=function(t,e,i){var n;return _(t,function(t,r,a){if(e.call(i,t,r,a))return n=t,!0}),n},k.filter=k.select=function(t,e,i){var n=[];return null==t?n:g&&t.filter===g?t.filter(e,i):(M(t,function(t,r,a){e.call(i,t,r,a)&&(n[n.length]=t)}),n)},k.reject=function(t,e,i){return k.filter(t,function(t,n,r){return!e.call(i,t,n,r)},i)},k.every=k.all=function(t,e,n){e||(e=k.identity);var r=!0;return null==t?r:m&&t.every===m?t.every(e,n):(M(t,function(t,a,o){if(!(r=r&&e.call(n,t,a,o)))return i}),!!r)};var _=k.some=k.any=function(t,e,n){e||(e=k.identity);var r=!1;return null==t?r:v&&t.some===v?t.some(e,n):(M(t,function(t,a,o){if(r||(r=e.call(n,t,a,o)))return i}),!!r)};k.contains=k.include=function(t,e){return null!=t&&(y&&t.indexOf===y?-1!=t.indexOf(e):_(t,function(t){return t===e}))},k.invoke=function(t,e){var i=s.call(arguments,2);return k.map(t,function(t){return(k.isFunction(e)?e:t[e]).apply(t,i)})},k.pluck=function(t,e){return k.map(t,function(t){return t[e]})},k.where=function(t,e,i){return k.isEmpty(e)?i?null:[]:k[i?"find":"filter"](t,function(t){for(var i in e)if(e[i]!==t[i])return!1;return!0})},k.max=function(t,e,i){if(!e&&k.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&k.isEmpty(t))return-1/0;var n={computed:-1/0,value:-1/0};return M(t,function(t,r,a){var o=e?e.call(i,t,r,a):t;o>=n.computed&&(n={value:t,computed:o})}),n.value},k.min=function(t,e,i){if(!e&&k.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&k.isEmpty(t))return 1/0;var n={computed:1/0,value:1/0};return M(t,function(t,r,a){var o=e?e.call(i,t,r,a):t;o<n.computed&&(n={value:t,computed:o})}),n.value},k.shuffle=function(t){var e,i=0,n=[];return M(t,function(t){e=k.random(i++),n[i-1]=n[e],n[e]=t}),n};var S=function(t){return k.isFunction(t)?t:function(e){return e[t]}};k.sortBy=function(t,e,i){var n=S(e);return k.pluck(k.map(t,function(t,e,r){return{value:t,index:e,criteria:n.call(i,t,e,r)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index<e.index?-1:1}),"value")};var C=function(t,e,i,n){var r={},a=S(e||k.identity);return M(t,function(e,o){var s=a.call(i,e,o,t);n(r,s,e)}),r};k.groupBy=function(t,e,i){return C(t,e,i,function(t,e,i){(k.has(t,e)?t[e]:t[e]=[]).push(i)})},k.countBy=function(t,e,i){return C(t,e,i,function(t,e){k.has(t,e)||(t[e]=0),t[e]++})},k.sortedIndex=function(t,e,i,n){i=null==i?k.identity:S(i);for(var r=i.call(n,e),a=0,o=t.length;a<o;){var s=a+o>>>1;i.call(n,t[s])<r?a=s+1:o=s}return a},k.toArray=function(t){return t?k.isArray(t)?s.call(t):t.length===+t.length?k.map(t,k.identity):k.values(t):[]},k.size=function(t){return null==t?0:t.length===+t.length?t.length:k.keys(t).length},k.first=k.head=k.take=function(t,e,i){if(null!=t)return null==e||i?t[0]:s.call(t,0,e)},k.initial=function(t,e,i){return s.call(t,0,t.length-(null==e||i?1:e))},k.last=function(t,e,i){if(null!=t)return null==e||i?t[t.length-1]:s.call(t,Math.max(t.length-e,0))},k.rest=k.tail=k.drop=function(t,e,i){return s.call(t,null==e||i?1:e)},k.compact=function(t){return k.filter(t,k.identity)};var E=function(t,e,i){return M(t,function(t){k.isArray(t)?e?o.apply(i,t):E(t,e,i):i.push(t)}),i};k.flatten=function(t,e){return E(t,e,[])},k.without=function(t){return k.difference(t,s.call(arguments,1))},k.uniq=k.unique=function(t,e,i,n){k.isFunction(e)&&(n=i,i=e,e=!1);var r=i?k.map(t,i,n):t,a=[],o=[];return M(r,function(i,n){(e?n&&o[o.length-1]===i:k.contains(o,i))||(o.push(i),a.push(t[n]))}),a},k.union=function(){return k.uniq(l.apply(n,arguments))},k.intersection=function(t){var e=s.call(arguments,1);return k.filter(k.uniq(t),function(t){return k.every(e,function(e){return k.indexOf(e,t)>=0})})},k.difference=function(t){var e=l.apply(n,s.call(arguments,1));return k.filter(t,function(t){return!k.contains(e,t)})},k.zip=function(){for(var t=s.call(arguments),e=k.max(k.pluck(t,"length")),i=new Array(e),n=0;n<e;n++)i[n]=k.pluck(t,""+n);return i},k.object=function(t,e){if(null==t)return{};for(var i={},n=0,r=t.length;n<r;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},k.indexOf=function(t,e,i){if(null==t)return-1;var n=0,r=t.length;if(i){if("number"!=typeof i)return n=k.sortedIndex(t,e),t[n]===e?n:-1;n=i<0?Math.max(0,r+i):i}if(y&&t.indexOf===y)return t.indexOf(e,i);for(;n<r;n++)if(t[n]===e)return n;return-1},k.lastIndexOf=function(t,e,i){if(null==t)return-1;var n=null!=i;if(b&&t.lastIndexOf===b)return n?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var r=n?i:t.length;r--;)if(t[r]===e)return r;return-1},k.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),r=0,a=new Array(n);r<n;)a[r++]=t,t+=i;return a};var A=function(){};k.bind=function(t,e){var i,n;if(t.bind===I&&I)return I.apply(t,s.call(arguments,1));if(!k.isFunction(t))throw new TypeError;return i=s.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,i.concat(s.call(arguments)));A.prototype=t.prototype;var r=new A;A.prototype=null;var a=t.apply(r,i.concat(s.call(arguments)));return Object(a)===a?a:r}},k.bindAll=function(t){var e=s.call(arguments,1);return 0==e.length&&(e=k.functions(t)),M(e,function(e){t[e]=k.bind(t[e],t)}),t},k.memoize=function(t,e){var i={};return e||(e=k.identity),function(){var n=e.apply(this,arguments);return k.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},k.delay=function(t,e){var i=s.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},k.defer=function(t){return k.delay.apply(k,[t,1].concat(s.call(arguments,1)))},k.throttle=function(t,e){var i,n,r,a,o=0,s=function(){o=new Date,r=null,a=t.apply(i,n)};return function(){var l=new Date,c=e-(l-o);return i=this,n=arguments,c<=0?(clearTimeout(r),r=null,o=l,a=t.apply(i,n)):r||(r=setTimeout(s,c)),a}},k.debounce=function(t,e,i){var n,r;return function(){var a=this,o=arguments,s=function(){n=null,i||(r=t.apply(a,o))},l=i&&!n;return clearTimeout(n),n=setTimeout(s,e),l&&(r=t.apply(a,o)),r}},k.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},k.wrap=function(t,e){return function(){var i=[t];return o.apply(i,arguments),e.apply(this,i)}},k.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},k.after=function(t,e){return t<=0?e():function(){if(--t<1)return e.apply(this,arguments)}},k.keys=x||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)k.has(t,i)&&(e[e.length]=i);return e},k.values=function(t){var e=[];for(var i in t)k.has(t,i)&&e.push(t[i]);return e},k.pairs=function(t){var e=[];for(var i in t)k.has(t,i)&&e.push([i,t[i]]);return e},k.invert=function(t){var e={};for(var i in t)k.has(t,i)&&(e[t[i]]=i);return e},k.functions=k.methods=function(t){var e=[];for(var i in t)k.isFunction(t[i])&&e.push(i);return e.sort()},k.extend=function(t){return M(s.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},k.pick=function(t){var e={},i=l.apply(n,s.call(arguments,1));return M(i,function(i){i in t&&(e[i]=t[i])}),e},k.omit=function(t){var e={},i=l.apply(n,s.call(arguments,1));for(var r in t)k.contains(i,r)||(e[r]=t[r]);return e},k.defaults=function(t){return M(s.call(arguments,1),function(e){if(e)for(var i in e)null==t[i]&&(t[i]=e[i])}),t},k.clone=function(t){return k.isObject(t)?k.isArray(t)?t.slice():k.extend({},t):t},k.tap=function(t,e){return e(t),t};var O=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof k&&(t=t._wrapped),e instanceof k&&(e=e._wrapped);var r=c.call(t);if(r!=c.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var a=i.length;a--;)if(i[a]==t)return n[a]==e;i.push(t),n.push(e);var o=0,s=!0;if("[object Array]"==r){if(o=t.length,s=o==e.length)for(;o--&&(s=O(t[o],e[o],i,n)););}else{var l=t.constructor,u=e.constructor;if(l!==u&&!(k.isFunction(l)&&l instanceof l&&k.isFunction(u)&&u instanceof u))return!1;for(var h in t)if(k.has(t,h)&&(o++,!(s=k.has(e,h)&&O(t[h],e[h],i,n))))break;if(s){for(h in e)if(k.has(e,h)&&!o--)break;s=!o}}return i.pop(),n.pop(),s};k.isEqual=function(t,e){return O(t,e,[],[])},k.isEmpty=function(t){if(null==t)return!0;if(k.isArray(t)||k.isString(t))return 0===t.length;for(var e in t)if(k.has(t,e))return!1;return!0},k.isElement=function(t){return!(!t||1!==t.nodeType)},k.isArray=w||function(t){return"[object Array]"==c.call(t)},k.isObject=function(t){return t===Object(t)},M(["Arguments","Function","String","Number","Date","RegExp"],function(t){k["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}}),k.isArguments(arguments)||(k.isArguments=function(t){return!(!t||!k.has(t,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(t){return"function"==typeof t}),k.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},k.isNaN=function(t){return k.isNumber(t)&&t!=+t},k.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==c.call(t)},k.isNull=function(t){return null===t},k.isUndefined=function(t){return void 0===t},k.has=function(t,e){return u.call(t,e)},k.noConflict=function(){return t._=e,this},k.identity=function(t){return t},k.times=function(t,e,i){for(var n=Array(t),r=0;r<t;r++)n[r]=e.call(i,r);return n},k.random=function(t,e){return null==e&&(e=t,t=0),t+(0|Math.random()*(e-t+1))};var H={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};H.unescape=k.invert(H.escape);var N={escape:new RegExp("["+k.keys(H.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(H.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(t){k[t]=function(e){return null==e?"":(""+e).replace(N[t],function(e){return H[t][e]})}}),k.result=function(t,e){if(null==t)return null;var i=t[e];return k.isFunction(i)?i.call(t):i},k.mixin=function(t){M(k.functions(t),function(e){var i=k[e]=t[e];k.prototype[e]=function(){var t=[this._wrapped];return o.apply(t,arguments),z.call(this,i.apply(k,t))}})};var P=0;k.uniqueId=function(t){var e=""+ ++P;return t?t+e:e},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var $=/(.)^/,D={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};k.template=function(t,e,i){i=k.defaults({},i,k.templateSettings);var n=new RegExp([(i.escape||$).source,(i.interpolate||$).source,(i.evaluate||$).source].join("|")+"|$","g"),r=0,a="__p+='";t.replace(n,function(e,i,n,o,s){return a+=t.slice(r,s).replace(/\\|'|\r|\n|\t|\u2028|\u2029/g,function(t){return"\\"+D[t]}),i&&(a+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(a+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),o&&(a+="';\n"+o+"\n__p+='"),r=s+e.length,e}),a+="';\n",i.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var o=new Function(i.variable||"obj","_",a)}catch(t){throw t.source=a,t}if(e)return o(e,k);var s=function(t){return o.call(this,t,k)};return s.source="function("+(i.variable||"obj")+"){\n"+a+"}",s},k.chain=function(t){return k(t).chain()};var z=function(t){return this._chain?k(t).chain():t};k.mixin(k),M(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];k.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],z.call(this,i)}}),M(["concat","join","slice"],function(t){var e=n[t];k.prototype[t]=function(){return z.call(this,e.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),function(){var t,e=this,i=e.Backbone,n=[],r=n.push,a=n.slice,o=n.splice;t="undefined"!=typeof exports?exports:e.Backbone={},t.VERSION="0.9.9";var s=e._;s||"undefined"==typeof require||(s=require("underscore")),t.$=e.jQuery||e.Zepto||e.ender,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var l=/\s+/,c=function(t,e,i,n){if(!i)return!0;if("object"==typeof i)for(var r in i)t[e].apply(t,[r,i[r]].concat(n));else{if(!l.test(i))return!0;for(var a=i.split(l),o=0,s=a.length;o<s;o++)t[e].apply(t,[a[o]].concat(n))}},u=function(t,e,i){var n,r=-1,a=e.length;switch(i.length){case 0:for(;++r<a;)(n=e[r]).callback.call(n.ctx);return;case 1:for(;++r<a;)(n=e[r]).callback.call(n.ctx,i[0]);return;case 2:for(;++r<a;)(n=e[r]).callback.call(n.ctx,i[0],i[1]);return;case 3:for(;++r<a;)(n=e[r]).callback.call(n.ctx,i[0],i[1],i[2]);return;default:for(;++r<a;)(n=e[r]).callback.apply(n.ctx,i)}},h=t.Events={on:function(t,e,i){return c(this,"on",t,[e,i])&&e?(this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:i,ctx:i||this}),this):this},once:function(t,e,i){if(!c(this,"once",t,[e,i])||!e)return this;var n=this,r=s.once(function(){n.off(t,r),e.apply(this,arguments)});return r._callback=e,this.on(t,r,i),this},off:function(t,e,i){var n,r,a,o,l,u,h,d;if(!this._events||!c(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events={},this;for(o=t?[t]:s.keys(this._events),l=0,u=o.length;l<u;l++)if(t=o[l],n=this._events[t]){if(a=[],e||i)for(h=0,d=n.length;h<d;h++)r=n[h],(e&&e!==(r.callback._callback||r.callback)||i&&i!==r.context)&&a.push(r);this._events[t]=a}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!c(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&u(0,i,e),n&&u(0,n,arguments),this},listenTo:function(t,e,i){return(this._listeners||(this._listeners={}))[t._listenerId||(t._listenerId=s.uniqueId("l"))]=t,t.on(e,i||this,this),this},stopListening:function(t,e,i){var n=this._listeners;if(n){if(t)t.off(e,i,this),e||i||delete n[t._listenerId];else{for(var r in n)n[r].off(null,null,this);this._listeners={}}return this}}};h.bind=h.on,h.unbind=h.off,s.extend(t,h);var d=t.Model=function(t,e){var i,n=t||{};this.cid=s.uniqueId("c"),this.changed={},this.attributes={},this._changes=[],e&&e.collection&&(this.collection=e.collection),e&&e.parse&&(n=this.parse(n)),(i=s.result(this,"defaults"))&&s.defaults(n,i),this.set(n,{silent:!0}),this._currentAttributes=s.clone(this.attributes),this._previousAttributes=s.clone(this.attributes),this.initialize.apply(this,arguments)};s.extend(d.prototype,h,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return s.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return s.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var n,r;if(null==t)return this;s.isObject(t)?(r=t,i=e):(r={})[t]=e;var a=i&&i.silent,o=i&&i.unset;if(!this._validate(r,i))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var l=this.attributes;for(n in r)e=r[n],o?delete l[n]:l[n]=e,this._changes.push(n,e);return this._hasComputed=!1,a||this.change(i),this},unset:function(t,e){return this.set(t,void 0,s.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,s.extend({},t,{unset:!0}))},fetch:function(t){t=t?s.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n,r,a){return!!e.set(e.parse(n),t)&&void(i&&i(e,n,t))},this.sync("read",this,t)},save:function(t,e,i){var n,r,a;if(null==t||s.isObject(t)?(n=t,i=e):null!=t&&((n={})[t]=e),i=i?s.clone(i):{},i.wait){if(n&&!this._validate(n,i))return!1;r=s.clone(this.attributes)}var o=s.extend({},i,{silent:!0});if(n&&!this.set(n,i.wait?o:i))return!1;if(!n&&!this._validate(null,i))return!1;var l=this,c=i.success;i.success=function(t,e,r){a=!0;var o=l.parse(t);return i.wait&&(o=s.extend(n||{},o)),!!l.set(o,i)&&void(c&&c(l,t,i))};var u=this.isNew()?"create":i.patch?"patch":"update";"patch"==u&&(i.attrs=n);var h=this.sync(u,this,i);return!a&&i.wait&&(this.clear(o),this.set(r,o)),h},destroy:function(t){t=t?s.clone(t):{};var e=this,i=t.success,n=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(r){(t.wait||e.isNew())&&n(),i&&i(e,r,t)},this.isNew())return t.success(),!1;var r=this.sync("delete",this,t);return t.wait||n(),r},url:function(){var t=s.result(this,"urlRoot")||s.result(this.collection,"url")||M();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(t){var e=this._changing;this._changing=!0;var i=this._computeChanges(!0);this._pending=!!i.length||t&&t.forceChange;for(var n=i.length-2;n>=0;n-=2)this.trigger("change:"+i[n],this,i[n+1],t);if(e)return this;for(;this._pending;)this._pending=!1,this.trigger("change",this,t),this._previousAttributes=s.deepClone(this.attributes,!0);return this._changing=!1,this},hasChanged:function(t){return this._hasComputed||this._computeChanges(),null==t?!s.isEmpty(this.changed):s.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&s.clone(this.changed);var e,i=!1,n=this._previousAttributes;for(var r in t)s.isEqual(n[r],e=t[r])||((i||(i={}))[r]=e);return i},_computeChanges:function(t){this.changed={};for(var e={},i=[],n=this._previousAttributes,r=this._changes,a=r.length-2;a>=0;a-=2){var o=r[a],s=r[a+1];if(!e[o]&&(e[o]=!0,n[o]!==s)){if(this.changed[o]=s,!t)continue;i.push(o,s),n[o]=s}}return t&&(this._changes=[]),this._hasComputed=!0,i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},_validate:function(t,e){if(!this.validate)return!0;t=s.extend({},this.attributes,t);var i=this.validate(t,e);return!i||(e&&e.error&&e.error(this,i,e),this.trigger("error",this,i,e),!1)}});var f=t.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,s.extend({silent:!0},e))};s.extend(f.prototype,h,{model:d,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){var i,n,a,l,c,u=e&&e.at,h=null==(e&&e.sort)||e.sort;for(t=s.isArray(t)?t.slice():[t],i=t.length-1;i>=0;i--)(a=this._prepareModel(t[i],e))?(t[i]=a,l=null!=a.id&&this._byId[a.id],l||this._byCid[a.cid]?(e&&e.merge&&l&&(l.set(a.attributes,e),c=h),t.splice(i,1)):(a.on("all",this._onModelEvent,this),this._byCid[a.cid]=a,null!=a.id&&(this._byId[a.id]=a))):(this.trigger("error",this,t[i],e),t.splice(i,1));if(t.length&&(c=h),this.length+=t.length,n=[null!=u?u:this.models.length,0],r.apply(n,t),o.apply(this.models,n),c&&this.comparator&&null==u&&this.sort({silent:!0}),e&&e.silent)return this;for(;a=t.shift();)a.trigger("add",a,this,e);return this},remove:function(t,e){var i,n,r,a;for(e||(e={}),t=s.isArray(t)?t.slice():[t],i=0,n=t.length;i<n;i++)(a=this.get(t[i]))&&(delete this._byId[a.id],delete this._byCid[a.cid],r=this.indexOf(a),this.models.splice(r,1),this.length--,e.silent||(e.index=r,a.trigger("remove",a,this,e)),this._removeReference(a));return this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,s.extend({at:this.length},e)),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,s.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(t,e){return this.models.slice(t,e)},get:function(t){if(null!=t)return this._byId[null!=t.id?t.id:t]||this._byCid[t.cid||t]},at:function(t){return this.models[t]},where:function(t){return s.isEmpty(t)?[]:this.filter(function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),t&&t.silent||this.trigger("sort",this,t),this},pluck:function(t){return s.invoke(this.models,"get",t)},update:function(t,e){var i,n,r,a,o=[],l=[],c={},u=this.model.prototype.idAttribute;if(e=s.extend({add:!0,merge:!0,remove:!0},e),e.parse&&(t=this.parse(t)),s.isArray(t)||(t=t?[t]:[]),e.add&&!e.remove)return this.add(t,e);for(n=0,r=t.length;n<r;n++)i=t[n],a=this.get(i.id||i.cid||i[u]),e.remove&&a&&(c[a.cid]=!0),(e.add&&!a||e.merge&&a)&&o.push(i);if(e.remove)for(n=0,r=this.models.length;n<r;n++)i=this.models[n],c[i.cid]||l.push(i);return l.length&&this.remove(l,e),o.length&&this.add(o,e),this},reset:function(t,e){e||(e={}),e.parse&&(t=this.parse(t));for(var i=0,n=this.models.length;i<n;i++)this._removeReference(this.models[i]);return e.previousModels=this.models,this._reset(),t&&this.add(t,s.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},fetch:function(t){t=t?s.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n,r,a){var o=t.update?"update":"reset";e[o](n,t),i&&i(e,n,t)},this.sync("read",this,t)},create:function(t,e){var i=this;if(e=e?s.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||i.add(t,e);var n=e.success;return e.success=function(t,e,r){r.wait&&i.add(t,r),n&&n(t,e,r)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},chain:function(){return s(this.models).chain()},_reset:function(){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(t,e){if(t instanceof d)return t.collection||(t.collection=this),t;e||(e={}),e.collection=this;var i=t.model||this.model,n=new i(t,e);return!!n._validate(t,e)&&n},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var p=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortedIndex","toArray","size","first","head","take","initial","rest","tail","last","without","indexOf","shuffle","lastIndexOf","isEmpty"];s.each(p,function(t){f.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),s[t].apply(s,e)}});var g=["groupBy","countBy","sortBy"];s.each(g,function(t){f.prototype[t]=function(e,i){var n=s.isFunction(e)?e:function(t){return t.get(e)};return s[t](this.models,n,i)}});var m=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};s.extend(m.prototype,h,{initialize:function(){},route:function(e,i,n){return s.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[i]),t.history.route(e,s.bind(function(r){var a=this._extractParameters(e,r);n&&n.apply(this,a),this.trigger.apply(this,["route:"+i].concat(a)),t.history.trigger("route",this,i,a)},this)),this},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes)for(var t,e=s.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])},_routeToRegExp:function(t){return t=t.replace(/[\-{}\[\]+?.,\\\^$|#\s]/g,"\\$&").replace(/\((.*?)\)/g,"(?:$1)?").replace(/:\w+/g,"([^/]+)").replace(/\*\w+/g,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){return t.exec(e).slice(1)}});var v=t.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},y=/^[#\/]|\s+$/g,b=/msie [\w.]+/;v.started=!1,s.extend(v.prototype,h,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(/\/$/,"");t.indexOf(i)||(t=t.substr(i.length))}else t=this.getHash();return t.replace(y,"")},start:function(e){if(v.started)throw new Error("Backbone.history has already been started");v.started=!0,this.options=s.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),n=document.documentMode,r=b.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(/^\/+|\/+$/g,"/"),r&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?t.$(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?t.$(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var a=this.location,o=a.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!o?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&o&&a.hash&&(this.fragment=this.getHash().replace(y,""),this.history.replaceState({},document.title,this.root+this.fragment+a.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){t.$(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),v.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e!==this.fragment&&(this.iframe&&this.navigate(e),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(t){var e=this.fragment=this.getFragment(t);return s.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(t,e){if(!v.started)return!1;if(e&&!0!==e||(e={trigger:e}),t=this.getFragment(t||""),this.fragment!==t){this.fragment=t;var i=this.root+t;if(this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}e.trigger&&this.loadUrl(t)}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),t.history=new v;var w=t.View=function(t){this.cid=s.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},x=["model","collection","el","id","attributes","className","tagName","events"];s.extend(w.prototype,h,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},make:function(e,i,n){var r=document.createElement(e);return i&&t.$(r).attr(i),null!=n&&t.$(r).html(n),r},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],!1!==i&&this.delegateEvents(),this},delegateEvents:function(t){if(t||(t=s.result(this,"events"))){this.undelegateEvents();for(var e in t){var i=t[e];if(s.isFunction(i)||(i=this[t[e]]),!i)throw new Error('Method "'+t[e]+'" does not exist');var n=e.match(/^(\S+)\s*(.*)$/),r=n[1],a=n[2];i=s.bind(i,this),r+=".delegateEvents"+this.cid,""===a?this.$el.bind(r,i):this.$el.delegate(a,r,i)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(t){this.options&&(t=s.extend({},s.result(this,"options"),t)),s.extend(this,s.pick(t,x)),this.options=t},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var t=s.extend({},s.result(this,"attributes"));this.id&&(t.id=s.result(this,"id")),this.className&&(t.class=s.result(this,"className")),this.setElement(this.make(s.result(this,"tagName"),t),!1)}}});var I={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.sync=function(e,i,n){var r=I[e];s.defaults(n||(n={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var a={type:r,dataType:"json"};if(n.url||(a.url=s.result(i,"url")||M()),null!=n.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(a.contentType="application/json",a.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),n.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){a.type="POST",n.emulateJSON&&(a.data._method=r);var o=n.beforeSend;n.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",r),o)return o.apply(this,arguments)}}"GET"===a.type||n.emulateJSON||(a.processData=!1);var l=n.success;n.success=function(t,e,r){l&&l(t,e,r),i.trigger("sync",i,t,n)};var c=n.error;n.error=function(t,e,r){c&&c(i,t,n),i.trigger("error",i,t,n)};var u=t.ajax(s.extend(a,n));return i.trigger("request",i,u,n),u},t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var k=function(t,e){var i,n=this;i=t&&s.has(t,"constructor")?t.constructor:function(){n.apply(this,arguments)},s.extend(i,n,e);var r=function(){this.constructor=i};return r.prototype=n.prototype,i.prototype=new r,t&&s.extend(i.prototype,t),
i.__super__=n.prototype,i};d.extend=f.extend=m.extend=w.extend=v.extend=k;var M=function(){throw new Error('A "url" property or function must be specified')}}.call(this);var alignManager={snapDistance:4,getRotatedRectangle:function(t){for(var e=Math.sin(t.angle*Math.PI/180),i=Math.cos(t.angle*Math.PI/180),n=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],r=t.x+t.width,a=t.y+t.height,o=t.x,s=t.y,l=0;l<n.length;l++){var c=n[l].x-t.center.x,u=n[l].y-t.center.y,h=Math.round(c*i-u*e),d=Math.round(c*e+u*i);r=Math.min(h+t.center.x,r),a=Math.min(d+t.center.y,a),o=Math.max(h+t.center.x,o),s=Math.max(d+t.center.y,s)}return{x:r,y:a,width:o-r,height:s-a,xy:r+o-r,yx:a+s-a,center:new Point(r+(o-r)/2,a+(s-a)/2),angle:t.angle}},getBannerMetrics:function(){var t={x:0,y:0,width:Number(editor.banner.get("width")),height:Number(editor.banner.get("height")),angle:0};return{x:0,y:0,width:t.width,height:t.height,xy:t.width,yx:t.height,center:new Point(t.x+t.width/2,t.y+t.height/2),angle:t.angle}},getModelMetrics:function(t){var e={x:Number(t.get("x")),y:Number(t.get("y")),width:Number(t.get("width")),height:Number(t.get("height")),angle:t.get("rotation")?Number(t.get("rotation")):0},i={x:e.x,y:e.y,width:e.width,height:e.height,xy:e.x+e.width,yx:e.y+e.height,center:new Point(e.x+e.width/2,e.y+e.height/2),angle:e.angle};return 0!==e.angle?this.getRotatedRectangle(i):i},getSlideElements:function(t,e,i){var n=[];_.isArray(e)?n=e:n.push(e);for(var r=[],a=0;a<t.elements.models.length;a++)n.indexOf(t.elements.models[a])>-1?i&&r.push(t.elements.models[a]):1==t.elements.models[a].get("visible")&&r.push(t.elements.models[a]);return r},getElementsMetrics:function(t){for(var e=[],i=0;i<t.length;i++)e.push(this.getModelMetrics(t[i]));return e.push(this.getBannerMetrics()),e},alignSelected:function(t,e){var i=_.clone(t),n={x:i.x,y:i.y,width:i.width,height:i.height,angle:i.rotation?i.rotation:0,center:new Point(i.x+i.width/2,i.y+i.height/2)},r={},a=!1,o=!1;0!==n.angle?(r=this.getRotatedRectangle(_.clone(n)),r.x=r.xy-r.width,r.y=r.yx-r.height,r.deltaX=n.x-r.x,r.deltaY=n.y-r.y):(r=n,r.deltaX=0,r.deltaY=0);for(var s=0;s<e.length;s++){var l=e[s],c=i.x,u=i.y;if(r.x>=l.x-this.snapDistance&&r.x<=l.x+this.snapDistance&&(c=l.x+r.deltaX,editor.stage.showGuide(c-r.deltaX,"vertical"),o=!0),r.x+r.width>=l.xy-this.snapDistance&&r.x+r.width<=l.xy+this.snapDistance&&(c=l.x+(l.width-r.width)+r.deltaX,editor.stage.showGuide(c+r.width-r.deltaX-1,"vertical"),o=!0),r.x+r.width/2>=l.center.x-this.snapDistance&&r.x+r.width/2<=l.center.x+this.snapDistance&&(c=Math.round(l.x+r.deltaX+(l.width-r.width)/2),editor.stage.showGuide(c-r.deltaX+Math.round(r.width/2),"vertical"),o=!0),r.y>=l.y-this.snapDistance&&r.y<=l.y+this.snapDistance&&(u=l.y+r.deltaY,editor.stage.showGuide(u-r.deltaY,"horizontal"),a=!0),r.y+r.height>=l.yx-this.snapDistance&&r.y+r.height<=l.yx+this.snapDistance&&(u=l.y+(l.height-r.height)+r.deltaY,editor.stage.showGuide(u+r.height-r.deltaY-1,"horizontal"),a=!0),r.y+r.height/2>=l.center.y-this.snapDistance&&r.y+r.height/2<=l.center.y+this.snapDistance&&(u=Math.round(l.y+r.deltaY+(l.height-r.height)/2),editor.stage.showGuide(u-r.deltaY+Math.round(r.height/2),"horizontal"),a=!0),i.x=c,i.y=u,o||editor.stage.hideGuides("vertical"),a||editor.stage.hideGuides("horizontal"),o&&a)return i}return i},alignScaleSelected:function(t,e){if(t.rotation&&0!==t.rotation)return t;for(var i=!1,n=!1,r=_.clone(t),a={x:Math.round(r.x),y:Math.round(r.y),width:Math.round(r.width),height:Math.round(r.height),xy:Math.round(r.x)+Math.round(r.width),angle:r.rotation?r.rotation:0,center:new Point(r.x+r.width/2,r.y+r.height/2)},o=0;o<e.length;o++){var s=e[o],l=r.x,c=r.width,u=r.height,h=r.y;if(t.changed&&t.changed.right&&a.x+a.width>=s.xy-this.snapDistance&&a.x+a.width<=s.xy+this.snapDistance&&(c=s.xy-a.x,r.scalex=1,editor.stage.showGuide(s.xy-1,"vertical"),n=!0),t.changed&&t.changed.left&&a.x>=s.x-this.snapDistance&&a.x<=s.x+this.snapDistance&&t.refPoint&&Math.abs(t.refPoint.x-a.width-s.x)<=this.snapDistance&&(c=t.refPoint.x-s.x,n=!0,r.scalex=1,l=s.x,editor.stage.showGuide(s.x,"vertical")),t.changed&&t.changed.top&&a.y>=s.y-this.snapDistance&&a.y<=s.y+this.snapDistance&&t.refPoint&&Math.abs(t.refPoint.y-a.height-s.y)<=this.snapDistance&&(u=t.refPoint.y-s.y,i=!0,r.scaley=1,h=s.y,editor.stage.showGuide(s.y,"horizontal")),t.changed&&t.changed.bottom&&a.y+a.height>=s.yx-this.snapDistance&&a.y+a.height<=s.yx+this.snapDistance&&(u=s.yx-a.y,r.scaley=1,editor.stage.showGuide(s.yx-1,"horizontal"),i=!0),r.width=c,r.height=u,r.x=l,r.y=h,r.vAlign=n,r.hAlign=i,n||editor.stage.hideGuides("vertical"),i||editor.stage.hideGuides("horizontal"),n&&i)return r}return r}};_.mixin({deepClone:function(t){return $.extend(!0,_.isArray(t)?[]:{},t)}}),function(){Backbone.Model.prototype.toJSON=function(){if(this._isSerializing)return this.id||this.cid;this._isSerializing=!0;var t=_.clone(this.attributes);return _.each(t,function(e,i){e&&_.isFunction(e.toJSON)&&(t[i]=e.toJSON())}),this._isSerializing=!1,t}}.call(this),String.prototype.ucFirst=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var utils={shortMStr:function(t,e){e=void 0===e?34:e;var i=t.replace(/\s+/g," ");if(i.length<=e)return i;var n="...".length,r=e-n,a=Math.ceil(r/2),o=Math.floor(r/2);return i.substr(0,a)+"..."+i.substr(i.length-o)},formatMysqlDate:function(t){if(t){var e=t.replace(/^([0-9]{2,4})-([0-1][0-9])-([0-3][0-9]) (?:([0-2][0-9]):([0-5][0-9]):([0-5][0-9]))?$/,"$1 $2 $3 $4 $5 $6").split(" ");return e[1]+"/"+e[2]+"/"+e[0]+" "+e[3]+":"+e[4]}},convertMysqlDateToJs:function(t){if(t){var e=t.replace(/^([0-9]{2,4})-([0-1][0-9])-([0-3][0-9]) (?:([0-2][0-9]):([0-5][0-9]):([0-5][0-9]))?$/,"$1 $2 $3 $4 $5 $6").split(" ");return new Date(e[0],e[1]-1,e[2],e[3],e[4],e[5])}},isTouchDevice:function(){try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}}},editorUtils={extractRGB:function(t){t=t.toLowerCase();var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],i={r:"",g:"",b:""};return i.r=parseInt((16*e.indexOf(t[1])+e.indexOf(t[2])).toString()),i.g=parseInt((16*e.indexOf(t[3])+e.indexOf(t[4])).toString()),i.b=parseInt((16*e.indexOf(t[5])+e.indexOf(t[6])).toString()),i},generateLighterColor:function(t,e){void 0==e&&(e=26);var i=editorUtils.extractRGB(t);return i.r=Math.min(255,parseInt(i.r)+e),i.g=Math.min(255,parseInt(i.g)+e),i.b=Math.min(255,parseInt(i.b)+e),"#"+editorUtils.fixed2(i.r.toString(16))+editorUtils.fixed2(i.g.toString(16))+editorUtils.fixed2(i.b.toString(16))},fixed2:function(t){return t.length<2?"0"+t:t},globalToLocal:function(t,e,i){var n=t.offset();return{x:Math.floor(e-n.left),y:Math.floor(i-n.top)}},hexToRgb:function(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,i,n){return e+e+i+i+n+n});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}}};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),String.prototype.fulltrim=function(){return this.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var decodeHTML=function(t){return $("<div />").html(t).text()};!function(){jQuery.fn.getBounds=function(){var t={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY,width:Number.NaN,height:Number.NaN};return this.each(function(e,i){var n=$(i),r=n.offset();r.right=r.left+$(n).width(),r.bottom=r.top+$(n).height(),r.left<t.left&&(t.left=r.left),r.top<t.top&&(t.top=r.top),r.right>t.right&&(t.right=r.right),r.bottom>t.bottom&&(t.bottom=r.bottom)}),t.width=t.right-t.left,t.height=t.bottom-t.top,t}}(),$(document).on("click.collapse.data-api","[data-toggle=collapse-show]",function(t){var e,i=$(this),n=i.attr("data-parent"),r=i.attr("data-target")||t.preventDefault()||(e=i.attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,""),a=$(r).data("collapse")?$(this).data("cmethod")||"show":i.data();$(n).removeClass("hide"),$(r).hasClass("in")&&"show"==$(this).data("cmethod")||(i[$(r).hasClass("in")?"addClass":"removeClass"]("collapsed"),$(r).collapse(a))}),jQuery.extendAndMerge=jQuery.fn.extendAndMerge=function(){var t,e,i,n,r,a,o=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof o&&(c=o,o=arguments[1]||{},s=2),"object"==typeof o||jQuery.isFunction(o)||(o={}),l===s&&(o=this,--s);s<l;s++)if(null!=(r=arguments[s]))for(n in r)t=o[n],i=r[n],o!==i&&(c&&i&&(jQuery.isPlainObject(i)||(e=jQuery.isArray(i)))?(a=e?t&&jQuery.isArray(t)?t:[]:t&&jQuery.isPlainObject(t)?t:{},o[n]=1==e?a.concat(i):jQuery.extendAndMerge(c,a,i),e=!1):void 0!==i&&(o[n]=i));return o};var effGenerator={styles:{},nextIndex:0,_generatedEffects:{},generate:function(t,e,i){var n="",r="ease";switch(e.ease){default:r+="Out";break;case"easeIn":r+="In";break;case"easeInOut":r+="InOut"}if(r+=e.tween,!this[r])return!1;for(var a=0;a<=100;a+=4)n+=this.getKeyframe(e,a,this[r](0,a,0,100,100),i),n+="\n";var o,s=document.createElement("style");if(s.type="text/css","alpha"===e.type){if(o=s.id="eff_bs_alpha_"+r+"_"+(i?"show":"hide"),this._generatedEffects[o])return o;this._generatedEffects[o]=!0}else this.nextIndex++,o=s.id="eff_bs_"+this.nextIndex;var l;return l="@-webkit-keyframes "+o+"{\n"+n+"\n}",l+="\n@keyframes "+o+"{\n"+n+"\n}",this.styles[o]=s,s.styleSheet?s.styleSheet.cssText=l:s.innerHTML=l,document.getElementsByTagName("head")[0].appendChild(s),o},clearEffect:function(t){if(0!==t.indexOf("eff_bs_alpha")){var e=document.getElementById(t);e.parentNode.removeChild(e),e=null}},getKeyframe:function(t,e,i,n){var r=e+"% {";switch(t.type){case"scale":var a=1,o=1,s=n?i/100:1-i/100;switch(t.direction){case"l2r":case"r2l":a=s;break;case"t2b":case"b2t":o=s;break;case"center":a=s,o=s}r+="transform: scaleX("+a+") scaleY("+o+")";break;case"slide":var l=0,c=0,s=(100-i)/100,u=parseInt(t.slideOffset);switch(t.direction){case"custom":l=parseInt(t.slidePosX*s),c=parseInt(t.slidePosY*s),n||(l=parseInt(t.slidePosX)-l,c=parseInt(t.slidePosY)-c);break;case"l2r":l=-u*s,n||(l+=u);break;case"r2l":l=u*s,n||(l-=u);break;case"t2b":c=-u*s,n||(c+=u);break;case"b2t":c=u*s,n||(c-=u)}var h=parseInt(t.alphaOffset)/100,d=h+i/100*(1-h);n||(d=1-d+h),r+="transform: translate("+l+"px, "+c+"px);\n",r+="opacity: "+d;break;case"blur":case"blur-words":var f=t.blurAmount*(i/100);n&&(f=t.blurAmount-f);var p="blur("+f+"px)";r+="filter: "+p+"; \n",r+="-webkit-filter: "+p+"; \n";var g;g=n?3.33*e/100:3.33*(100-e)/100,g>1&&(g=1),r+="opacity: "+g;break;case"alpha":case"alpha-words":var g=i/100;n||(g=1-g),r+="opacity: "+g}return r+="}"},easeInElastic:function(t,e,i,n,r){var a=1.70158,o=0,s=n;if(0==e)return i;if(1==(e/=r))return i+n;if(o||(o=.3*r),s<Math.abs(n)){s=n;var a=o/4}else var a=o/(2*Math.PI)*Math.asin(n/s);return-s*Math.pow(2,10*(e-=1))*Math.sin((e*r-a)*(2*Math.PI)/o)+i},easeOutElastic:function(t,e,i,n,r){var a=1.70158,o=0,s=n;if(0==e)return i;if(1==(e/=r))return i+n;if(o||(o=.3*r),s<Math.abs(n)){s=n;var a=o/4}else var a=o/(2*Math.PI)*Math.asin(n/s);return s*Math.pow(2,-10*e)*Math.sin((e*r-a)*(2*Math.PI)/o)+n+i},easeInOutElastic:function(t,e,i,n,r){var a=1.70158,o=0,s=n;if(0==e)return i;if(2==(e/=r/2))return i+n;if(o||(o=r*(.3*1.5)),s<Math.abs(n)){s=n;var a=o/4}else var a=o/(2*Math.PI)*Math.asin(n/s);return e<1?s*Math.pow(2,10*(e-=1))*Math.sin((e*r-a)*(2*Math.PI)/o)*-.5+i:s*Math.pow(2,-10*(e-=1))*Math.sin((e*r-a)*(2*Math.PI)/o)*.5+n+i},easeOutBounce:function(t,e,i,n,r){return(e/=r)<1/2.75?n*(7.5625*e*e)+i:e<2/2.75?n*(7.5625*(e-=1.5/2.75)*e+.75)+i:e<2.5/2.75?n*(7.5625*(e-=2.25/2.75)*e+.9375)+i:n*(7.5625*(e-=2.625/2.75)*e+.984375)+i},easeInBounce:function(t,e,i,n,r){return n-this.easeOutBounce(t,r-e,0,n,r)+i},easeInOutBounce:function(t,e,i,n,r){return e<r/2?.5*this.easeInBounce(t,2*e,0,n,r)+i:.5*this.easeOutBounce(t,2*e-r,0,n,r)+.5*n+i},easeInStrong:function(t,e,i,n,r){return n*(e/=r)*e*e*e*e+i},easeOutStrong:function(t,e,i,n,r){return n*((e=e/r-1)*e*e*e*e+1)+i},easeInOutStrong:function(t,e,i,n,r){return(e/=r/2)<1?n/2*e*e*e*e*e+i:n/2*((e-=2)*e*e*e*e+2)+i}},eff={ceaser:{linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",easeInCubic:"cubic-bezier(.55,.055,.675,.19)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInStrong:"cubic-bezier(.97,.09,.79,.21)",easeOutStrong:"cubic-bezier(.21,.79,.09,.97)",easeInOutStrong:"cubic-bezier(.78,.03,.24,.99)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"},timeouts:{},animationEndCallbacks:{},_blur:function(t,e,i,n){var r=this,a="in"===n,o=function(e){t.style.filter=e,t.style["-webkit-filter"]=e},s=Math.round(3.3*e.duration)/10,l=a?0:e.duration-s;this.setTransition(t,""),this.setAnimation(t,""),t.style.opacity=a?0:1,o(a?"blur("+e.blurAmount+"px)":"blur(0px)"),this.timeouts[i.delayId]=setTimeout(function(){if(t.offsetHeight,"Elastic"===e.tween||"Bounce"===e.tween)t.style.opacity=a?1:0,r.setKeyframeEffect(t,e,i,a,e.effName||null);else{var n=r.getTimingFunction(e),c="filter "+e.duration+"s "+n+" 0s, -webkit-filter "+e.duration+"s "+n+" 0s, opacity "+s+"s linear "+l+"s";r.setTransition(t,c),t.style.opacity=a?1:0,o(a?"blur(0px)":"blur("+e.blurAmount+"px)")}r.timeouts[i.delayId]=setTimeout(function(){o(""),r.onAnimationEnd(t,i)},1e3*e.duration)},1e3*Number(e.delay))},blurIn:function(t,e,i){this._blur(t,e,i,"in")},blurOut:function(t,e,i){this._blur(t,e,i,"out")},_alpha:function(t,e,i,n){var r=this,a="in"===n;this.setTransition(t,""),this.setAnimation(t,""),t.style.opacity=a?0:1,this.timeouts[i.delayId]=setTimeout(function(){if(t.offsetHeight,"Elastic"===e.tween||"Bounce"===e.tween)t.style.opacity=a?1:0,r.setKeyframeEffect(t,e,i,a);else{var n=r.getTimingFunction(e),o="opacity "+Number(e.duration)+"s "+n;r.setTransition(t,o),t.style.opacity=a?1:0}r.timeouts[i.delayId]=setTimeout(function(){e.isWordAnimation||(t.style.opacity=1),r.onAnimationEnd(t,i)},1e3*e.duration)},1e3*Number(e.delay))},alphaIn:function(t,e,i){this._alpha(t,e,i,"in")},alphaOut:function(t,e,i){this._alpha(t,e,i,"out")},setTransition:function(t,e){t.style.transition=e,t.style["-webkit-transition"]=e},setAnimation:function(t,e){t.style.animation=e,t.style["-webkit-animation"]=e},_scale:function(t,e,i,n){function r(t){return t&&a||!t&&!a?"scaleX("+o+") scaleY("+s+")":"scaleX(1) scaleY(1)"}var a="in"===n,o=1,s=1,l="top left";switch(e.direction){case"l2r":o=0,l=a?"left center":"right center";break;case"r2l":o=0,l=a?"right center":"left center";break;case"t2b":s=0,l=a?"center top":"center bottom";break;case"b2t":s=0,l=a?"center bottom":"center top";break;case"center":o=0,s=0,l="center center"}this.setTransition(t,""),this.setAnimation(t,""),t.style.transformOrigin=l,t.style.transform=r(!0);var c=this;this.timeouts[i.delayId]=setTimeout(function(){if(t.offsetHeight,"Elastic"===e.tween||"Bounce"===e.tween)t.style.transform="",c.setKeyframeEffect(t,e,i,a);else{var n=c.getTimingFunction(e),o="transform "+Number(e.duration)+"s "+n;c.setTransition(t,o),t.style.transform=r(!1)}c.timeouts[i.delayId]=setTimeout(function(){c.onAnimationEnd(t,i)},1e3*e.duration)},1e3*Number(e.delay))},scaleIn:function(t,e,i){this._scale(t,e,i,"in")},scaleOut:function(t,e,i){this._scale(t,e,i,"out")},breakWords:function(t){for(var e=t.innerText,i="<span>",n=!1,r=!1,a=0;a<e.length;a++)" "===e[a]||"\n"===e[a]?(r&&(i+="</span>"),n=!0,r=!1):(n&&(i+="<span>"),n=!1,r=!0),i+=e[a];i+="</span>",t.innerHTML=i},effectWords:function(t,e,i,n,r){clearTimeout(eff.timeouts[i.delayId]);var a=this;r&&(t.style.opacity=0),eff.timeouts[i.delayId]=setTimeout(function(){e.onAnimationStart&&e.onAnimationStart(),r&&(t.style.opacity=1);var o=t.querySelector("[data-textcont=true]"),s=o.innerHTML;a.breakWords(o);var l=o.getElementsByTagName("span"),c=(e.duration-e.wordsDuration)/(l.length-1||1),u=e.wordsAppearOrder||"random",h=0,d=0;l=[].slice.call(l);var f;for("Elastic"!==e.tween&&"Bounce"!==e.tween||(f=effGenerator.generate(t,e,r));l.length;){var p,g,m;"r2l"===u?p=l.pop():"l2r"===u?p=l.shift():(d=Math.floor(Math.random()*l.length),p=l.splice(d,1)[0]),g={tween:e.tween,type:n,ease:e.ease,duration:e.wordsDuration,blurAmount:e.blurAmount,isWordAnimation:!0,effName:f,delay:h*c},m={delayId:i.delayId+"_"+h,isWordAnimation:!0},clearTimeout(a.timeouts[m.delayId]);a[n+(r?"In":"Out")](p,g,m),h++}var v=h,y=Math.max(Number(e.duration),Number(e.wordsDuration));a.animationEndCallbacks[i.delayId]=function(){o.innerHTML=s;for(var t=0;t<v;t++)clearTimeout(a.timeouts[i.delayId+"_"+t])},a.timeouts[i.delayId]=setTimeout(function(){a.onAnimationEnd(t,i)},1e3*y)},1e3*Number(e.delay))},setKeyframeEffect:function(t,e,i,n,r){r||(r=effGenerator.generate(t,e,n),i.effName=r);var a=Number(e.duration)+"s linear 0s "+r;this.setAnimation(t,a)},alphaWordsIn:function(t,e,i){this.effectWords(t,e,i,"alpha",!0)},alphaWordsOut:function(t,e,i){this.effectWords(t,e,i,"alpha",!1)},blurWordsIn:function(t,e,i){this.effectWords(t,e,i,"blur",!0)},blurWordsOut:function(t,e,i){this.effectWords(t,e,i,"blur",!1)},_slide:function(t,e,i,n){function r(t){return t&&a||!t&&!a?"translate("+l+"px, "+c+"px)":"translate(0,0)"}var a="in"===n,o=this,s=parseInt(e.alphaOffset)/100,l=0,c=0;switch(e.direction){case"custom":l=parseInt(e.slidePosX),c=parseInt(e.slidePosY);break;case"l2r":l=-parseInt(e.slideOffset);break;case"r2l":l=parseInt(e.slideOffset);break;case"t2b":c=-parseInt(e.slideOffset);break;case"b2t":c=parseInt(e.slideOffset)}a||"custom"==e.direction||(l*=-1,c*=-1),this.setTransition(t,""),this.setAnimation(t,""),t.style.opacity=a?s:1,t.style.transform=r(!0),this.timeouts[i.delayId]=setTimeout(function(){if(t.offsetHeight,"Elastic"===e.tween||"Bounce"===e.tween)t.style.transform="",o.setKeyframeEffect(t,e,i,a);else{var n=o.getTimingFunction(e),l="opacity "+Number(e.duration)+"s "+n+", transform "+Number(e.duration)+"s "+n;o.setTransition(t,l),t.style.transform=r(!1),t.style.opacity=a?1:s}o.timeouts[i.delayId]=setTimeout(function(){e.isWordAnimation||(t.style.opacity=1),o.onAnimationEnd(t,i)},1e3*e.duration)},1e3*Number(e.delay))},slideIn:function(t,e,i){this._slide(t,e,i,"in")},slideOut:function(t,e,i){this._slide(t,e,i,"out")},none:function(t,e){},getTimingFunction:function(t){var e="ease";switch(t.ease){default:e+="Out";break;case"easeIn":e+="In";break;case"easeInOut":e+="InOut"}return e+=t.tween,"Linear"===t.tween&&(e="linear"),this.ceaser[e]},_els:[],getElementIndex:function(t){var e,i;for(e=0;i=this._els[e];e++)if(i===t)return e+1;return this._els.push(t),this._els.length},onAnimationEnd:function(t,e){this.setTransition(t,""),this.setAnimation(t,""),e.effName&&effGenerator.clearEffect(e.effName),e.onAnimationEnd&&e.onAnimationEnd(),this.animationEndCallbacks[e.delayId]&&(this.animationEndCallbacks[e.delayId].call(),this.animationEndCallbacks[e.delayId]=null),clearTimeout(this.timeouts[e.delayId])},onAnimationStart:function(t,e,i){},animate:function(t,e,i,n){if("none"==e.type)return void(n&&n());var r=this,a="",o=e.type;switch(o){case"alpha-words":o="alphaWords";break;case"blur-words":o="blurWords"}i&&(a="buildIn"==i?"In":"Out"),o+=a;var s=this.getElementIndex(t),l={delayId:"delay_"+s,onAnimationEnd:n};return clearTimeout(this.timeouts[l.delayId]),r.onAnimationStart(t,e,l),r[o](t,e,l),{onAnimationEnd:function(){r.onAnimationEnd(t,l)}.bind(this)}}};!function(){var t=[];window.feedback=function(e){this.parentContainer=e,this.feedbackH3=this.parentContainer.find(".feedback-header h3"),this.feedbackClose=this.parentContainer.find("button.close"),this.feedbackBody=this.parentContainer.find(".feedback-body"),this.feedbackTextArea=this.feedbackBody.find("textarea"),this.feedbackSent=this.feedbackBody.find(".feedback-sent"),this.feedbackButton=this.parentContainer.find(".feedback-footer button"),this.sentTimeout=!1,this.effectsTiming=250,this.checkBoxStatus(),t.push(this),this.getAllElems=function(){return t},this.close(),this.send(),this.addClassLastInspectorGroup()}}(),feedback.prototype.close=function(){var t=this;this.feedbackClose.on("click",function(){t.closeAll()})},feedback.prototype.realClose=function(){var t=this;this.feedbackClose.hide(),this.feedbackTextArea.is(":visible")&&this.setStatus("closed"),this.feedbackButton.addClass("btn-fbk-close"),this.feedbackBody.slideUp(t.effectsTiming,function(){t.closed()})},feedback.prototype.closed=function(){var t=this;this.feedbackTextArea.prop("disabled",!0),this.feedbackH3.show(),this.feedbackButton.show(),this.feedbackSent.hide(),setTimeout(function(){t.parentContainer.parents(".scrollwrap").addClass("feedback-closed")},50)},feedback.prototype.closeAll=function(){for(var t=this.getAllElems(),e=0;e<t.length;e++)t[e].realClose()},feedback.prototype.openAll=function(){for(var t=this.getAllElems(),e=0;e<t.length;e++)t[e].open()},feedback.prototype.checkBoxStatus=function(){var t=this;return"closed"==this.getStatus()?(this.feedbackClose.hide(),this.feedbackBody.hide(),this.feedbackButton.addClass("btn-fbk-close"),void this.closed()):void setTimeout(function(){t.parentContainer.parents(".scrollwrap").removeClass("feedback-closed")},50)},feedback.prototype.send=function(){var t=this;this.feedbackButton.on("click",function(){$(this).hasClass("btn-fbk-close")?t.openAll():t.sendMessage()})},feedback.prototype.open=function(){this.stayScrolledToBottom($("#inspector .scrollcontent:visible").get(0)),this.parentContainer.parents(".scrollwrap").removeClass("feedback-closed"),this.sentTimeout&&clearTimeout(this.sentTimeout),this.feedbackTextArea.prop("disabled",!1),this.feedbackTextArea.css("display",""),this.feedbackClose.show(),this.feedbackButton.removeClass("btn-fbk-close"),this.feedbackBody.slideDown(this.effectsTiming),this.setStatus("opened")},feedback.prototype.sendMessage=function(){var t=this,e=$.trim(t.feedbackTextArea.val());if(e){t.feedbackTextArea.attr("disabled",!0);var i=new LoaderHover(t.feedbackTextArea);$.ajax({data:{page:"html5editor/feedback",message:e,hash:editor.config.creativeHash},type:"POST",complete:function(){i.remove(),t.feedbackH3.hide(),t.feedbackTextArea.hide().val(""),t.feedbackButton.hide().addClass("btn-fbk-close"),t.feedbackSent.fadeIn(t.effectsTiming,function(){var e=$(this);t.sentTimeout=setTimeout(function(){t.feedbackClose.hide(),e.slideUp(t.effectsTiming,function(){t.closeAll(),t.setStatus("opened")})},5e3)})},success:function(t){20==t.code||(403==t.code?($("#editor").blockElement(),BSAlert(t.res)):BSAlert(t.res))},error:function(){BSAlert("Saving error.")}})}},feedback.prototype.setStatus=function(t){t||(t="opened");var e=window.klobic_userid;return!(!e||!window.localStorage)&&void localStorage.setItem("feedback"+e,t)},feedback.prototype.getStatus=function(){var t=window.klobic_userid;if(!t||!window.localStorage)return"opened";var e=localStorage.getItem("feedback"+t);return null==e?"opened":e},feedback.prototype.stayScrolledToBottom=function(t){if(!($("#inspector .scrollcontent:visible").outerHeight()>$("#inspector .scrollcontent:visible .scrollwrap").outerHeight()))var e=0,i=this,n=setInterval(function(){e!=i.effectsTiming/5?(t.scrollTop=t.scrollHeight,e++):clearInterval(n)},5)},feedback.prototype.addClassLastInspectorGroup=function(){var t=this;setTimeout(function(){$(t.parentContainer).prev().addClass("last-inspector-group")},5)},jQuery.fn.blockElement=function(){return $(this).append('<div class="blockedElement" style="position:absolute; left:0px; top:0px; right:0px; bottom:0px; background-color:white; opacity:0.5; z-index:10000"></div>')},jQuery.fn.unblockElement=function(){return $(this).find(".blockedElement").remove()},$.fn.descendantOf=function(t){t=$(t)[0];for(var e=this,i=document.body;e&&e!=t&&e!=i;)e=$(e).parent()[0];return void 0!==e&&"null"!=typeof e&&(e==t||e!=i&&void 0)},function(t){t.fn.cssMap=function(e){var i=this;t.each(e,function(t,e){if(e instanceof Array)for(var n=0,r=e.length;n<r;n++)i.css(t,e[n]);else i.css(t,e)})}}(jQuery),function(t){t.fn.refresh=function(){var e=t(this.selector);return this.splice(0,this.length),this.push.apply(this,e),this}}(jQuery),function(t){t.fn.dragsort=function(e){if("destroy"==e)return void t(this).children().trigger("dragsort-uninit");var i=t.extend({},t.fn.dragsort.defaults,e),n=[],r=null,a=null;return this.each(function(e,o){t(o).is("table")&&1==t(o).children().size()&&t(o).children().is("tbody")&&(o=t(o).children().get(0));var s={draggedItem:null,placeHolderItem:null,pos:null,offset:null,offsetLimit:null,scroll:null,container:o,init:function(){var n=0==t(this.container).children().size()?"li":t(this.container).children(":first").get(0).tagName.toLowerCase();""==i.itemSelector&&(i.itemSelector=n),""==i.dragSelector&&(i.dragSelector=n),""==i.placeHolderTemplate&&(i.placeHolderTemplate="<"+n+">&nbsp;</"+n+">"),t(this.container).children(i.itemSelector).attr("data-listidx",e).off("mousedown").mousedown(this.grabItem).bind("dragsort-uninit",this.uninit),this.styleDragHandlers(!0)},uninit:function(){var e=n[t(this).attr("data-listidx")];t(e.container).unbind("mousedown",e.grabItem).unbind("dragsort-uninit"),e.styleDragHandlers(!1)},getItems:function(){return t(this.container).children(i.itemSelector)},styleDragHandlers:function(e){this.getItems().map(function(){return t(this).is(i.dragSelector)?this:t(this).find(i.dragSelector).get()}).css("cursor",e?"pointer":"")},grabItem:function(e){var r=e.currentTarget;if(!(1!=e.which||t(r).is(i.dragSelectorExclude)||t(r).closest(i.dragSelectorExclude).size()>0||0==t(r).closest(i.itemSelector).size())){for(;!t(r).is(i.dragSelector);){if(r==this)return;r=r.parentNode}t(r).attr("data-cursor",t(r).css("cursor")),t(r).css("cursor","move");var a=n[t(this).attr("data-listidx")],o=this,s=function(){a.dragStart.call(o,e),t(a.container).unbind("mousemove",s)};eaUtils.stopEvent(e),this.moveTimeout=setTimeout(function(){clearTimeout(o.moveTimeout),t(a.container).mousemove(s)},250),t(a.container).mouseup(function(){t(a.container).unbind("mousemove",s),t(r).css("cursor",t(r).attr("data-cursor")),clearTimeout(o.moveTimeout)})}},dragStart:function(e){null!=r&&null!=r.draggedItem&&r.dropItem(),r=n[t(this).attr("data-listidx")],r.draggedItem=t(e.currentTarget).closest(i.itemSelector),r.draggedItem.attr("data-origpos",t(this).attr("data-listidx")+"-"+r.getItems().index(r.draggedItem));var a=parseInt(r.draggedItem.css("marginTop")),o=parseInt(r.draggedItem.css("marginLeft"));r.offset=r.draggedItem.offset(),r.offset.top=e.pageY-r.offset.top+(isNaN(a)?0:a)-1,r.offset.left=e.pageX-r.offset.left+(isNaN(o)?0:o)-1,i.dragBetween||(0==t(r.container).outerHeight()?(Math.max(1,Math.round(.5+r.getItems().size()*r.draggedItem.outerWidth()/t(r.container).outerWidth())),r.draggedItem.outerHeight()):t(r.container).outerHeight(),r.offsetLimit=t(r.container).offset(),r.offsetLimit.right=r.offsetLimit.left+t(r.container).outerWidth()-r.draggedItem.outerWidth(),r.offsetLimit.bottom=r.offsetLimit.top+t(r.container).closest(".scrollcontent").scrollTop()+t(r.container).outerHeight()-r.draggedItem.outerHeight());var s=r.draggedItem.height(),l=r.draggedItem.width();if("tr"==i.itemSelector?(r.draggedItem.children().each(function(){t(this).width(t(this).width())}),r.placeHolderItem=r.draggedItem.clone().attr("data-placeholder",!0),r.draggedItem.after(r.placeHolderItem),r.placeHolderItem.children().each(function(){t(this).css({borderWidth:0,width:t(this).width()+1,height:t(this).height()+1}).html("&nbsp;")})):(r.draggedItem.after(i.placeHolderTemplate),r.placeHolderItem=r.draggedItem.next().css({height:s,width:l}).attr("data-placeholder",!0)),"td"==i.itemSelector){var c=r.draggedItem.closest("table").get(0);t("<table id='"+c.id+"' style='border-width: 0px;' class='dragSortItem "+c.className+"'><tr></tr></table>").appendTo("body").children().append(r.draggedItem)}var u=r.draggedItem.attr("style");r.draggedItem.attr("data-origstyle",u||""),r.draggedItem.css({position:"absolute",opacity:.8,"z-index":999,height:s,width:l}),r.scroll={moveX:0,moveY:0,maxX:t(document).width()-t(window).width(),maxY:t(document).height()-t(window).height()},r.scroll.scrollY=window.setInterval(function(){if(i.scrollContainer!=window)return void t(i.scrollContainer).scrollTop(t(i.scrollContainer).scrollTop()+r.scroll.moveY);var e=t(i.scrollContainer).scrollTop();(r.scroll.moveY>0&&e<r.scroll.maxY||r.scroll.moveY<0&&e>0)&&(t(i.scrollContainer).scrollTop(e+r.scroll.moveY),r.draggedItem.css("top",r.draggedItem.offset().top+r.scroll.moveY+1))},10),r.scroll.scrollX=window.setInterval(function(){if(i.scrollContainer!=window)return void t(i.scrollContainer).scrollLeft(t(i.scrollContainer).scrollLeft()+r.scroll.moveX);var e=t(i.scrollContainer).scrollLeft();(r.scroll.moveX>0&&e<r.scroll.maxX||r.scroll.moveX<0&&e>0)&&(t(i.scrollContainer).scrollLeft(e+r.scroll.moveX),r.draggedItem.css("left",r.draggedItem.offset().left+r.scroll.moveX+1))},10),t(n).each(function(t,e){e.createDropTargets(),e.buildPositionTable()}),r.setPos(e.pageX,e.pageY),t(document).bind("mousemove",r.swapItems),t(document).bind("mouseup",r.dropItem),i.scrollContainer!=window&&t(window).bind("DOMMouseScroll mousewheel",r.wheel)},setPos:function(e,n){var a=n-this.offset.top,o=e-this.offset.left;if(i.dragBetween||(a=Math.min(this.offsetLimit.bottom,Math.max(a,this.offsetLimit.top)),o=Math.min(this.offsetLimit.right,Math.max(o,this.offsetLimit.left))),this.draggedItem.parents().each(function(){if("static"!=t(this).css("position")&&(!t.browser.mozilla||"table"!=t(this).css("display"))){var e=t(this).offset();return a-=e.top,o-=e.left,!1}}),this.draggedItem.parents().each(function(){if(this.scrollTop)return void(a-=this.scrollTop)}),i.scrollContainer==window)n-=t(window).scrollTop(),e-=t(window).scrollLeft(),n=Math.max(0,n-t(window).height()+5)+Math.min(0,n-5),e=Math.max(0,e-t(window).width()+5)+Math.min(0,e-5);else{var s=t(i.scrollContainer),l=s.offset();n=Math.max(0,n-s.height()-l.top)+Math.min(0,n-l.top),e=Math.max(0,e-s.width()-l.left)+Math.min(0,e-l.left)}r.scroll.moveX=0==e?0:e*i.scrollSpeed/Math.abs(e),r.scroll.moveY=0==n?0:n*i.scrollSpeed/Math.abs(n),this.draggedItem.css({top:a,left:o})},wheel:function(e){if((t.browser.safari||t.browser.mozilla)&&r&&i.scrollContainer!=window){var n=t(i.scrollContainer),a=n.offset();if(e.pageX>a.left&&e.pageX<a.left+n.width()&&e.pageY>a.top&&e.pageY<a.top+n.height()){var o=e.detail?5*e.detail:e.wheelDelta/-2;n.scrollTop(n.scrollTop()+o),e.preventDefault()}}},buildPositionTable:function(){var e=[];this.getItems().not([r.draggedItem[0],r.placeHolderItem[0]]).each(function(i){var n=t(this).offset();n.right=n.left+t(this).outerWidth(),n.bottom=n.top+t(this).outerHeight(),n.elm=this,e[i]=n}),this.pos=e},dropItem:function(){if(null!=r.draggedItem){var e=r.draggedItem.attr("data-origstyle");return r.draggedItem.attr("style",e),""==e&&r.draggedItem.removeAttr("style"),r.draggedItem.removeAttr("data-origstyle"),r.styleDragHandlers(!0),r.placeHolderItem.before(r.draggedItem),r.placeHolderItem.remove(),t("[data-droptarget], .dragSortItem").remove(),window.clearInterval(r.scroll.scrollY),window.clearInterval(r.scroll.scrollX),
r.draggedItem.attr("data-origpos")!=t(n).index(r)+"-"+r.getItems().index(r.draggedItem)&&i.dragEnd.apply(r.draggedItem),r.draggedItem.removeAttr("data-origpos"),r.draggedItem=null,t(document).unbind("mousemove",r.swapItems),t(document).unbind("mouseup",r.dropItem),i.scrollContainer!=window&&t(window).unbind("DOMMouseScroll mousewheel",r.wheel),!1}},swapItems:function(e){if(null==r.draggedItem)return!1;var o=t(r.container).closest(".scrollcontent").scrollTop(),s=t(r.container).closest(".scrollcontent").scrollLeft(),l=e.pageX+s,c=e.pageY+o;r.setPos(l,c);for(var u=r.findPos(e.pageX,e.pageY),h=r,d=0;-1==u&&i.dragBetween&&d<n.length;d++)u=n[d].findPos(e.pageX,e.pageY),h=n[d];if(-1==u)return!1;var f=function(){return t(h.container).children().not(h.draggedItem)},p=f().not(i.itemSelector).each(function(t){this.idx=f().index(this)});return null==a||a.top>r.draggedItem.offset().top||a.left>r.draggedItem.offset().left?t(h.pos[u].elm).before(r.placeHolderItem):t(h.pos[u].elm).after(r.placeHolderItem),p.each(function(){var e=f().eq(this.idx).get(0);this!=e&&f().index(this)<this.idx?t(this).insertAfter(e):this!=e&&t(this).insertBefore(e)}),t(n).each(function(t,e){e.createDropTargets(),e.buildPositionTable()}),a=r.draggedItem.offset(),!1},findPos:function(t,e){for(var i=0;i<this.pos.length;i++)if(this.pos[i].left<t&&this.pos[i].right>t&&this.pos[i].top<e&&this.pos[i].bottom>e)return i;return-1},createDropTargets:function(){i.dragBetween&&t(n).each(function(){var e=t(this.container).find("[data-placeholder]"),n=t(this.container).find("[data-droptarget]");e.size()>0&&n.size()>0?n.remove():0==e.size()&&0==n.size()&&("td"==i.itemSelector?t(i.placeHolderTemplate).attr("data-droptarget",!0).appendTo(this.container):t(this.container).append(r.placeHolderItem.removeAttr("data-placeholder").clone().attr("data-droptarget",!0)),r.placeHolderItem.attr("data-placeholder",!0))})}};s.init(),n.push(s)}),this},t.fn.dragsort.defaults={itemSelector:"",dragSelector:"",dragSelectorExclude:"input, textarea",dragEnd:function(){},dragBetween:!1,placeHolderTemplate:"",scrollContainer:window,scrollSpeed:5}}(jQuery),function(t){t.fn.dragsortdrop=function(e){if("destroy"==e)return void t(this).children().trigger("dragsort-uninit");var i=t.extend({},t.fn.dragsort.defaults,e),n=[],r=null,a=null,o=function(e,o){t(o).is("table")&&1==t(o).children().size()&&t(o).children().is("tbody")&&(o=t(o).children().get(0));var s={draggedItem:null,placeHolderItem:null,pos:null,offset:null,offsetLimit:null,scroll:null,container:o,init:function(){var n=0==t(this.container).children().size()?"li":t(this.container).children(":first").get(0).tagName.toLowerCase();""==i.itemSelector&&(i.itemSelector=n),""==i.dragSelector&&(i.dragSelector=n),""==i.placeHolderTemplate&&(i.placeHolderTemplate="<"+n+">&nbsp;</"+n+">"),t(this.container).children(i.itemSelector).attr("data-listidx",e).off("mousedown").mousedown(this.grabItem).bind("dragsort-uninit",this.uninit),this.styleDragHandlers(!0)},uninit:function(){var e=n[t(this).attr("data-listidx")];t(e.container).unbind("mousedown",e.grabItem).unbind("dragsort-uninit"),e.styleDragHandlers(!1)},getItems:function(){return t(this.container).children(i.itemSelector)},styleDragHandlers:function(e){this.getItems().map(function(){return t(this).is(i.dragSelector)?this:t(this).find(i.dragSelector).get()}).css("cursor",e?"pointer":"")},grabItem:function(e){var r=e.currentTarget;if(!(1!=e.which||t(r).is(i.dragSelectorExclude)||t(r).closest(i.dragSelectorExclude).size()>0||0==t(r).closest(i.itemSelector).size())){for(e.stopPropagation(),e.preventDefault();!t(r).is(i.dragSelector);){if(r==this)return;r=r.parentNode}t(r).attr("data-cursor",t(r).css("cursor")),t(r).css("cursor","move");var a=n[t(this).attr("data-listidx")],o=this,s=function(){a.dragStart.call(o,e),t(a.container).unbind("mousemove",s)};t(a.container).mousemove(s).mouseup(function(){t(a.container).unbind("mousemove",s),t(r).css("cursor",t(r).attr("data-cursor"))})}},dragStart:function(e){null!=r&&null!=r.draggedItem&&r.dropItem(),r=n[t(this).attr("data-listidx")],r.draggedItem=t(e.currentTarget).closest(i.itemSelector),r.draggedItem.attr("data-origpos",t(this).attr("data-listidx")+"-"+r.getItems().index(r.draggedItem));var a=parseInt(r.draggedItem.css("marginTop")),o=parseInt(r.draggedItem.css("marginLeft"));if(r.offset=r.draggedItem.offset(),r.offset.top=e.pageY-r.offset.top+(isNaN(a)?0:a)-1,r.offset.left=e.pageX-r.offset.left+(isNaN(o)?0:o)-1,!i.dragBetween){var s=0==t(r.container).outerHeight()?Math.max(1,Math.round(.5+r.getItems().size()*r.draggedItem.outerWidth()/t(r.container).outerWidth()))*r.draggedItem.outerHeight():t(r.container).outerHeight();r.offsetLimit=t(r.container).offset(),r.offsetLimit.right=r.offsetLimit.left+t(r.container).outerWidth()-r.draggedItem.outerWidth(),r.offsetLimit.bottom=r.offsetLimit.top+s-r.draggedItem.outerHeight()}var l=r.draggedItem.height(),c=r.draggedItem.width();if("tr"==i.itemSelector?(r.draggedItem.children().each(function(){t(this).width(t(this).width())}),r.placeHolderItem=r.draggedItem.clone().attr("data-placeholder",!0),r.draggedItem.after(r.placeHolderItem),r.placeHolderItem.children().each(function(){t(this).css({borderWidth:0,width:t(this).width()+1,height:t(this).height()+1}).html("&nbsp;")})):(r.draggedItem.after(i.placeHolderTemplate),r.placeHolderItem=r.draggedItem.next().css({height:l,width:c}).attr("data-placeholder",!0)),"td"==i.itemSelector){var u=r.draggedItem.closest("table").get(0);t("<table id='"+u.id+"' style='border-width: 0px;' class='dragSortItem "+u.className+"'><tr></tr></table>").appendTo("body").children().append(r.draggedItem)}var h=r.draggedItem.attr("style");r.draggedItem.attr("data-origstyle",h||""),r.draggedItem.css({position:"absolute",opacity:.8,"z-index":999,height:l,width:c}),r.scroll={moveX:0,moveY:0,maxX:t(document).width()-t(window).width(),maxY:t(document).height()-t(window).height()},r.scroll.scrollY=window.setInterval(function(){if(i.scrollContainer!=window)return void t(i.scrollContainer).scrollTop(t(i.scrollContainer).scrollTop()+r.scroll.moveY);var e=t(i.scrollContainer).scrollTop();(r.scroll.moveY>0&&e<r.scroll.maxY||r.scroll.moveY<0&&e>0)&&(t(i.scrollContainer).scrollTop(e+r.scroll.moveY),r.draggedItem.css("top",r.draggedItem.offset().top+r.scroll.moveY+1))},10),r.scroll.scrollX=window.setInterval(function(){if(i.scrollContainer!=window)return void t(i.scrollContainer).scrollLeft(t(i.scrollContainer).scrollLeft()+r.scroll.moveX);var e=t(i.scrollContainer).scrollLeft();(r.scroll.moveX>0&&e<r.scroll.maxX||r.scroll.moveX<0&&e>0)&&(t(i.scrollContainer).scrollLeft(e+r.scroll.moveX),r.draggedItem.css("left",r.draggedItem.offset().left+r.scroll.moveX+1))},10),t(n).each(function(t,e){e.createDropTargets(),e.buildPositionTable()}),r.setPos(e.pageX,e.pageY),t(document).bind("mousemove",r.swapItems),t(document).bind("mouseup",r.dropItem),i.scrollContainer!=window&&t(window).bind("DOMMouseScroll mousewheel",r.wheel)},setPos:function(e,n){var a=n-this.offset.top,o=e-this.offset.left;if(i.dragBetween||(a=Math.min(this.offsetLimit.bottom,Math.max(a,this.offsetLimit.top)),o=Math.min(this.offsetLimit.right,Math.max(o,this.offsetLimit.left))),this.draggedItem.parents().each(function(){if("static"!=t(this).css("position")&&(!t.browser.mozilla||"table"!=t(this).css("display"))){var e=t(this).offset();return a-=e.top,o-=e.left,!1}}),i.scrollContainer==window)n-=t(window).scrollTop(),e-=t(window).scrollLeft(),n=Math.max(0,n-t(window).height()+5)+Math.min(0,n-5),e=Math.max(0,e-t(window).width()+5)+Math.min(0,e-5);else{var s=t(i.scrollContainer),l=s.offset();n=Math.max(0,n-s.height()-l.top)+Math.min(0,n-l.top),e=Math.max(0,e-s.width()-l.left)+Math.min(0,e-l.left)}r.scroll.moveX=0==e?0:e*i.scrollSpeed/Math.abs(e),r.scroll.moveY=0==n?0:n*i.scrollSpeed/Math.abs(n),this.draggedItem.css({top:a,left:o})},wheel:function(e){if((t.browser.safari||t.browser.mozilla)&&r&&i.scrollContainer!=window){var n=t(i.scrollContainer),a=n.offset();if(e.pageX>a.left&&e.pageX<a.left+n.width()&&e.pageY>a.top&&e.pageY<a.top+n.height()){var o=e.detail?5*e.detail:e.wheelDelta/-2;n.scrollTop(n.scrollTop()+o),e.preventDefault()}}},buildPositionTable:function(){var e=[];this.getItems().not([r.draggedItem[0],r.placeHolderItem[0]]).each(function(i){var n=t(this).offset();n.right=n.left+t(this).outerWidth(),n.bottom=n.top+t(this).outerHeight(),n.elm=this,e[i]=n}),this.pos=e},dropItem:function(){if(null!=r.draggedItem){var e=r.draggedItem.attr("data-origstyle");return r.draggedItem.attr("style",e),""==e&&r.draggedItem.removeAttr("style"),r.draggedItem.removeAttr("data-origstyle"),r.styleDragHandlers(!0),r.placeHolderItem.before(r.draggedItem),r.placeHolderItem.remove(),t("[data-droptarget], .dragSortItem").remove(),window.clearInterval(r.scroll.scrollY),window.clearInterval(r.scroll.scrollX),r.draggedItem.attr("data-origpos")!=t(n).index(r)+"-"+r.getItems().index(r.draggedItem)&&i.dragEnd.apply(r.draggedItem),i.callback&&i.callback.apply(r.draggedItem),r.draggedItem.removeAttr("data-origpos"),r.draggedItem=null,t(document).unbind("mousemove",r.swapItems),t(document).unbind("mouseup",r.dropItem),i.scrollContainer!=window&&t(window).unbind("DOMMouseScroll mousewheel",r.wheel),!1}},swapItems:function(e){if(null==r.draggedItem)return!1;r.setPos(e.pageX,e.pageY);for(var o=r.findPos(e.pageX,e.pageY),s=r,l=0;-1==o&&i.dragBetween&&l<n.length;l++)o=n[l].findPos(e.pageX,e.pageY),s=n[l];if(-1==o)return!1;var c=function(){return t(s.container).children().not(s.draggedItem)},u=c().not(i.itemSelector).each(function(t){this.idx=c().index(this)});return null==a||a.top>r.draggedItem.offset().top||a.left>r.draggedItem.offset().left?t(s.pos[o].elm).before(r.placeHolderItem):t(s.pos[o].elm).after(r.placeHolderItem),u.each(function(){var e=c().eq(this.idx).get(0);this!=e&&c().index(this)<this.idx?t(this).insertAfter(e):this!=e&&t(this).insertBefore(e)}),t(n).each(function(t,e){e.createDropTargets(),e.buildPositionTable()}),a=r.draggedItem.offset(),!1},findPos:function(t,e){for(var i=0;i<this.pos.length;i++)if(this.pos[i].left<t&&this.pos[i].right>t&&this.pos[i].top<e&&this.pos[i].bottom>e)return i;return-1},createDropTargets:function(){i.dragBetween&&t(n).each(function(){var e=t(this.container).find("[data-placeholder]"),n=t(this.container).find("[data-droptarget]");e.size()>0&&n.size()>0?n.remove():0==e.size()&&0==n.size()&&("td"==i.itemSelector?t(i.placeHolderTemplate).attr("data-droptarget",!0).appendTo(this.container):t(this.container).append(r.placeHolderItem.removeAttr("data-placeholder").clone().attr("data-droptarget",!0)),r.placeHolderItem.attr("data-placeholder",!0))})}};s.init(),n.push(s)};return this.each(function(t,e){o(t,e)}),e&&e.refresh&&!0===e.refresh?void 0:this},t.fn.dragsort.defaults={itemSelector:"",dragSelector:"",dragSelectorExclude:"input, textarea",dragEnd:function(){},dragBetween:!1,placeHolderTemplate:"",scrollContainer:window,scrollSpeed:5}}(jQuery),function(t){t.fn.drag=function(e,i,n){var r="string"==typeof e?e:"",a=t.isFunction(e)?e:t.isFunction(i)?i:null;return 0!==r.indexOf("drag")&&(r="drag"+r),n=(e==a?i:n)||{},a?this.bind(r,n,a):this.trigger(r)};var e=t.event,i=e.special,n=i.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(e){var i=t.data(this,n.datakey),r=e.data||{};i.related+=1,t.each(n.defaults,function(t,e){void 0!==r[t]&&(i[t]=r[t])})},remove:function(){t.data(this,n.datakey).related-=1},setup:function(){if(!t.data(this,n.datakey)){var i=t.extend({related:0},n.defaults);t.data(this,n.datakey,i),e.add(this,"touchstart mousedown",n.init,i),this.attachEvent&&this.attachEvent("ondragstart",n.dontstart)}},teardown:function(){(t.data(this,n.datakey)||{}).related||(t.removeData(this,n.datakey),e.remove(this,"touchstart mousedown",n.init),n.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",n.dontstart))},init:function(r){if(!n.touched){var a,o=r.data;0!=r.which&&o.which>0&&r.which!=o.which||t(r.target).is(o.not)||o.handle&&!t(r.target).closest(o.handle,r.currentTarget).length||(n.touched="touchstart"==r.type?this:null,o.propagates=1,o.mousedown=this,o.interactions=[n.interaction(this,o)],o.target=r.target,o.pageX=r.pageX,o.pageY=r.pageY,o.dragging=null,a=n.hijack(r,"draginit",o),o.propagates&&(a=n.flatten(a),a&&a.length&&(o.interactions=[],t.each(a,function(){o.interactions.push(n.interaction(this,o))})),o.propagates=o.interactions.length,!1!==o.drop&&i.drop&&i.drop.handler(r,o),n.textselect(!1),n.touched?e.add(n.touched,"touchmove touchend",n.handler,o):e.add(document,"mousemove mouseup",n.handler,o)))}},interaction:function(e,i){var r=t(e)[i.relative?"position":"offset"]()||{top:0,left:0};return{drag:e,callback:new n.callback,droppable:[],offset:r}},handler:function(r){var a=r.data;switch(r.type){case!a.dragging&&"touchmove":r.preventDefault();case!a.dragging&&"mousemove":if(Math.pow(r.pageX-a.pageX,2)+Math.pow(r.pageY-a.pageY,2)<Math.pow(a.distance,2))break;r.target=a.target,n.hijack(r,"dragstart",a),a.propagates&&(a.dragging=!0);case"touchmove":r.preventDefault();case"mousemove":if(a.dragging){if(n.hijack(r,"drag",a),a.propagates){!1!==a.drop&&i.drop&&i.drop.handler(r,a);break}r.type="mouseup"}case"touchend":case"mouseup":default:n.touched?e.remove(n.touched,"touchmove touchend",n.handler):e.remove(document,"mousemove mouseup",n.handler),a.dragging&&(!1!==a.drop&&i.drop&&i.drop.handler(r,a),n.hijack(r,"dragend",a)),n.textselect(!0),!1===a.click&&a.dragging&&t.data(a.mousedown,"suppress.click",(new Date).getTime()+5),a.dragging=n.touched=!1}},hijack:function(i,r,a,o,s){if(a){var l,c,u,h={event:i.originalEvent,type:i.type},d=r.indexOf("drop")?"drag":"drop",f=o||0,p=isNaN(o)?a.interactions.length:o;i.type=r,i.originalEvent=null,a.results=[];do{if(c=a.interactions[f]){if("dragend"!==r&&c.cancelled)continue;u=n.properties(i,a,c),c.results=[],t(s||c[d]||a.droppable).each(function(o,s){if(u.target=s,i.isPropagationStopped=function(){return!1},l=s?e.dispatch.call(s,i,u):null,!1===l?("drag"==d&&(c.cancelled=!0,a.propagates-=1),"drop"==r&&(c[d][o]=null)):"dropinit"==r&&c.droppable.push(n.element(l)||s),"dragstart"==r&&(c.proxy=t(n.element(l)||c.drag)[0]),c.results.push(l),delete i.result,"dropinit"!==r)return l}),c.results.length>0&&"idle"!=c.results[0]&&(a.results[f]=n.flatten(c.results)),"dropinit"==r&&(c.droppable=n.flatten(c.droppable)),"dragstart"!=r||c.cancelled||u.update()}}while(++f<p);return i.type=h.type,i.originalEvent=h.event,n.flatten(a.results)}},properties:function(t,e,i){var r=i.callback;return r.drag=i.drag,r.proxy=i.proxy||i.drag,r.startX=e.pageX,r.startY=e.pageY,r.deltaX=t.pageX-e.pageX,r.deltaY=t.pageY-e.pageY,r.originalX=i.offset.left,r.originalY=i.offset.top,r.offsetX=r.originalX+r.deltaX,r.offsetY=r.originalY+r.deltaY,r.drop=n.flatten((i.drop||[]).slice()),r.available=n.flatten((i.droppable||[]).slice()),r},element:function(t){if(t&&(t.jquery||1==t.nodeType))return t},flatten:function(e){return t.map(e,function(e){return e&&e.jquery?t.makeArray(e):e&&e.length?n.flatten(e):e})},textselect:function(e){t(document)[e?"unbind":"bind"]("selectstart",n.dontstart).css("MozUserSelect",e?"":"none"),document.unselectable=e?"off":"on"},dontstart:function(){return!1},callback:function(){}};n.callback.prototype={update:function(){i.drop&&this.available.length&&t.each(this.available,function(t){i.drop.locate(this,t)})}};var r=e.dispatch;e.dispatch=function(e){return t.data(this,"suppress."+e.type)-(new Date).getTime()>0?void t.removeData(this,"suppress."+e.type):r.apply(this,arguments)};var a=e.fixHooks.touchstart=e.fixHooks.touchmove=e.fixHooks.touchend=e.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(e,i){if(i){var n=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0]||null;n&&t.each(a.props,function(t,i){e[i]=n[i]})}return e}};i.draginit=i.dragstart=i.dragend=n}(jQuery),function(t){var e=t.event,i=e.special.drag,n=i.add,r=i.teardown;i.noBubble=!1,i.livekey="livedrag",i.add=function(r){n.apply(this,arguments);var a=t.data(this,i.datakey);!a.live&&r.selector&&(a.live=!0,e.add(this,"draginit."+i.livekey,i.delegate))},i.teardown=function(){r.apply(this,arguments);var n=t.data(this,i.datakey)||{};n.live&&(e.remove(this,"draginit."+i.livekey,i.delegate),n.live=!1)},i.delegate=function(n){var r,a=[],o=t.data(this,"events")||{};return t.each(o||[],function(o,s){0===o.indexOf("drag")&&t.each(s||[],function(o,s){(r=t(n.target).closest(s.selector,n.currentTarget)[0])&&(e.add(r,s.origType+"."+i.livekey,s.origHandler||s.handler,s.data),t.inArray(r,a)<0&&a.push(r))})}),!!a.length&&t(a).bind("dragend."+i.livekey,function(){e.remove(this,"."+i.livekey)})}}(jQuery),function(t){t.fn.drop=function(e,i,n){var r="string"==typeof e?e:"",a=t.isFunction(e)?e:t.isFunction(i)?i:null;return 0!==r.indexOf("drop")&&(r="drop"+r),n=(e==a?i:n)||{},a?this.bind(r,n,a):this.trigger(r)},t.drop=function(e){e=e||{},n.multi=!0===e.multi?1/0:!1===e.multi?1:isNaN(e.multi)?n.multi:e.multi,n.delay=e.delay||n.delay,n.tolerance=t.isFunction(e.tolerance)?e.tolerance:null===e.tolerance?null:n.tolerance,n.mode=e.mode||n.mode||"intersect"};var e=t.event,i=e.special,n=t.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(e){t.data(this,n.datakey).related+=1},remove:function(){t.data(this,n.datakey).related-=1},setup:function(){if(!t.data(this,n.datakey)){var e={related:0,active:[],anyactive:0,winner:0,location:{}};t.data(this,n.datakey,e),n.targets.push(this)}},teardown:function(){if(!(t.data(this,n.datakey)||{}).related){t.removeData(this,n.datakey);var e=this;n.targets=t.grep(n.targets,function(t){return t!==e})}},handler:function(e,r){var a;if(r)switch(e.type){case"mousedown":case"touchstart":a=t(n.targets),"string"==typeof r.drop&&(a=a.filter(r.drop)),a.each(function(){var e=t.data(this,n.datakey);e.active=[],e.anyactive=0,e.winner=0}),r.droppable=a,i.drag.hijack(e,"dropinit",r);break;case"mousemove":case"touchmove":n.event=e,n.timer||n.tolerate(r);break;case"mouseup":case"touchend":n.timer=clearTimeout(n.timer),r.propagates&&(i.drag.hijack(e,"drop",r),i.drag.hijack(e,"dropend",r))}},locate:function(e,i){var r=t.data(e,n.datakey),a=t(e),o=a.offset()||{},s=a.outerHeight(),l=a.outerWidth(),c={elem:e,width:l,height:s,top:o.top,left:o.left,right:o.left+l,bottom:o.top+s};return r&&(r.location=c,r.index=i,r.elem=e),c},contains:function(t,e){return(e[0]||e.left)>=t.left&&(e[0]||e.right)<=t.right&&(e[1]||e.top)>=t.top&&(e[1]||e.bottom)<=t.bottom},modes:{intersect:function(t,e,i){return this.contains(i,[t.pageX,t.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(t,e,i){return Math.max(0,Math.min(i.bottom,e.bottom)-Math.max(i.top,e.top))*Math.max(0,Math.min(i.right,e.right)-Math.max(i.left,e.left))},fit:function(t,e,i){return this.contains(i,e)?1:0},middle:function(t,e,i){return this.contains(i,[e.left+.5*e.width,e.top+.5*e.height])?1:0}},sort:function(t,e){return e.winner-t.winner||t.index-e.index},tolerate:function(e){var r,a,o,s,l,c,u,h,d=0,f=e.interactions.length,p=[n.event.pageX,n.event.pageY],g=n.tolerance||n.modes[n.mode];do{if(h=e.interactions[d]){if(!h)return;h.drop=[],l=[],c=h.droppable.length,g&&(o=n.locate(h.proxy)),r=0;do{if(u=h.droppable[r]){if(s=t.data(u,n.datakey),!(a=s.location))continue;s.winner=g?g.call(n,n.event,o,a):n.contains(a,p)?1:0,l.push(s)}}while(++r<c);l.sort(n.sort),r=0;do{(s=l[r])&&(s.winner&&h.drop.length<n.multi?(s.active[d]||s.anyactive||(!1!==i.drag.hijack(n.event,"dropstart",e,d,s.elem)[0]?(s.active[d]=1,s.anyactive+=1):s.winner=0),s.winner&&h.drop.push(s.elem)):s.active[d]&&1==s.anyactive&&(i.drag.hijack(n.event,"dropend",e,d,s.elem),s.active[d]=0,s.anyactive-=1))}while(++r<c)}}while(++d<f);n.last&&p[0]==n.last.pageX&&p[1]==n.last.pageY?delete n.timer:n.timer=setTimeout(function(){n.tolerate(e)},n.delay),n.last=n.event}};i.dropinit=i.dropstart=i.dropend=n}(jQuery),function(t){var e=t.event,i=e.special.drop,n=i.add,r=i.teardown;i.noBubble=!1,i.livekey="livedrop",i.add=function(r){n.apply(this,arguments);var a=t.data(this,i.datakey);!a.live&&r.selector&&(a.live=!0,e.add(this,"dropinit."+i.livekey,i.delegate))},i.teardown=function(){r.apply(this,arguments);var n=t.data(this,i.datakey)||{};n.live&&(e.remove(this,"dropinit",i.delegate),n.live=!1)},i.delegate=function(n,r){var a,o=[],s=t.data(this,"events")||{};return t.each(s||[],function(r,s){0===r.indexOf("drop")&&t.each(s,function(r,s){a=t(n.currentTarget).find(s.selector),a.length&&a.each(function(){e.add(this,s.origType+"."+i.livekey,s.origHandler||s.handler,s.data),t.inArray(this,o)<0&&o.push(this)})})}),r&&e.add(r.drag,"dragend."+i.livekey,function(){t.each(o.concat(this),function(){e.remove(this,"."+i.livekey)})}),!!o.length&&t(o)}}(jQuery),jQuery&&function(t){function e(e,i){var n=t('<span class="minicolors" />'),r=t.minicolors.defaultSettings;e.data("minicolors-initialized")||(i=t.extend(!0,{},r,i),n.addClass("minicolors-theme-"+i.theme).addClass("minicolors-swatch-position-"+i.swatchPosition).toggleClass("minicolors-swatch-left","left"===i.swatchPosition).toggleClass("minicolors-with-opacity",i.opacity),void 0!==i.position&&t.each(i.position.split(" "),function(){n.addClass("minicolors-position-"+this)}),e.addClass("minicolors-input").data("minicolors-initialized",!0).data("minicolors-settings",i).prop("size",7).prop("maxlength",7).wrap(n).after('<span class="minicolors-panel minicolors-slider-'+i.control+'"><span class="minicolors-slider"><span class="minicolors-picker"></span></span><span class="minicolors-opacity-slider"><span class="minicolors-picker"></span></span><span class="minicolors-grid"><span class="minicolors-grid-inner"></span><span class="minicolors-picker"><span></span></span></span></span>'),e.parent().find(".minicolors-panel").on("selectstart",function(){return!1}).end(),"left"===i.swatchPosition?e.before('<span class="minicolors-swatch"><span></span></span>'):e.after('<span class="minicolors-swatch"><span></span></span>'),i.textfield||e.addClass("minicolors-hidden"),i.inline&&e.parent().addClass("minicolors-inline"),l(e))}function i(t){var e=t.parent();t.removeData("minicolors-initialized").removeData("minicolors-settings").removeProp("size").removeProp("maxlength").removeClass("minicolors-input"),e.before(t).remove()}function n(t){l(t)}function r(t){var e=t.parent(),i=e.find(".minicolors-panel"),n=t.data("minicolors-settings");!t.data("minicolors-initialized")||t.prop("disabled")||e.hasClass("minicolors-focus")||(a(),e.addClass("minicolors-focus"),i.stop(!0,!0).fadeIn(n.showSpeed,function(){n.show&&n.show.call(t)}))}function a(){t(".minicolors-input").each(function(){var e=t(this),i=e.data("minicolors-settings"),n=e.parent();i.inline||n.find(".minicolors-panel").fadeOut(i.hideSpeed,function(){n.hasClass("minicolors-focus")&&i.hide&&i.hide.call(e),n.removeClass("minicolors-focus")})})}function o(t,e,i){var n,r,a,o,l=t.parents(".minicolors").find(".minicolors-input"),c=l.data("minicolors-settings"),u=t.find("[class$=-picker]"),h=t.offset().left,d=t.offset().top,f=Math.round(e.pageX-h),p=Math.round(e.pageY-d),g=i?c.animationSpeed:0;e.originalEvent.changedTouches&&(f=e.originalEvent.changedTouches[0].pageX-h,p=e.originalEvent.changedTouches[0].pageY-d),f<0&&(f=0),p<0&&(p=0),f>t.width()&&(f=t.width()),p>t.height()&&(p=t.height()),t.parent().is(".minicolors-slider-wheel")&&u.parent().is(".minicolors-grid")&&(n=75-f,r=75-p,a=Math.sqrt(n*n+r*r),o=Math.atan2(r,n),o<0&&(o+=2*Math.PI),a>75&&(a=75,f=75-75*Math.cos(o),p=75-75*Math.sin(o)),f=Math.round(f),p=Math.round(p)),t.is(".minicolors-grid")?u.stop(!0).animate({top:p+"px",left:f+"px"},g,c.animationEasing,function(){s(l)}):u.stop(!0).animate({top:p+"px"},g,c.animationEasing,function(){s(l)})}function s(t){function e(t,e){var i,n;return t.length&&e?(i=t.offset().left,n=t.offset().top,{x:i-e.offset().left+t.outerWidth()/2,y:n-e.offset().top+t.outerHeight()/2}):null}var i,n,r,a,o,s,l,c,u,d=t.parent(),p=t.data("minicolors-settings"),g=(d.find(".minicolors-panel"),d.find(".minicolors-swatch")),v=d.find(".minicolors-grid"),y=d.find(".minicolors-slider"),b=d.find(".minicolors-opacity-slider"),w=v.find("[class$=-picker]"),x=y.find("[class$=-picker]"),I=b.find("[class$=-picker]"),k=e(w,v),M=e(x,y),T=e(I,b);switch(p.control){case"wheel":s=v.width()/2-k.x,l=v.height()/2-k.y,c=Math.sqrt(s*s+l*l),u=Math.atan2(l,s),u<0&&(u+=2*Math.PI),c>75&&(c=75,k.x=69-75*Math.cos(u),k.y=69-75*Math.sin(u)),n=f(c/.75,0,100),i=f(180*u/Math.PI,0,360),r=f(100-Math.floor(M.y*(100/y.height())),0,100),o=m({h:i,s:n,b:r}),y.css("backgroundColor",m({h:i,s:n,b:100}));break;case"saturation":i=f(parseInt(k.x*(360/v.width())),0,360),n=f(100-Math.floor(M.y*(100/y.height())),0,100),r=f(100-Math.floor(k.y*(100/v.height())),0,100),o=m({h:i,s:n,b:r}),y.css("backgroundColor",m({h:i,s:100,b:r})),d.find(".minicolors-grid-inner").css("opacity",n/100);break;case"brightness":i=f(parseInt(k.x*(360/v.width())),0,360),n=f(100-Math.floor(k.y*(100/v.height())),0,100),r=f(100-Math.floor(M.y*(100/y.height())),0,100),o=m({h:i,s:n,b:r}),y.css("backgroundColor",m({h:i,s:n,b:100})),d.find(".minicolors-grid-inner").css("opacity",1-r/100);break;default:i=f(360-parseInt(M.y*(360/y.height())),0,360),n=f(Math.floor(k.x*(100/v.width())),0,100),r=f(100-Math.floor(k.y*(100/v.height())),0,100),o=m({h:i,s:n,b:r}),v.css("backgroundColor",m({h:i,s:100,b:100}))}a=p.opacity?parseFloat(1-T.y/b.height()).toFixed(2):1,t.val(h(o,p.letterCase)),p.opacity&&t.attr("data-opacity",a),g.find("SPAN").css({backgroundColor:o,opacity:a}),o+a!==t.data("minicolors-lastChange")&&(t.data("minicolors-lastChange",o+a),p.change&&(p.changeDelay?(clearTimeout(t.data("minicolors-changeTimeout")),t.data("minicolors-changeTimeout",setTimeout(function(){p.change.call(t,o,a)},p.changeDelay))):p.change.call(t,o,a)))}function l(t,e){var i,n,r,a,o,s,l,c=t.parent(),u=t.data("minicolors-settings"),p=c.find(".minicolors-swatch"),g=c.find(".minicolors-grid"),y=c.find(".minicolors-slider"),b=c.find(".minicolors-opacity-slider"),w=g.find("[class$=-picker]"),x=y.find("[class$=-picker]"),I=b.find("[class$=-picker]");switch(i=h(d(t.val(),!0),u.letterCase),i||(i=h(d(u.defaultValue,!0))),n=v(i),e||t.val(i),u.opacity&&(r=""===t.attr("data-opacity")?1:f(parseFloat(t.attr("data-opacity")).toFixed(2),0,1),t.attr("data-opacity",r),p.find("SPAN").css("opacity",r),o=f(b.height()-b.height()*r,0,b.height()),I.css("top",o+"px")),p.find("SPAN").css("backgroundColor",i),u.control){case"wheel":s=f(Math.ceil(.75*n.s),0,g.height()/2),l=n.h*Math.PI/180,a=f(75-Math.cos(l)*s,0,g.width()),o=f(75-Math.sin(l)*s,0,g.height()),w.css({top:o+"px",left:a+"px"}),o=150-n.b/(100/g.height()),""===i&&(o=0),x.css("top",o+"px"),y.css("backgroundColor",m({h:n.h,s:n.s,b:100}));break;case"saturation":a=f(5*n.h/12,0,150),o=f(g.height()-Math.ceil(n.b/(100/g.height())),0,g.height()),w.css({top:o+"px",left:a+"px"}),o=f(y.height()-n.s*(y.height()/100),0,y.height()),x.css("top",o+"px"),y.css("backgroundColor",m({h:n.h,s:100,b:n.b})),c.find(".minicolors-grid-inner").css("opacity",n.s/100);break;case"brightness":a=f(5*n.h/12,0,150),o=f(g.height()-Math.ceil(n.s/(100/g.height())),0,g.height()),w.css({top:o+"px",left:a+"px"}),o=f(y.height()-n.b*(y.height()/100),0,y.height()),x.css("top",o+"px"),y.css("backgroundColor",m({h:n.h,s:n.s,b:100})),c.find(".minicolors-grid-inner").css("opacity",1-n.b/100);break;default:a=f(Math.ceil(n.s/(100/g.width())),0,g.width()),o=f(g.height()-Math.ceil(n.b/(100/g.height())),0,g.height()),w.css({top:o+"px",left:a+"px"}),o=f(y.height()-n.h/(360/y.height()),0,y.height()),x.css("top",o+"px"),g.css("backgroundColor",m({h:n.h,s:100,b:100}))}}function c(e){var i=d(t(e).val(),!0),n=b(i),r=t(e).attr("data-opacity");return n?(void 0!==r&&t.extend(n,{a:parseFloat(r)}),n):null}function u(e,i){var n=d(t(e).val(),!0),r=b(n),a=t(e).attr("data-opacity");return r?(void 0===a&&(a=1),i?"rgba("+r.r+", "+r.g+", "+r.b+", "+parseFloat(a)+")":"rgb("+r.r+", "+r.g+", "+r.b+")"):null}function h(t,e){return"uppercase"===e?t.toUpperCase():t.toLowerCase()}function d(t,e){return t=t.replace(/[^A-F0-9]/gi,""),3!==t.length&&6!==t.length?"":(3===t.length&&e&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),"#"+t)}function f(t,e,i){return t<e&&(t=e),t>i&&(t=i),t}function p(t){var e={},i=Math.round(t.h),n=Math.round(255*t.s/100),r=Math.round(255*t.b/100);if(0===n)e.r=e.g=e.b=r;else{var a=r,o=(255-n)*r/255,s=i%60*(a-o)/60;360===i&&(i=0),i<60?(e.r=a,e.b=o,e.g=o+s):i<120?(e.g=a,e.b=o,e.r=a-s):i<180?(e.g=a,e.r=o,e.b=o+s):i<240?(e.b=a,e.r=o,e.g=a-s):i<300?(e.b=a,e.g=o,e.r=o+s):i<360?(e.r=a,e.g=o,e.b=a-s):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}}function g(e){var i=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];return t.each(i,function(t,e){1===e.length&&(i[t]="0"+e)}),"#"+i.join("")}function m(t){return g(p(t))}function v(t){var e=y(b(t));return 0===e.s&&(e.h=360),e}function y(t){var e={h:0,s:0,b:0},i=Math.min(t.r,t.g,t.b),n=Math.max(t.r,t.g,t.b),r=n-i;return e.b=n,e.s=0!==n?255*r/n:0,0!==e.s?t.r===n?e.h=(t.g-t.b)/r:t.g===n?e.h=2+(t.b-t.r)/r:e.h=4+(t.r-t.g)/r:e.h=-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.b*=100/255,e}function b(t){return t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16),{r:t>>16,g:(65280&t)>>8,b:255&t}}t.minicolors={defaultSettings:{animationSpeed:100,animationEasing:"swing",change:null,changeDelay:0,control:"hue",defaultValue:"",hide:null,hideSpeed:100,inline:!1,letterCase:"lowercase",opacity:!1,position:"default",show:null,showSpeed:100,swatchPosition:"left",textfield:!0,theme:"default"}},t.extend(t.fn,{minicolors:function(r,a){switch(r){case"destroy":return t(this).each(function(){i(t(this))}),t(this);case"opacity":return void 0===a?t(this).attr("data-opacity"):(t(this).each(function(){n(t(this).attr("data-opacity",a))}),t(this));case"rgbObject":return c(t(this));case"rgbString":case"rgbaString":return u(t(this),"rgbaString"===r);case"settings":return void 0===a?t(this).data("minicolors-settings"):(t(this).each(function(){var e=t(this).data("minicolors-settings")||{};i(t(this)),t(this).minicolors(t.extend(!0,e,a))}),t(this));case"value":return void 0===a?t(this).val():(t(this).each(function(){n(t(this).val(a))}),t(this));case"create":default:return"create"!==r&&(a=r),t(this).each(function(){e(t(this),a)}),t(this)}}}),t(document).on("mousedown.minicolors touchstart.minicolors",function(e){t(e.target).parents().add(e.target).hasClass("minicolors")||a()}).on("mousedown.minicolors touchstart.minicolors",".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider",function(e){var i=t(this);e.preventDefault(),t(document).data("minicolors-target",i),o(i,e,!0)}).on("mousemove.minicolors touchmove.minicolors",function(e){var i=t(document).data("minicolors-target");i&&o(i,e)}).on("mouseup.minicolors touchend.minicolors",function(){t(this).removeData("minicolors-target")}).on("mousedown.minicolors touchstart.minicolors",".minicolors-swatch",function(e){var i=t(this).parent().find(".minicolors-input");i.parent().hasClass("minicolors-focus")?a():r(i)}).on("focus.minicolors",".minicolors-input",function(e){var i=t(this);i.data("minicolors-initialized")&&r(i)}).on("blur.minicolors",".minicolors-input",function(e){var i=t(this),n=i.data("minicolors-settings");i.data("minicolors-initialized")&&(i.val(d(i.val(),!0)),""===i.val()&&i.val(d(n.defaultValue,!0)),i.val(h(i.val(),n.letterCase)),a())}).on("keydown.minicolors",".minicolors-input",function(e){var i=t(this);if(i.data("minicolors-initialized"))switch(e.keyCode){case 9:a();break;case 27:a(),i.blur()}}).on("keyup.minicolors",".minicolors-input",function(e){var i=t(this);i.data("minicolors-initialized")&&l(i,!0)}).on("paste.minicolors",".minicolors-input",function(e){var i=t(this);i.data("minicolors-initialized")&&setTimeout(function(){l(i,!0)},1)})}(jQuery),function(t){function e(e){var i=e||window.event,n=[].slice.call(arguments,1),r=0,a=0,o=0;return e=t.event.fix(i),e.type="mousewheel",i.wheelDelta&&(r=i.wheelDelta/120),i.detail&&(r=-i.detail/3),o=r,
void 0!==i.axis&&i.axis===i.HORIZONTAL_AXIS&&(o=0,a=-1*r),void 0!==i.wheelDeltaY&&(o=i.wheelDeltaY/120),void 0!==i.wheelDeltaX&&(a=-1*i.wheelDeltaX/120),n.unshift(e,r,a,o),(t.event.dispatch||t.event.handle).apply(this,n)}var i=["DOMMouseScroll","mousewheel"];if(t.event.fixHooks)for(var n=i.length;n;)t.event.fixHooks[i[--n]]=t.event.mouseHooks;t.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var t=i.length;t;)this.addEventListener(i[--t],e,!1);else this.onmousewheel=e},teardown:function(){if(this.removeEventListener)for(var t=i.length;t;)this.removeEventListener(i[--t],e,!1);else this.onmousewheel=null}},t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}(jQuery),function(){window.limitation=function(t){var e=this;this.parentContainer=t,this.limitationH3=$("<h3></h3>"),this.limitationHeader=this.parentContainer.find(".limitation-header"),this.limitationHeader.html(this.limitationH3),this.limitationBody=this.parentContainer.find(".limitation-body"),this.limitationButton=this.parentContainer.find(".limitation-footer button"),this.addContent(),this.limitationButton.on("click",function(){window.BSLimitationPopinRedirect(),loggedUser.setNewTimeout(3),e.activateControlsMenuItems()})}}(),limitation.prototype.addContent=function(){var t=loggedUser&&loggedUser.serviceType?loggedUser.serviceType:"free";t=t.charAt(0).toUpperCase()+t.slice(1);var e="This feature is not available in the "+t+" Plan";this.limitationH3.text(e),this.limitationBody.html("<p>For the existing premium elements in your banner we've disabled the Edit and Customize options.</p><p>You can get access to this feature by upgrading your membership.</p>"),this.limitationButton.text("Upgrade")},limitation.activateControlsMenuItems=function(){var t=this,e=null;e=setInterval(function(){if(userData.serviceType!==loggedUser.serviceType){var i=loggedUser&&loggedUser.featuresAccess;if(!i)return!1;for(var n=$("#controls").children(),r=0;r<n.length;r++){var a=$(n[r]);(a.hasClass("control-add-menu")&&"yes"==i.bm_menu||a.hasClass("control-add-video")&&"yes"==i.bm_video||a.hasClass("control-add-embed")&&"yes"==i.bm_embed_elements)&&a.hasClass("feature-limited")&&(a.removeClass("feature-limited"),a.find("sup").remove())}t.refreshElement(),clearInterval(e)}},500)},limitation.refreshElement=function(){editor.stage.$el.click()},function(){function t(e,i){return{x:e||0,y:i||0,equal:function(t){return this.x===t.x&&this.y===t.y},add:function(e){return t(this.x+e.x,this.y+e.y)},subtract:function(e){return t(this.x-e.x,this.y-e.y)},scale:function(e){return t(this.x*e,this.y*e)},magnitude:function(){return t.distance(t(0,0),this)}}}function e(i,n,r,a,o,s){return i=void 0!==i?i:1,a=void 0!==a?a:1,{a:i,b:n||0,c:r||0,d:a,tx:o||0,ty:s||0,concat:function(t){return e(this.a*t.a+this.c*t.b,this.b*t.a+this.d*t.b,this.a*t.c+this.c*t.d,this.b*t.c+this.d*t.d,this.a*t.tx+this.c*t.ty+this.tx,this.b*t.tx+this.d*t.ty+this.ty)},deltaTransformPoint:function(e){return t(this.a*e.x+this.c*e.y,this.b*e.x+this.d*e.y)},inverse:function(){var t=this.a*this.d-this.b*this.c;return e(this.d/t,-this.b/t,-this.c/t,this.a/t,(this.c*this.ty-this.d*this.tx)/t,(this.b*this.tx-this.a*this.ty)/t)},rotate:function(t,i){return this.concat(e.rotation(t,i))},scale:function(t,i,n){return this.concat(e.scale(t,i,n))},transformPoint:function(e){return t(this.a*e.x+this.c*e.y+this.tx,this.b*e.x+this.d*e.y+this.ty)},translate:function(t,i){return this.concat(e.translation(t,i))}}}t.distance=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},t.direction=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},e.rotation=function(t,i){var n=e(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t));return i&&(n=e.translation(i.x,i.y).concat(n).concat(e.translation(-i.x,-i.y))),n},e.scale=function(t,i,n){i=i||t;var r=e(t,0,0,i);return n&&(r=e.translation(n.x,n.y).concat(r).concat(e.translation(-n.x,-n.y))),r},e.translation=function(t,i){return e(1,0,0,1,t,i)},e.IDENTITY=e(),e.HORIZONTAL_FLIP=e(-1,0,0,1),e.VERTICAL_FLIP=e(1,0,0,-1),window.Point=t,window.Matrix=e}();var mobileArray=["Mobile","Android","Kindle","Silk","iPod","iPad","iPhone","BlackBerry","PlayBook","RIM","Tablet"],noFontFace=["Windows Phone","IEMobile","BlackBerry","BlackBerry","PlayBook","RIM","Tablet"];window.MOBILE=navigator.userAgent.match(/mobile/i);