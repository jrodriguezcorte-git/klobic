function confirmLeaveEditorPage(e){return confirm(getTxt("leave_app_page_confirm"))?(e&&(location.href=e),!0):("#bs-add-funds"===location.hash&&(location.hash="#_"),!1)}function confirmLeaveEditorPageRouter(e,n,t){return ignoreNextRouter?(ignoreNextRouter=!1,!1):!!confirmLeaveEditorPage()||(t&&(ignoreNextRouter=!0,history.forward(),setTimeout(function(){ignoreNextRouter=!1},100)),!1)}function newBannerPopin(e){e=e||{};var n={type:"new_banner"};e=$.extend(n,e);var t='<div class="modal fade large free-cant" tabindex="-1" role="dialog" >   <div class="modal-dialog">       <div class="modal-content">           <div class="modal-header">               <button type="button" class="close" data-dismiss="modal" aria-label="Close">&times;</button>               <h4 class="modal-title">'+function(){switch(e.type){case"new_banner":case"duplicate_banner":return"You are not allowed to create more banners";case"new_rotator":return"You are not allowed to create more rotators";case"edit_banner":return"You are not allowed to edit the banner";case"edit_rotator":return"You are not allowed to edit the rotator";default:return!1}}()+'</h4>           </div>           <div class="modal-body">'+function(){var n='<div class="new-banner-popin">';switch(e.type){case"new_banner":case"duplicate_banner":case"edit_banner":n+="<p>You have reached the maximum number of banners you can create.</p>",n+="<p>Please upgrade your plan to create more banners.</p>";break;case"new_rotator":n+="<p>You have reached the maximum number of free rotators.</p>",n+="<p>Please upgrade your plan to create more rotators</p>";break;case"edit_rotator":n+="<p>You have reached the maximum number of free rotators.</p>",n+="<p>Please upgrade your plan to create more rotators</p>"}return n+="</div>"}()+'</div>           <div class="modal-footer">               <button type="button" class="btn btn-default" data-dismiss="modal">Dismiss</button>               <button type="button" class="btn btn-primary see-premium-plans">Upgrade</button>           </div>       </div>   </div></div>',a=$(t).modal();a.on("hidden.bs.modal",function(){a.remove()}),a.find(".see-premium-plans").on("click",function(){window.open(langPre+"/go-premium/?from=new-banner-popin","_blank"),loggedUser.setNewTimeout(3),a.modal("hide")})}var BSLimitationPopinRedirect=function(){window.open(langPre+"/go-premium/","_blank")},BSLimitationPopin=function(e,n){n||(n="");var t="";-1===["heatmap","tags","score","download-html5-swf","flash","download-mp4","br_advanced_rotation_settings"].indexOf(e)&&(t="<p>For the existing premium elements in your banner we've disabled the Edit and Customize options.</p>");var a=loggedUser&&loggedUser.serviceType?loggedUser.serviceType:"free";a=a.charAt(0).toUpperCase()+a.slice(1);var i=$('<div id="limitation-popin-'+e+'" class="modal fade limitation-popin"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close">&times;</button><p>This feature is not available in the '+a+' Plan</p></div><div class="modal-body">'+n+t+'<p>You can get access to this feature by upgrading your membership.</p></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Dismiss</button><button type="button" class="btn btn-primary see-premium-plans">Upgrade</button></div></div></div></div>');i.modal("show"),i.on("hidden.bs.modal",function(){i.remove()}),i.find(".see-premium-plans").on("click",function(){BSLimitationPopinRedirect(),loggedUser.setNewTimeout(3),window.limitation&&window.limitation.activateControlsMenuItems&&window.limitation.activateControlsMenuItems(),i.modal("hide")})},bsBuyPoints=function(e){function n(e){if(e)for(var n in e)this[n]=e[n]}function t(e){if(e)for(var n in e)this[n]=e[n]}function a(e){if(e){for(var n in e)this[n]=e[n];this.upgradeDiscountValue=parseFloat(this.upgradeDiscountValue)||0,this.value=parseFloat(this.value)||0}}var i,s,o,r,l,d,c,u,h,p,f=$.userApi,m=null,v="snack-vip-yearly",g="vip-extended-yearly",b=null,_={},y=null,C="";e=e||{};var w=null,k=function(){$.ajax({url:"/ajax.php",data:{page:"go-premium-user-info"},error:function(){m.modal("hide")},success:function(e){20===e.code?w=e.res.userInfo:(BSAlert(e.res),m.modal("hide"))}})},x=function(){IntercomScript.trackEvent("Viewed go premium pop-in"),L(),$("html").css("overflow","hidden")},P=function(){m.detach(),f.buyPointsModal===m&&(location.hash="#_"),m=null,$("html").css("overflow","auto")},T=function(n){m.find(".modal-title").text("Error");var t=m.find(".modal-body");t.html("<div>"+n+"<div>");var a=$('<a href="#">Try again</a>');a.click(function(){m.modal("hide"),f._buyPointsBS(e)}),t.append("<br>",a)},S=function(e,n){return e.price-n.getDiscount(e)<=0},L=function(){var n,t,a=["service","coupon","methodBuy","views","type","pug","upgrade","hm","users","users_agency","users_business","views_agency","views_business"],i={page:"buy-points-bs"};for(n=0;t=a[n];n++)e[t]&&(i[t]=e[t]);f.isAgencyManager&&(i.isAgencyManager=1);var s=new LoaderHover(m.find(".modal-body"));s.setZIndex(1040),f.ajax({data:i,error:function(e){T("Internal server error")},success:B,complete:function(){s.remove()}})},U=function(e){if(e){var n=0;8&b.flags?n=parseFloat(b.campaigns_budget):4&b.flags&&(!(n=parseFloat(_.price-b.getDiscount(_)))||n<0)&&(n=0),S(_,b)||y||("snack-vip-yearly"===_.hash&&n<100?n=100:"vip-extended-yearly"===_.hash&&n<200&&(n=200)),e=e.replace("{amount}",parseFloat(n.toFixed(2))),b&&b.isTypeUpgrade()&&(e=e.replace("%s",formatNumber(b.getDiscount(_),2)))}var t=l.find("div.msg");t.removeClass("cerr").addClass("cnot").html(e),t.fadeIn("fast")},N=function(){l.find("div.msg").hide()},I=function(n,t){var a=n.price;if(t||_.hash!=n.hash||_.price!=n.price){if(_=n,!_.hash)return;d.find('input[name="serv"]').val(_.hash),d.find('input[name="views"]').val(_.views||0),d.find('input[name="users"]').val(_.users||0);var o=m.find("select[name=users]").closest(".feature");_.users&&1!=_.users?o.addClass("plural").removeClass("singular"):o.addClass("singular").removeClass("plural"),i||(c.find(".details").text(_.name),c.find(".price").text("$"+_.price.toFixed(2)),c.find(".desc").html(_.description),u.hide(),m.find(".plans-container,.plans-type,.pconthelper").hide(),c.show());var r=m.find(".paymethods"),y=m.find(".fulldiscountinfo");if(b){var w=b.getDiscount(_);h.find(".discount").text("$"+formatNumber(w.toFixed(2),2));var k=n.price-w;if(k<0&&(k=0),a=k,h.find(".total").text("$"+formatNumber(k.toFixed(2),2)),h.show(),0===k?(r.hide(),y.show().find("input[name=method_buy]").attr("checked",!0)):(y.hide(),r.show().find("input[name=method_buy][value="+e.methodBuy+"]").attr("checked",!0)),b.isUpgradeCoupon()?l.addClass("upgrade"):l.removeClass("upgrade"),k>0&&_.recursive){var x=0;x=b.isSubscriptionProcentual()?_.price*parseFloat(b.subscription_value)/100:parseFloat(b.subscription_value);var $=n.price-x,P="",T=["initial_payment","recurrent","recurrent_monthly","recurrent_yearly"];f.getMultipleTexts(JSON.stringify(T),function(e){var n=JSON.parse(e),t=n.initial_payment,a=n.recurrent,i=n.recurrent_monthly,s=n.recurrent_yearly;switch(t=t.replace("%s",formatNumber(k,2)),a=a.replace("%s",formatNumber($,2)),s=s.replace("%s",_.months.toString()),s=s.replace("%s",_.months.toString()),P=t+". "+a,_.months){case 1:P+=" "+i;break;default:P+=" "+s}p.html(P).show()})}else p.hide();!_.recursive&&b.isUpgradeCoupon()?N():U(C);var S=l.find("input[name=coupon]");b.number!=S.val()&&S.val(b.number)}else y.hide(),r.show().find("input[name=method_buy][value="+e.methodBuy+"]").attr("checked",!0),h.hide();var L=d.find(".noteValidLicence");s&&_.recursive?L.show():L.hide(),L=d.find(".note-campaigns-bonus"),_.hash!==v&&_.hash!==g&&"banner-business-yearly"!==_.hash&&"banner-agency-yearly"!==_.hash?L.hide():L.show();var I,B;if(a>__maxPayflowProAmount){if(I=m.find(".paymethod.method6,.paymethod.method8"),B=I.find("input[name=method_buy]"),6==e.methodBuy||8==e.methodBuy){var A=m.find(".paymethod.method2 input[name=method_buy]");A.attr("checked",!0),A.triggerHandler("click"),e.methodBuy=2}B.attr("disabled",!0),I.addClass("disabled")}else I=m.find(".paymethod.method6,.paymethod.method8"),B=I.find("input[name=method_buy]"),I.removeClass("disabled"),B.attr("disabled",!1)}},B=function(a){if(200!==a.code)return 300==a.code?void f.goToLogin():void T(a.data);if(m){if(m.find(".modal-content").html(a.data.content),a.data.upgradeCoupon&&(e.coupon=a.data.upgradeCoupon,r=new n(a.data.upgradeService)),y=a.data.alreadyReceivedCampaignsBonus,l=m.find("div.couponCont"),d=m.find("form.paymentForm"),i=a.data.isSelectedServiceInList,c=m.find(".serviceInfo"),u=m.find(".plans div.plan"),h=l.find("div.discountInfo"),p=l.find("div.couponDescription"),s=a.data.haveActiveRecurringProfile||!1,o=a.data.selectedServiceHash,"UPGRADEBS2015"===e.coupon){m.find(".plan.plan-pro").hide(),"banner-pro-yearly"===o&&(o="banner-business-yearly")}var v=new t(a.data.selectedService)||null;u.length?E(u):v&&v.hash?I(v,!0):c.html("Invalid product").show(),A(e);m.find(".paymethods input[name=method_buy]").each(function(){var n=$(this);n.click(function(){e.methodBuy=$(this).val();var n=6===e.methodBuy||8===e.methodBuy;d.attr("target",n?"_self":"_blank")}),n.val()==e.methodBuy&&(n.prop("checked",!0),n.triggerHandler("click"))}),f.referralHash&&d.find("input[name=referralHash]").val(f.referralHash),d.submit(D),!1!==e.userClick&&"undefined"!=typeof dataLayerForGoogleTagManager&&(dataLayerForGoogleTagManager.push({event:"open_gopremium_popin"}),"undefined"!=typeof dataLayerForGoogleTagManager2&&dataLayerForGoogleTagManager2.push({event:"open_gopremium_popin"})),O(),m.find("select[name=users]").change(function(){var e=$(this),n=e.closest(".feature");1==e.val()?n.addClass("singular").removeClass("plural"):n.addClass("plural").removeClass("singular")}),m.find("sup.help").each(function(){$(this).tooltip({html:!0})}),m.find("select.users").fakeSelect(),m.find("select.servviews").fakeSelect()}},A=function(e){var n=m.find(".couponHref");n.click(function(e){l.is(":visible")?(e.isTrigger||ga("b.send","event","Popin go premium","Click","Close discount"),l.slideUp("fast")):(e.isTrigger||ga("b.send","event","Popin go premium","Click","I have a discount"),l.slideDown("fast"));var n=$(this),t=$(this).html();return n.html(n.data("alttext")).data("alttext",t),!1});var t=l.find("input[name=coupon]"),a=l.find("a.applycoupon");t.keypress(function(e){if(13==e.keyCode)return a.triggerHandler("click"),ga("b.send","event","Popin go premium","Enter","Apply coupon"),!1}),a.click(function(e){return M(t.val()),e.isTrigger||ga("b.send","event","Popin go premium","Click","Apply coupon"),!1}),e.coupon&&(n.triggerHandler("click"),t.val(e.coupon),a.triggerHandler("click"),ga("b.send","event","Popin go premium","Load","Coupon automatically applied"))},H=!1,M=function(e){if(!H){H=!0;var n=l.find("div.msg");n.hide(),p.hide();var s=function(e){n.removeClass("cnot").addClass("cerr").html(e),n.fadeIn("fast")};if(!e)return f.getText("complete_your_coupon",function(e){s(e)}),H=!1,!1;var o={page:"check-coupon",coupon:e};f.isAgencyManager&&(o.isAgencyManager=1);var r=new LoaderHover(m.find(".paywith"));r.setZIndex(1040),f.ajax({data:o,complete:function(){r.remove(),H=!1},success:function(e){if(200===e.code){var n=e.data;b=new a(n.coupon),d.find("input[name=coupon]").val(b.number),e.data.service?(i=!1,I(new t(e.data.service),!0)):I(_,!0),C=n.message,U(C),m.find(".couponHref").hide()}else s(e.data),b=null,C=null,I(_,!0)}})}},O=function(){var e=m.find(".plans-type"),n=e.find("a"),t=m.find(".plans"),a=e.find(".onoffswitch-popin-checkbox"),i=function(){t.removeClass("col1 col2 col3").addClass("col"+t.find(".plan:visible").length)};a.change(function(){"checked"===$(this).attr("checked")?m.find(".plans-type a.yearly").trigger("click"):m.find(".plans-type a.monthly").trigger("click")}),n.on("click",function(){if($(this).hasClass("selected"))return!1;var e=$(this).hasClass("monthly")?1:12,s=!1;m.find("select[name=add_serv]").each(function(){var n=$(this),t=n.find("option[data-months="+e+"]"),a=n.closest(".plan");if(t.length){n.val(t.val());var i=!(a.hasClass("selected")||s);n.triggerHandler("change",i),s=!1,a.show()}else a.hide(),a.hasClass("selected")&&(s=!0)}),n.removeClass("selected"),$(this).addClass("selected");var o=m.find(".price-yearly-info.active");return 12==e?(ga("b.send","event","Popin go premium","Click","Yearly plan"),t.addClass("yearly").removeClass("monthly"),o.css("visibility","visible"),a.attr("checked",!0)):(ga("b.send","event","Popin go premium","Click","Monthly plan"),t.addClass("monthly").removeClass("yearly"),o.css("visibility","hidden"),a.attr("checked",!1)),i(),!1}),i(),_.recursive&&1==_.months&&e.find("a.monthly").triggerHandler("click")},D=function(e,n){if(!w)return!1;var t=new LoaderHover(m.find(".modal-body"));if(t.setZIndex(1040),ga("b.send","event","Popin go premium","Click","Post your order"),!0!==n){if(b&&(b.isUpgradeCoupon()||b.isTypeUpgrade())&&_.recursive){if(_.price-b.getDiscount(_)<1)return f.getTexts(["bs_cant_upgrade_downgrade","bs_cant_upgrade_downgrade_content"],function(e){t.remove(),BSAlert("<strong>"+e.bs_cant_upgrade_downgrade+"</strong><br><br>"+e.bs_cant_upgrade_downgrade_content)},{raw:!0}),!1}if(_.users&&w.hasUsedFunds&&!f.isAgencyManager)return f.getTexts(["bs_user_has_funds_history_err"],function(e){t.remove(),BSAlert(e.bs_user_has_funds_history_err)},{raw:!0}),!1;if(R(function(){d.triggerHandler("submit",!0),t.remove()},function(){t.remove()}))return!1}f.onBuyPoints();var a=d.attr("action")+"?"+d.serialize();return"_blank"===d.attr("target")?(m.modal("hide"),window.open(a)):location.href=a,t.remove(),!1},E=function(e){e.each(function(){var n=this,a=$(this),i=a;if(!a.hasClass("free")){var s=a.find('select[name="add_serv"]'),r=a.find('select[name="views"]'),l=a.find('select[name="users"]'),d=!!s.data("recursive");a.click(function(n){n.isTrigger||(i.hasClass("plan-basic")?ga("b.send","event","Popin go premium","Click","Basic"):i.hasClass("plan-pro")?ga("b.send","event","Popin go premium","Click","Pro"):ga("b.send","event","Popin go premium","Click","Business")),e.removeClass("selected"),i.addClass("selected"),i.find('input[name="selservice"]').attr("checked",!0);var o=s.find("option:selected"),c=new t({months:parseInt(o.data("months"))||0,recursive:d,price:parseFloat(o.data("price")),hash:o.val(),views:parseInt(r.val())||0,users:null});l.length&&(c.users=parseInt(l.val())),(c.users||c.views)&&(c.price=c.price*(c.users||1)*((c.views||1e5)/1e5)),I(c),c.hash===v||c.hash===g?a.find(".inf .bonus-campaigns").show():a.find(".inf .bonus-campaigns").hide()});var c=!!i.data("showPricePerPoint");s.change(function(e,t){var a=s.find("option:selected"),o=a.data("months"),d=a.data("price"),u=$(n).find("div.price"),h=o?d/o:c?d/a.data("points"):d;(r.length||l.length)&&(h=h*(l.val()||1)*((r.val()||1e5)/1e5)),12==a.data("months")&&(i.find(".price-yearly-info em").text(formatNumber(12*h)),i.find(".price-fake b").text(formatNumber(h))),u.find("strong").text(formatNumber(h)),t||i.triggerHandler("click")}),f.isAgencyManager&&BSC.agencyManagersCount>1&&l.find("option").each(function(){$(this).val()<BSC.agencyManagersCount&&$(this).remove()}),r.add(l).on("change",function(){s.triggerHandler("change",!0),i.triggerHandler("click")}),s.find('option[value="'+o+'"]').length&&(s.val(o),a.triggerHandler("click")),s.triggerHandler("change",!0)}})},R=function(e,n){var t=!1,a=!1,i=null,s=b&&b.isUpgradeCoupon(),o=["bs_do_you_want_to_continue","bs_upgrade_note_yes","bs_upgrade_note_no","bs_important_note"];return _.recursive&&(o.push("bs_important_upgrade_note","bs_existing_subscription_used_as_discount"),r&&(r.isFromBannersnack()?r.haveUsers()&&_.users&&(r._users==_.users&&r.views==_.views||(o.push("bs_bannersnack_license_will_be_changed_to"),i="bs_bannersnack_license_will_be_changed_to")):(o.push("bs_upgrade_changing_your_license_to"),i="bs_upgrade_changing_your_license_to")),(i||s)&&(t=!0,a=!0)),_.users&&!f.isAgencyManager&&(w.hasCampaigns||w.hasAudiences)&&(o.push("bs_note_has_campaigns"),a=!0),a&&f.getTexts(o,function(a){var o="";if(t&&(s&&(o=a.bs_existing_subscription_used_as_discount),i))switch(i){case"bs_upgrade_changing_your_license_to":a[i]=a[i].replace(/{license}/g,_.getPlanName()),o&&(o="<br><br>"+o),o=a[i]+o;break;case"bs_bannersnack_license_will_be_changed_to":a[i]=a[i].replace("{users}",_.users),a[i]=a[i].replace("{views}",formatNumber(_.views)),o=a[i]+" "+o}a.bs_note_has_campaigns&&(o&&(o+="<br><br>"),o+=a.bs_note_has_campaigns);var r=$('<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="bs-upgrade-note-modal" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title">'+(t&&b&&b.isUpgradeCoupon()?a.bs_important_upgrade_note:a.bs_important_note)+'</h4></div><div class="modal-body">'+o+'</div><div class="modal-footer"><strong style="margin-right: 30px">'+a.bs_do_you_want_to_continue+'</strong><button type="button" class="btn btn-primary">'+a.bs_upgrade_note_yes+'</button><button type="button" class="btn btn-default">'+a.bs_upgrade_note_no+"</button></div></div></div></div>"),l=!1;r.on("hidden.bs.modal",function(){r.remove(),l||n.apply(r)}),r.modal(),r.find(".btn-primary").on("click",function(){r.modal("hide"),e&&"function"==typeof e&&(l=!0,e.apply())}),r.find(".btn-default").on("click",function(){r.modal("hide"),n&&"function"==typeof n&&(l=!0,n.apply())})},{raw:!0}),a};n.prototype={isFromBannersnack:function(){return"bannersnack"===this.terminal},haveUsers:function(){return!!(this._users&&this._users>0)}},t.prototype={getPlanName:function(){return 0===this.hash.indexOf("banner-agency")?"Bannersnack Agency":0===this.hash.indexOf("banner-business")?"Bannersnack Business":0===this.hash.indexOf("banner-vip-membership")||0===this.hash.indexOf("banner-pro")?"Bannersnack Pro":0===this.hash.indexOf("banner-basic")?"Bannersnack Basic":"Bannersnack"}},a.prototype={getDiscount:function(e){var n=0;return this.isUpgradeCoupon()&&!e.recursive?0:(n=this.isProcentual()?e.price*parseFloat(this.value)/100:this.isTypeUpgrade()?(e.price-this.upgradeDiscountValue)*this.value/100+this.upgradeDiscountValue:parseFloat(this.value),n=Math.round(100*n)/100)},isUpgradeCoupon:function(){return!!(32&this.flags)},isTypeUpgrade:function(){return this.type===this.COUPON_TYPE_UPGRADE},isProcentual:function(){return this.type==this.COUPON_TYPE_PROCENTUAL},isSubscriptionProcentual:function(){return this.subscription_type==this.COUPON_TYPE_PROCENTUAL},COUPON_TYPE_PROCENTUAL:"procentual",COUPON_TYPE_UPGRADE:"upgrade"},function(){f.buyPointsModal&&f.buyPointsModal.is(":visible")&&f.buyPointsModal.modal("hide"),m=$('<div class="modal fade" id="" tabindex="-1" role="dialog" aria-labelledby="buy-points" aria-hidden="true" id="buyPointsModal"><div class="modal-dialog modal-buy-points" style="width: 100%; max-width: 900px;"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title">Loading...</h4></div><div class="modal-body" style="min-height: 500px"></div></div></div></div>'),m.on("shown.bs.modal",x),m.on("hidden.bs.modal",P),m.modal("show"),e.methodBuy||(e.methodBuy=2),f.buyPointsModal=m,k()}()},CancelSubscriptionPopin=function(e){this.init(),this.cancelSubscription=e};CancelSubscriptionPopin.prototype={init:function(){var e=this,n=this.loadOptions();n=e.shuffleOptions(n);var t='<div class="modal fade large cancel-subscription-popin" tabindex="-1" role="dialog" >   <div class="modal-dialog">       <div class="modal-content">           <div class="modal-header">'+e.getHeaderHtml()+'</div>           <div class="modal-body">'+e.getBodyHtml(n)+"</div>       </div>   </div></div>",a=$(t);e.modal=a.modal(),e.customizeRadioInput(),e.buttonsClickHandler(),e.optionsClickHandler(),e.otherOptionClickHandler()},getBodyHtml:function(e){for(var n="",t=0;t<e.length;t++)n+='<div class="radio"><label><input type="radio" name="reason" id="option-'+t+'"value="'+e[t].value+'">'+e[t].translation+"</label></div>";return"<p>"+getTxt("tell_us_why_cancel")+'</p><div class="options container">'+n+'<div class="radio"><label><input type="radio" name="reason" id="option-other" value="other">'+getTxt("other_reason")+':</label></div><textarea class="form-control option-other-text" style="display: none" maxlength="500"></textarea><a class="btn btn-default" id="cancel_subscription" disabled>'+getTxt("cancel_subscription")+'</a><a class="btn btn-success" id="keep_subscription">'+getTxt("keep_subscription")+"</a></div>"},getHeaderHtml:function(){return"<h1>"+getTxt("we_miss_you_already")+"</h1><span>"+getTxt("access_to_premium_options")+"</span>"},buttonsClickHandler:function(){var e=this;e.modal.find("a").on("click",function(n){if("cancel_subscription"===n.target.id){var t=e.checkCancelSubscriptionReason();t&&(e.cancelSubscription(t),e.modal.modal("hide"))}else e.modal.modal("hide")})},optionsClickHandler:function(){var e=this;e.modal.find("input[type=radio]").on("click",function(n){"option-other"===n.target.id?e.modal.find("textarea.option-other-text").removeClass("has-error").slideDown("fast",function(){$(this).focus().css("overflow","auto")}):e.modal.find("textarea.option-other-text").slideUp("fast"),e.modal.find("#cancel_subscription").attr("disabled",!1)})},otherOptionClickHandler:function(){this.modal.find("textarea.option-other-text").on("click",function(){$(this).removeClass("has-error")})},checkCancelSubscriptionReason:function(){var e=this,n=e.modal.find("span.checked input[type=radio]");if("option-other"!==n[0].id)return n.val();var t=e.modal.find("textarea.option-other-text");return $.trim(t.val()).length<1?(t.addClass("has-error"),!1):e.modal.find("textarea.option-other-text").val()},shuffleOptions:function(e){for(var n=e.length-1;n>0;n--){var t=Math.floor(Math.random()*(n+1)),a=e[n];e[n]=e[t],e[t]=a}return e},customizeRadioInput:function(){this.modal.find("input[type=radio]").customInput().parent().css("float","none")},loadOptions:function(){for(var e=[{value:"I don’t need it anymore",translation:"no_need_anymore"},{value:"It’s too expensive",translation:"too_expensive"},{value:"It’s not what I expected",translation:"not_what_expected"},{value:"I’m not using the product enough",translation:"not_using_the_product"},{value:"It’s too complicated",translation:"too_complicated"}],n=0;n<e.length;n++)e[n].translation=getTxt(e[n].translation);return e}};var LoggedUser=function(e){this.setUserData(e),this.premium&&(this._reloadInterval=15),this._setReloadTimeout()};LoggedUser.prototype={setUserData:function(e){for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n])},setNewTimeout:function(e){this._reloadInterval=e,this.reload()},reload:function(){var e=this;this._rt&&clearTimeout(this._rt),e._setReloadTimeout(),$.ajax({data:{page:"get-user-info"},success:function(n){20===n.code?(window.userData=n.res.data,e.setUserData(userData),n.res.wl_data&&(window.WL_DATA=n.res.wl_data)):500===n.code&&e.setUserData({sessionExpired:!0})}})},_reloadInterval:10,_rt:null,_setReloadTimeout:function(){this._rt=setTimeout(function(){this.reload()}.bind(this),1e3*this._reloadInterval)}};var loggedUser;$(function(){loggedUser=new LoggedUser(userData)});var ignoreNextRouter=!1,getLoader=function(e){return $('<div class="loader-hover custom-banners-loader">    <div class="loader-overlay"></div>    <svg preserveAspectRatio="none" version="1.1" width="28px" height="28px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" fill="#fff" viewBox="0 0 51 51" style="">        <defs>            <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%">                <stop offset="0%"></stop>                <stop offset="100%"></stop>            </linearGradient>        </defs>        <path d="M25.5,4C37.4,4,47,13.6,47,25.5S37.4,47,25.5,47S4,37.4,4,25.5S13.6,4,25.5,4 M25.5,0C11.4,0,0,11.4,0,25.5C0,39.6,11.4,51,25.5,51C39.6,51,51,39.6,51,25.5C51,11.4,39.6,0,25.5,0L25.5,0z" fill="url(#grad1)"></path>        <path class="actionMask" fill="transparent" fill-rule="evenodd" clip-rule="evenodd" d="M25.5,0C39.6,0,51,11.4,51,25.5S39.6,51,25.5,51S0,39.6,0,25.5S11.4,0,25.5,0z"></path>    </svg></div>').addClass("loader"+(e?" "+e:""))},getTxt=function(e){return"object"==typeof langTextsJs&&void 0!==langTextsJs[e]&&langTextsJs[e]?langTextsJs[e]:""},getTxtDecoded=function(e){return"object"==typeof langTextsJs&&void 0!==langTextsJs[e]&&langTextsJs[e]?$("<div/>").html(langTextsJs[e]).text():""};$(document).ready(function(){var e;setInterval(function(){ga("b.send","event","KeepAlive","KeepAlive ","",0,{nonInteraction:!0})},3e5),e=$(window),e.bind("orientationchange",function(){var e=$("meta[name=viewport]");screen.width>=768?e.prop("content","width=device-width, initial-scale=1"):e.prop("content","width=768")})});var SidebarNav=function(){this.checkWidth()};SidebarNav.prototype={init:function(){this.headerEventTrackingLogged(),this.addConfirmBeforeUnload(),this.container=$(".app-sidebar-nav");var e=this,n=$("body");router.parseNavLinks(this.container),this.lis=this.container.find(".height-helper").children("ul").children("li"),this.navLinks=this.container.find("a.nav-link"),this.menuItems=this.container.find("a.menu-item"),this._isSmallWidth=this.isSmallWidth(),this.isSmallWidth()&&this.container.addClass("small-width"),isTouchDevice||this.lis.on("hover",function(t){var a=n.hasClass("small-sidebar"),i=$(this).hasClass("account");(a||i)&&($(window).triggerHandler("click.navmenu"),e.handleLiClick(this,!1,t,!1))}),this.lis.on("click",function(n){e.handleLiClick(this,!1,n,!0)}),e.navLinks.on("click",function(n){e.deselectLinks(),$(this).addClass("selected"),n.preventDefault()}),$(window).bind("resize.sidebarNav",function(){e.onWindowResize()}),this.checkScroll(),router.onChangeRoute(function(){e.checkCurrentUrl()},!0),window.localStorage&&localStorage.getItem("bsUseOldMyBanners")&&this.container.find("a.my-banners-link").attr("href",langPre+"/my-banners/?re=menu"),this.checkCurrentUrl(),this.initLanguageSelect(),this.initCollapse()},headerEventTrackingLogged:function(){$(".app-sidebar-nav").find("*").on("click",function(){($(this).hasClass("will-expand")&&!$(this).hasClass("selected")&&!$(this).hasClass("account")||"1"==$(this).attr("data-gatrack"))&&ga("b.send","event","Menu - logged in","Click",$(this).attr("data-gatrack-name"))})},deselectLinks:function(){this.navLinks.removeClass("selected"),this.menuItems.removeClass("selected")},checkCurrentUrl:function(){var e=this,n=function(e){return e.replace(/^.*\/\/[^\/]+/,"")},t=n(location.href),a=[t];t.indexOf("#")>=0&&a.push(t.substr(0,t.indexOf("#"))),t.indexOf("?")>=0&&a.push(t.substr(0,t.indexOf("?")));for(var i,s=0;s<a.length&&!(i=function(t){if(!t)return null;var a=null;return e.navLinks.each(function(){if(0===n($(this).prop("href")).indexOf(t))return a=$(this),!1}),a}(a[s]));s++);if(i&&!i.hasClass("selected")&&!i.hasClass("create-rotator-link")){var o=i.closest("li");this.navLinks.removeClass("selected"),i.addClass("selected"),this.handleLiClick(o,!0)}},openLI:function(e){var n=this;this.lis&&this.lis.each(function(){if($(this).data("for")==e)return n.handleLiClick($(this),!0),!1})},handleLiClick:function(e,n,t,a){var i=this,s=$(window),e=$(e),o=e.hasClass("account");if(e.hasClass("selected")||e.hasClass("not-selectable")){var r=$("body"),l=r.hasClass("small-sidebar");return void((!a&&e.hasClass("single")||isTouchDevice&&l)&&e.removeClass("selected"))}if(i.isSmallWidth()||!o?this.lis.removeClass("selected"):i.lis.each(function(){$(this).is(".selected.single")&&$(this).removeClass("selected")}),n&&(o||this.isSmallWidth())||e.addClass("selected"),(this.isSmallWidth()||o)&&e.hasClass("will-expand")&&!n){var d=e.find(".sidebar-nav-expanded");d.data("prev",d.prev()),d.addClass("right-side"),$("body").append(d);var c=function(){i.positionMenu(d,e)};c();var u=function(){s.unbind("scroll resize",c),i.container.unbind("scroll",c),s.unbind("click.navmenu",u),d.removeClass("right-side"),d.data("prev").after(d),e.removeClass("selected"),d.find(".language-holder.expanded").removeClass("expanded"),e.unbind("mouseleave",h),d.unbind("mouseleave",h)},h=function(){var n=!0;d.bind("mouseenter",function(){n=!1}),e.bind("mouseenter",function(){n=!1}),setTimeout(function(){n&&u()},1)};s.bind("scroll resize",c),i.container.bind("scroll",c),setTimeout(function(){a&&s.bind("click.navmenu",u)},1),a||(e.bind("mouseleave",h),d.bind("mouseleave",h))}i.checkScroll()},positionMenu:function(e,n){var t=n.offset(),a=n.width();e.css({top:t.top-$(window).scrollTop()+"px",left:t.left+a-$(window).scrollLeft()+"px"}),e.find(">.hide-border").height(n.height()-1)},onWindowResize:function(){this.checkWidth();var e=this.isSmallWidth();this._isSmallWidth!=e&&($(window).triggerHandler("click"),e?this.container.addClass("small-width"):this.container.removeClass("small-width")),this.checkScroll(),this._isSmallWidth=e},checkScroll:function(){this.container.find(".height-helper").height()+43>$(window).height()-$(".logo").height()?this.container.addClass("with-scroll"):this.container.removeClass("with-scroll"),this.container.addClass("js-loaded")},isSmallWidth:function(){return this.container.width()<100},initLanguageSelect:function(){var e=this.container.find(".languages-link"),n=e.closest(".language-holder"),t=n.find(".language-expanded"),a=function(e){var n=location.pathname.split("/");n.splice(0,1),n[0].length<=4&&"faq"!=n[0]&&n.splice(0,1);var t="/"+n.join("/")+location.search+location.hash,a=$(this).data("lang");"en"!=a.lang&&(t="/"+a.dc+t),$.userApi.cookie("lang",a.lang,{expires:365,path:"/"}),$.userApi.cookie("country",a.dc,{expires:365,path:"/"}),e.preventDefault(),location.href=t};if("object"==typeof LANGUAGES){var i,s,o,r;for(s=0;i=LANGUAGES[s];s++)i.lang!=CURRENT_LANGUAGE&&(o=1&!parseInt(i.flags),r=$('<a href="#" class="menu-item">'+i.langName+(o?" ("+htmlChars(i.langNamePartially)+")":"")+"</a>"),r.data("lang",i),r.on("click",a),t.append(r))}e.on("click",function(e){e.preventDefault(),e.stopPropagation()});var l=function(){t.hide()};n.hover(function(){t.show()},function(){l()}),isTouchDevice&&(n.on("touchend",function(e){e.stopPropagation()}),$("body").on("touchend",function(e){l()}))},reload:function(){$.ajax({data:{page:"reload-sidebar"},success:function(e){20==e.code&&(this.container.html(e.res.content),this.init())}.bind(this)})},getCollapseWidth:function(){return router.isEditorPage()?1400:1024},_firstChecked:!1,checkWidth:function(){var e="undefined"!=typeof sessionStorage&&void 0!==sessionStorage.sidebarNavCollapse;if(!e||!this._firstChecked){var n=$(window);if($("body").length)this._firstChecked=!0,e?this.collapse(JSON.parse(sessionStorage.sidebarNavCollapse)):n.width()<=this.getCollapseWidth()?this.collapse(!0):this.collapse(!1);else{var t=this;setTimeout(function(){t.checkWidth()},30)}}},collapse:function(e,n){var t,a=$("body"),i=this;if(e)if(n)a.addClass("no-sidebar"),t=this.container,setTimeout(function(){a.removeClass("no-sidebar").addClass("small-sidebar"),t&&t.find(".will-expand").removeClass("selected"),i.checkScroll(),$(window).trigger("resize")},250),ga("b.send","event","Menu - logged in","Click","Collapse");else{var i=this;$(function(){t=i.container,a.addClass("small-sidebar"),t&&t.find(".will-expand").removeClass("selected")})}else n?(a.addClass("no-sidebar"),setTimeout(function(){a.removeClass("small-sidebar no-sidebar"),$(".nav-link.selected, .create-rotator-link.selected").closest(".will-expand:not(.account)").addClass("selected"),i.checkScroll(),$(window).trigger("resize")},250),ga("b.send","event","Menu - logged in","Click","Expand")):(a.removeClass("small-sidebar"),$(".nav-link.selected, .create-rotator-link.selected").closest(".will-expand:not(.account)").addClass("selected"));if($(window).trigger("sidebarCollapse"),n)try{sessionStorage.sidebarNavCollapse=e
}catch(e){}},addConfirmBeforeUnload:function(){var e=this,n=!0;window.addEventListener("beforeunload",function(t){if(e.isInEditor()&&n){n=!1;var a=getTxt("leave_app_page_confirm");return t.returnValue=a,setTimeout(function(){n=!0},150),a}})},initCollapse:function(){this.container.find(".col-ex").on("click",function(){this.collapse(!$("body").hasClass("small-sidebar"),!0)}.bind(this))},isInEditor:function(){return $("#editorContainer").length&&!$("#bannerCreatorApp").length||$("#flashContentContainer").length&&$("#flashContentContainer").is(":visible")||$("#rotator-edit").length>0}};var s=new SidebarNav,sidebarNav={openLI:function(e){this._openLi=e}};sidebarNav.init=function(){s.init(),this._openLi&&this.openLI(this._openLi)},sidebarNav.openLI=function(e){s.openLI(e)},sidebarNav.deselectLinks=function(){s.deselectLinks()},sidebarNav.reload=function(){s.reload()},sidebarNav.checkWidth=function(){s.checkWidth()},sidebarNav.isSmallWidth=function(){return s.isSmallWidth()},sidebarNav.isInEditor=function(){return s.isInEditor()};