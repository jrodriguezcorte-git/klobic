function isMobileSafari(){return navigator.userAgent.match(/(iPod|iPhone|iPad)/)}function isMobileDevice(){return testDevice(mobileArray)}function isStupidMobile(){return testDevice(noFontFace)}function isSmallMobile(){return isMobileDevice()&&$(window).width()*$(window).height()<=307200}function testDevice(a){var b;for(b=0;b<a.length;b++)if(navigator.appVersion.indexOf(a[b])>-1)return!0;for(b=0;b<a.length;b++)if(navigator.userAgent.indexOf(a[b])>-1)return!0;return!1}(function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?void(this._wrapped=a):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.4.3";var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g in a)if(x.has(a,g)&&b.call(d,a[g],g,a)===c)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)},d),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c}),!!e)};x.contains=x.include=function(a,b){return null!=a&&(s&&a.indexOf===s?a.indexOf(b)!=-1:A(a,function(a){return a===b}))},x.invoke=function(a,b){var c=h.call(arguments,2);return x.map(a,function(a){return(x.isFunction(b)?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b,c){return x.isEmpty(b)?c?null:[]:x[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-(1/0);var d={computed:-(1/0),value:-(1/0)};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index<b.index?-1:1}),"value")};var C=function(a,b,c,d){var e={},f=B(b||x.identity);return y(a,function(b,g){var h=f.call(c,b,g,a);d(e,h,b)}),e};x.groupBy=function(a,b,c){return C(a,b,c,function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)})},x.countBy=function(a,b,c){return C(a,b,c,function(a,b){x.has(a,b)||(a[b]=0),a[b]++})},x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;f<g;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){if(null!=a)return null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){if(null!=a)return null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return y(a,function(a){x.isArray(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(i.apply(d,arguments))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=h.call(arguments),b=x.max(x.pluck(a,"length")),c=new Array(b),d=0;d<b;d++)c[d]=x.pluck(a,""+d);return c},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;d<e;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=c<0?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;d<e;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);e<d;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(a.bind===w&&w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.bindAll=function(a){var b=h.call(arguments,1);return 0==b.length&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b){var c,d,e,f,g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)};return function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,j<=0?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},x.debounce=function(a,b,c){var d,e;return function(){var f=this,g=arguments,h=function(){d=null,c||(e=a.apply(f,g))},i=c&&!d;return clearTimeout(d),d=setTimeout(h,b),i&&(e=a.apply(f,g)),e}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&(b[b.length]=c);return b},x.values=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push(a[c]);return b},x.pairs=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push([c,a[c]]);return b},x.invert=function(a){var b={};for(var c in a)x.has(a,c)&&(b[a[c]]=c);return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)null==a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;c.push(a),d.push(b);var g=0,h=!0;if("[object Array]"==e){if(g=a.length,h=g==b.length)for(;g--&&(h=F(a[g],b[g],c,d)););}else{var i=a.constructor,k=b.constructor;if(i!==k&&!(x.isFunction(i)&&i instanceof i&&x.isFunction(k)&&k instanceof k))return!1;for(var l in a)if(x.has(a,l)&&(g++,!(h=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(h){for(l in b)if(x.has(b,l)&&!g--)break;h=!g}}return c.pop(),d.pop(),h};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(a),e=0;e<a;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+(0|Math.random()*(b-a+1))};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null==a)return null;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=""+ ++I;return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){c=x.defaults({},c,x.templateSettings);var d=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(L,function(a){return"\\"+K[a]}),c&&(f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(f+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),g&&(f+="';\n"+g+"\n__p+='"),e=h+b.length,b}),f+="';\n",c.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var g=new Function(c.variable||"obj","_",f)}catch(h){throw h.source=f,h}if(b)return g(b,x);var i=function(a){return g.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+f+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),function(){var a,b=this,c=b.Backbone,d=[],e=d.push,f=d.slice,g=d.splice;a="undefined"!=typeof exports?exports:b.Backbone={},a.VERSION="0.9.9";var h=b._;h||"undefined"==typeof require||(h=require("underscore")),a.$=b.jQuery||b.Zepto||b.ender,a.noConflict=function(){return b.Backbone=c,this},a.emulateHTTP=!1,a.emulateJSON=!1;var i=/\s+/,j=function(a,b,c,d){if(!c)return!0;if("object"==typeof c)for(var e in c)a[b].apply(a,[e,c[e]].concat(d));else{if(!i.test(c))return!0;for(var f=c.split(i),g=0,h=f.length;g<h;g++)a[b].apply(a,[f[g]].concat(d))}},k=function(a,b,c){var d,e=-1,f=b.length;switch(c.length){case 0:for(;++e<f;)(d=b[e]).callback.call(d.ctx);return;case 1:for(;++e<f;)(d=b[e]).callback.call(d.ctx,c[0]);return;case 2:for(;++e<f;)(d=b[e]).callback.call(d.ctx,c[0],c[1]);return;case 3:for(;++e<f;)(d=b[e]).callback.call(d.ctx,c[0],c[1],c[2]);return;default:for(;++e<f;)(d=b[e]).callback.apply(d.ctx,c)}},l=a.Events={on:function(a,b,c){if(!j(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,c){if(!j(this,"once",a,[b,c])||!b)return this;var d=this,e=h.once(function(){d.off(a,e),b.apply(this,arguments)});return e._callback=b,this.on(a,e,c),this},off:function(a,b,c){var d,e,f,g,i,k,l,m;if(!this._events||!j(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;for(g=a?[a]:h.keys(this._events),i=0,k=g.length;i<k;i++)if(a=g[i],d=this._events[a]){if(f=[],b||c)for(l=0,m=d.length;l<m;l++)e=d[l],(b&&b!==(e.callback._callback||e.callback)||c&&c!==e.context)&&f.push(e);this._events[a]=f}return this},trigger:function(a){if(!this._events)return this;var b=f.call(arguments,1);if(!j(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&k(this,c,b),d&&k(this,d,arguments),this},listenTo:function(a,b,c){var d=this._listeners||(this._listeners={}),e=a._listenerId||(a._listenerId=h.uniqueId("l"));return d[e]=a,a.on(b,c||this,this),this},stopListening:function(a,b,c){var d=this._listeners;if(d){if(a)a.off(b,c,this),b||c||delete d[a._listenerId];else{for(var e in d)d[e].off(null,null,this);this._listeners={}}return this}}};l.bind=l.on,l.unbind=l.off,h.extend(a,l);var m=a.Model=function(a,b){var c,d=a||{};this.cid=h.uniqueId("c"),this.changed={},this.attributes={},this._changes=[],b&&b.collection&&(this.collection=b.collection),b&&b.parse&&(d=this.parse(d)),(c=h.result(this,"defaults"))&&h.defaults(d,c),this.set(d,{silent:!0}),this._currentAttributes=h.clone(this.attributes),this._previousAttributes=h.clone(this.attributes),this.initialize.apply(this,arguments)};h.extend(m.prototype,l,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(a){return h.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return h.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,e;if(null==a)return this;h.isObject(a)?(e=a,c=b):(e={})[a]=b;var f=c&&c.silent,g=c&&c.unset;if(!this._validate(e,c))return!1;this.idAttribute in e&&(this.id=e[this.idAttribute]);var i=this.attributes;for(d in e)b=e[d],g?delete i[d]:i[d]=b,this._changes.push(d,b);return this._hasComputed=!1,f||this.change(c),this},unset:function(a,b){return this.set(a,void 0,h.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var c in this.attributes)b[c]=void 0;return this.set(b,h.extend({},a,{unset:!0}))},fetch:function(a){a=a?h.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d,e,f){return!!b.set(b.parse(d),a)&&void(c&&c(b,d,a))},this.sync("read",this,a)},save:function(a,b,c){var d,e,f;if(null==a||h.isObject(a)?(d=a,c=b):null!=a&&((d={})[a]=b),c=c?h.clone(c):{},c.wait){if(d&&!this._validate(d,c))return!1;e=h.clone(this.attributes)}var g=h.extend({},c,{silent:!0});if(d&&!this.set(d,c.wait?g:c))return!1;if(!d&&!this._validate(null,c))return!1;var i=this,j=c.success;c.success=function(a,b,e){f=!0;var g=i.parse(a);return c.wait&&(g=h.extend(d||{},g)),!!i.set(g,c)&&void(j&&j(i,a,c))};var k=this.isNew()?"create":c.patch?"patch":"update";"patch"==k&&(c.attrs=d);var l=this.sync(k,this,c);return!f&&c.wait&&(this.clear(g),this.set(e,g)),l},destroy:function(a){a=a?h.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(a.success=function(e){(a.wait||b.isNew())&&d(),c&&c(b,e,a)},this.isNew())return a.success(),!1;var e=this.sync("delete",this,a);return a.wait||d(),e},url:function(){var a=h.result(this,"urlRoot")||h.result(this.collection,"url")||F();return this.isNew()?a:a+("/"===a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(a){var b=this._changing;this._changing=!0;var c=this._computeChanges(!0);this._pending=!!c.length||a&&a.forceChange;for(var d=c.length-2;d>=0;d-=2)this.trigger("change:"+c[d],this,c[d+1],a);if(b)return this;for(;this._pending;)this._pending=!1,this.trigger("change",this,a),this._previousAttributes=h.deepClone(this.attributes,!0);return this._changing=!1,this},hasChanged:function(a){return this._hasComputed||this._computeChanges(),null==a?!h.isEmpty(this.changed):h.has(this.changed,a)},changedAttributes:function(a){if(!a)return!!this.hasChanged()&&h.clone(this.changed);var b,c=!1,d=this._previousAttributes;for(var e in a)h.isEqual(d[e],b=a[e])||((c||(c={}))[e]=b);return c},_computeChanges:function(a){this.changed={};for(var b={},c=[],d=this._previousAttributes,e=this._changes,f=e.length-2;f>=0;f-=2){var g=e[f],h=e[f+1];if(!b[g]&&(b[g]=!0,d[g]!==h)){if(this.changed[g]=h,!a)continue;c.push(g,h),d[g]=h}}return a&&(this._changes=[]),this._hasComputed=!0,c},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return h.clone(this._previousAttributes)},_validate:function(a,b){if(!this.validate)return!0;a=h.extend({},this.attributes,a);var c=this.validate(a,b);return!c||(b&&b.error&&b.error(this,c,b),this.trigger("error",this,c,b),!1)}});var n=a.Collection=function(a,b){b||(b={}),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,h.extend({silent:!0},b))};h.extend(n.prototype,l,{model:m,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return a.sync.apply(this,arguments)},add:function(a,b){var c,d,f,i,j,k=b&&b.at,l=null==(b&&b.sort)||b.sort;for(a=h.isArray(a)?a.slice():[a],c=a.length-1;c>=0;c--)(f=this._prepareModel(a[c],b))?(a[c]=f,i=null!=f.id&&this._byId[f.id],i||this._byCid[f.cid]?(b&&b.merge&&i&&(i.set(f.attributes,b),j=l),a.splice(c,1)):(f.on("all",this._onModelEvent,this),this._byCid[f.cid]=f,null!=f.id&&(this._byId[f.id]=f))):(this.trigger("error",this,a[c],b),a.splice(c,1));if(a.length&&(j=l),this.length+=a.length,d=[null!=k?k:this.models.length,0],e.apply(d,a),g.apply(this.models,d),j&&this.comparator&&null==k&&this.sort({silent:!0}),b&&b.silent)return this;for(;f=a.shift();)f.trigger("add",f,this,b);return this},remove:function(a,b){var c,d,e,f;for(b||(b={}),a=h.isArray(a)?a.slice():[a],c=0,d=a.length;c<d;c++)f=this.get(a[c]),f&&(delete this._byId[f.id],delete this._byCid[f.cid],e=this.indexOf(f),this.models.splice(e,1),this.length--,b.silent||(b.index=e,f.trigger("remove",f,this,b)),this._removeReference(f));return this},push:function(a,b){return a=this._prepareModel(a,b),this.add(a,h.extend({at:this.length},b)),a},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return a=this._prepareModel(a,b),this.add(a,h.extend({at:0},b)),a},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(a,b){return this.models.slice(a,b)},get:function(a){if(null!=a)return this._byId[null!=a.id?a.id:a]||this._byCid[a.cid||a]},at:function(a){return this.models[a]},where:function(a){return h.isEmpty(a)?[]:this.filter(function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return h.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(h.bind(this.comparator,this)),a&&a.silent||this.trigger("sort",this,a),this},pluck:function(a){return h.invoke(this.models,"get",a)},update:function(a,b){var c,d,e,f,g=[],i=[],j={},k=this.model.prototype.idAttribute;if(b=h.extend({add:!0,merge:!0,remove:!0},b),b.parse&&(a=this.parse(a)),h.isArray(a)||(a=a?[a]:[]),b.add&&!b.remove)return this.add(a,b);for(d=0,e=a.length;d<e;d++)c=a[d],f=this.get(c.id||c.cid||c[k]),b.remove&&f&&(j[f.cid]=!0),(b.add&&!f||b.merge&&f)&&g.push(c);if(b.remove)for(d=0,e=this.models.length;d<e;d++)c=this.models[d],j[c.cid]||i.push(c);return i.length&&this.remove(i,b),g.length&&this.add(g,b),this},reset:function(a,b){b||(b={}),b.parse&&(a=this.parse(a));for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);return b.previousModels=this.models,this._reset(),a&&this.add(a,h.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),this},fetch:function(a){a=a?h.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d,e,f){var g=a.update?"update":"reset";b[g](d,a),c&&c(b,d,a)},this.sync("read",this,a)},create:function(a,b){var c=this;if(b=b?h.clone(b):{},a=this._prepareModel(a,b),!a)return!1;b.wait||c.add(a,b);var d=b.success;return b.success=function(a,b,e){e.wait&&c.add(a,e),d&&d(a,b,e)},a.save(null,b),a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},chain:function(){return h(this.models).chain()},_reset:function(){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(a,b){if(a instanceof m)return a.collection||(a.collection=this),a;b||(b={}),b.collection=this;var c=a.model||this.model,d=new c(a,b);return!!d._validate(a,b)&&d},_removeReference:function(a){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});var o=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortedIndex","toArray","size","first","head","take","initial","rest","tail","last","without","indexOf","shuffle","lastIndexOf","isEmpty"];h.each(o,function(a){n.prototype[a]=function(){var b=f.call(arguments);return b.unshift(this.models),h[a].apply(h,b)}});var p=["groupBy","countBy","sortBy"];h.each(p,function(a){n.prototype[a]=function(b,c){var d=h.isFunction(b)?b:function(a){return a.get(b)};return h[a](this.models,d,c)}});var q=a.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},r=/\((.*?)\)/g,s=/:\w+/g,t=/\*\w+/g,u=/[\-{}\[\]+?.,\\\^$|#\s]/g;h.extend(q.prototype,l,{initialize:function(){},route:function(b,c,d){return h.isRegExp(b)||(b=this._routeToRegExp(b)),d||(d=this[c]),a.history.route(b,h.bind(function(e){var f=this._extractParameters(b,e);d&&d.apply(this,f),this.trigger.apply(this,["route:"+c].concat(f)),a.history.trigger("route",this,c,f)},this)),this},navigate:function(b,c){return a.history.navigate(b,c),this},_bindRoutes:function(){if(this.routes)for(var a,b=h.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])},_routeToRegExp:function(a){return a=a.replace(u,"\\$&").replace(r,"(?:$1)?").replace(s,"([^/]+)").replace(t,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});var v=a.History=function(){this.handlers=[],h.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},w=/^[#\/]|\s+$/g,x=/^\/+|\/+$/g,y=/msie [\w.]+/,z=/\/$/;v.started=!1,h.extend(v.prototype,l,{interval:50,getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=this.location.pathname;var c=this.root.replace(z,"");a.indexOf(c)||(a=a.substr(c.length))}else a=this.getHash();return a.replace(w,"")},start:function(b){if(v.started)throw new Error("Backbone.history has already been started");v.started=!0,this.options=h.extend({},{root:"/"},this.options,b),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var c=this.getFragment(),d=document.documentMode,e=y.exec(navigator.userAgent.toLowerCase())&&(!d||d<=7);this.root=("/"+this.root+"/").replace(x,"/"),e&&this._wantsHashChange&&(this.iframe=a.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(c)),this._hasPushState?a.$(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!e?a.$(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=c;var f=this.location,g=f.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!g?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&g&&f.hash&&(this.fragment=this.getHash().replace(w,""),this.history.replaceState({},document.title,this.root+this.fragment+f.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){a.$(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),v.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();return b===this.fragment&&this.iframe&&(b=this.getFragment(this.getHash(this.iframe))),b!==this.fragment&&(this.iframe&&this.navigate(b),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(a){var b=this.fragment=this.getFragment(a),c=h.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0});return c},navigate:function(a,b){if(!v.started)return!1;if(b&&b!==!0||(b={trigger:b}),a=this.getFragment(a||""),this.fragment!==a){this.fragment=a;var c=this.root+a;if(this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}b.trigger&&this.loadUrl(a)}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),a.history=new v;var A=a.View=function(a){this.cid=h.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},B=/^(\S+)\s*(.*)$/,C=["model","collection","el","id","attributes","className","tagName","events"];h.extend(A.prototype,l,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},make:function(b,c,d){var e=document.createElement(b);return c&&a.$(e).attr(c),null!=d&&a.$(e).html(d),e},setElement:function(b,c){return this.$el&&this.undelegateEvents(),this.$el=b instanceof a.$?b:a.$(b),this.el=this.$el[0],c!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(a||(a=h.result(this,"events"))){this.undelegateEvents();for(var b in a){var c=a[b];if(h.isFunction(c)||(c=this[a[b]]),!c)throw new Error('Method "'+a[b]+'" does not exist');var d=b.match(B),e=d[1],f=d[2];c=h.bind(c,this),e+=".delegateEvents"+this.cid,""===f?this.$el.bind(e,c):this.$el.delegate(f,e,c)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=h.extend({},h.result(this,"options"),a)),h.extend(this,h.pick(a,C)),this.options=a},_ensureElement:function(){if(this.el)this.setElement(h.result(this,"el"),!1);else{var a=h.extend({},h.result(this,"attributes"));this.id&&(a.id=h.result(this,"id")),this.className&&(a["class"]=h.result(this,"className")),this.setElement(this.make(h.result(this,"tagName"),a),!1)}}});var D={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};a.sync=function(b,c,d){var e=D[b];h.defaults(d||(d={}),{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var f={type:e,dataType:"json"};if(d.url||(f.url=h.result(c,"url")||F()),null!=d.data||!c||"create"!==b&&"update"!==b&&"patch"!==b||(f.contentType="application/json",f.data=JSON.stringify(d.attrs||c.toJSON(d))),d.emulateJSON&&(f.contentType="application/x-www-form-urlencoded",f.data=f.data?{model:f.data}:{}),d.emulateHTTP&&("PUT"===e||"DELETE"===e||"PATCH"===e)){f.type="POST",d.emulateJSON&&(f.data._method=e);var g=d.beforeSend;d.beforeSend=function(a){if(a.setRequestHeader("X-HTTP-Method-Override",e),g)return g.apply(this,arguments)}}"GET"===f.type||d.emulateJSON||(f.processData=!1);var i=d.success;d.success=function(a,b,e){i&&i(a,b,e),c.trigger("sync",c,a,d)};var j=d.error;d.error=function(a,b,e){j&&j(c,a,d),c.trigger("error",c,a,d)};var k=a.ajax(h.extend(f,d));return c.trigger("request",c,k,d),k},a.ajax=function(){return a.$.ajax.apply(a.$,arguments)};var E=function(a,b){var c,d=this;c=a&&h.has(a,"constructor")?a.constructor:function(){d.apply(this,arguments)},h.extend(c,d,b);var e=function(){this.constructor=c};return e.prototype=d.prototype,
c.prototype=new e,a&&h.extend(c.prototype,a),c.__super__=d.prototype,c};m.extend=n.extend=q.extend=A.extend=v.extend=E;var F=function(){throw new Error('A "url" property or function must be specified')}}.call(this);var alignManager={snapDistance:4,getRotatedRectangle:function(a){for(var b=Math.sin(a.angle*Math.PI/180),c=Math.cos(a.angle*Math.PI/180),d=[{x:a.x,y:a.y},{x:a.x+a.width,y:a.y},{x:a.x+a.width,y:a.y+a.height},{x:a.x,y:a.y+a.height}],e=a.x+a.width,f=a.y+a.height,g=a.x,h=a.y,i=0;i<d.length;i++){var j=d[i].x-a.center.x,k=d[i].y-a.center.y,l=Math.round(j*c-k*b),m=Math.round(j*b+k*c);e=Math.min(l+a.center.x,e),f=Math.min(m+a.center.y,f),g=Math.max(l+a.center.x,g),h=Math.max(m+a.center.y,h)}var n={x:e,y:f,width:g-e,height:h-f,xy:e+g-e,yx:f+h-f,center:new Point(e+(g-e)/2,f+(h-f)/2),angle:a.angle};return n},getBannerMetrics:function(){var a={x:0,y:0,width:Number(editor.banner.get("width")),height:Number(editor.banner.get("height")),angle:0},b={x:0,y:0,width:a.width,height:a.height,xy:a.width,yx:a.height,center:new Point(a.x+a.width/2,a.y+a.height/2),angle:a.angle};return b},getModelMetrics:function(a){var b={x:Number(a.get("x")),y:Number(a.get("y")),width:Number(a.get("width")),height:Number(a.get("height")),angle:a.get("rotation")?Number(a.get("rotation")):0},c={x:b.x,y:b.y,width:b.width,height:b.height,xy:b.x+b.width,yx:b.y+b.height,center:new Point(b.x+b.width/2,b.y+b.height/2),angle:b.angle};return 0!==b.angle?this.getRotatedRectangle(c):c},getSlideElements:function(a,b,c){var d=[];_.isArray(b)?d=b:d.push(b);for(var e=[],f=0;f<a.elements.models.length;f++)d.indexOf(a.elements.models[f])>-1?c&&e.push(a.elements.models[f]):1==a.elements.models[f].get("visible")&&e.push(a.elements.models[f]);return e},getElementsMetrics:function(a){for(var b=[],c=0;c<a.length;c++)b.push(this.getModelMetrics(a[c]));return b.push(this.getBannerMetrics()),b},alignSelected:function(a,b){var c=_.clone(a),d={x:c.x,y:c.y,width:c.width,height:c.height,angle:c.rotation?c.rotation:0,center:new Point(c.x+c.width/2,c.y+c.height/2)},e={},f=!1,g=!1;0!==d.angle?(e=this.getRotatedRectangle(_.clone(d)),e.x=e.xy-e.width,e.y=e.yx-e.height,e.deltaX=d.x-e.x,e.deltaY=d.y-e.y):(e=d,e.deltaX=0,e.deltaY=0);for(var h=0;h<b.length;h++){var i=b[h],j=c.x,k=c.y;if(e.x>=i.x-this.snapDistance&&e.x<=i.x+this.snapDistance&&(j=i.x+e.deltaX,editor.stage.showGuide(j-e.deltaX,"vertical"),g=!0),e.x+e.width>=i.xy-this.snapDistance&&e.x+e.width<=i.xy+this.snapDistance&&(j=i.x+(i.width-e.width)+e.deltaX,editor.stage.showGuide(j+e.width-e.deltaX-1,"vertical"),g=!0),e.x+e.width/2>=i.center.x-this.snapDistance&&e.x+e.width/2<=i.center.x+this.snapDistance&&(j=Math.round(i.x+e.deltaX+(i.width-e.width)/2),editor.stage.showGuide(j-e.deltaX+Math.round(e.width/2),"vertical"),g=!0),e.y>=i.y-this.snapDistance&&e.y<=i.y+this.snapDistance&&(k=i.y+e.deltaY,editor.stage.showGuide(k-e.deltaY,"horizontal"),f=!0),e.y+e.height>=i.yx-this.snapDistance&&e.y+e.height<=i.yx+this.snapDistance&&(k=i.y+(i.height-e.height)+e.deltaY,editor.stage.showGuide(k+e.height-e.deltaY-1,"horizontal"),f=!0),e.y+e.height/2>=i.center.y-this.snapDistance&&e.y+e.height/2<=i.center.y+this.snapDistance&&(k=Math.round(i.y+e.deltaY+(i.height-e.height)/2),editor.stage.showGuide(k-e.deltaY+Math.round(e.height/2),"horizontal"),f=!0),c.x=j,c.y=k,g||editor.stage.hideGuides("vertical"),f||editor.stage.hideGuides("horizontal"),g&&f)return c}return c},alignScaleSelected:function(a,b){if(a.rotation&&0!==a.rotation)return a;for(var c=!1,d=!1,e=_.clone(a),f={x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height),xy:Math.round(e.x)+Math.round(e.width),angle:e.rotation?e.rotation:0,center:new Point(e.x+e.width/2,e.y+e.height/2)},g=0;g<b.length;g++){var h=b[g],i=e.x,j=e.width,k=e.height,l=e.y;if(a.changed&&a.changed.right&&f.x+f.width>=h.xy-this.snapDistance&&f.x+f.width<=h.xy+this.snapDistance&&(j=h.xy-f.x,e.scalex=1,editor.stage.showGuide(h.xy-1,"vertical"),d=!0),a.changed&&a.changed.left&&f.x>=h.x-this.snapDistance&&f.x<=h.x+this.snapDistance&&a.refPoint&&Math.abs(a.refPoint.x-f.width-h.x)<=this.snapDistance&&(j=a.refPoint.x-h.x,d=!0,e.scalex=1,i=h.x,editor.stage.showGuide(h.x,"vertical")),a.changed&&a.changed.top&&f.y>=h.y-this.snapDistance&&f.y<=h.y+this.snapDistance&&a.refPoint&&Math.abs(a.refPoint.y-f.height-h.y)<=this.snapDistance&&(k=a.refPoint.y-h.y,c=!0,e.scaley=1,l=h.y,editor.stage.showGuide(h.y,"horizontal")),a.changed&&a.changed.bottom&&f.y+f.height>=h.yx-this.snapDistance&&f.y+f.height<=h.yx+this.snapDistance&&(k=h.yx-f.y,e.scaley=1,editor.stage.showGuide(h.yx-1,"horizontal"),c=!0),e.width=j,e.height=k,e.x=i,e.y=l,e.vAlign=d,e.hAlign=c,d||editor.stage.hideGuides("vertical"),c||editor.stage.hideGuides("horizontal"),d&&c)return e}return e}};_.mixin({deepClone:function(a){return $.extend(!0,_.isArray(a)?[]:{},a)}}),function(){Backbone.Model.prototype.toJSON=function(){if(this._isSerializing)return this.id||this.cid;this._isSerializing=!0;var a=_.clone(this.attributes);return _.each(a,function(b,c){b&&_.isFunction(b.toJSON)&&(a[c]=b.toJSON())}),this._isSerializing=!1,a}}.call(this),String.prototype.ucFirst=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var utils={shortMStr:function(a,b){b="undefined"==typeof b?34:b;var c=a.replace(/\s+/g," "),d="...";if(c.length<=b)return c;var e=d.length,f=b-e,g=Math.ceil(f/2),h=Math.floor(f/2);return c.substr(0,g)+d+c.substr(c.length-h)},formatMysqlDate:function(a){if(a){var b=/^([0-9]{2,4})-([0-1][0-9])-([0-3][0-9]) (?:([0-2][0-9]):([0-5][0-9]):([0-5][0-9]))?$/,c=a.replace(b,"$1 $2 $3 $4 $5 $6").split(" ");return c[1]+"/"+c[2]+"/"+c[0]+" "+c[3]+":"+c[4]}},convertMysqlDateToJs:function(a){if(a){var b=/^([0-9]{2,4})-([0-1][0-9])-([0-3][0-9]) (?:([0-2][0-9]):([0-5][0-9]):([0-5][0-9]))?$/,c=a.replace(b,"$1 $2 $3 $4 $5 $6").split(" ");return new Date(c[0],c[1]-1,c[2],c[3],c[4],c[5])}},isTouchDevice:function(){try{return document.createEvent("TouchEvent"),!0}catch(a){return!1}}},editorUtils={extractRGB:function(a){a=a.toLowerCase();var b=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],c={r:"",g:"",b:""};return c.r=parseInt((16*b.indexOf(a[1])+b.indexOf(a[2])).toString()),c.g=parseInt((16*b.indexOf(a[3])+b.indexOf(a[4])).toString()),c.b=parseInt((16*b.indexOf(a[5])+b.indexOf(a[6])).toString()),c},generateLighterColor:function(a,b){void 0==b&&(b=26);var c=editorUtils.extractRGB(a);return c.r=Math.min(255,parseInt(c.r)+b),c.g=Math.min(255,parseInt(c.g)+b),c.b=Math.min(255,parseInt(c.b)+b),"#"+editorUtils.fixed2(c.r.toString(16))+editorUtils.fixed2(c.g.toString(16))+editorUtils.fixed2(c.b.toString(16))},fixed2:function(a){return a.length<2?"0"+a:a},globalToLocal:function(a,b,c){var d=a.offset();return{x:Math.floor(b-d.left),y:Math.floor(c-d.top)}},hexToRgb:function(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16)}}};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),String.prototype.fulltrim=function(){return this.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var decodeHTML=function(a){return $("<div />").html(a).text()};!function(){jQuery.fn.getBounds=function(){var a={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY,width:Number.NaN,height:Number.NaN};return this.each(function(b,c){var d=$(c),e=d.offset();e.right=e.left+$(d).width(),e.bottom=e.top+$(d).height(),e.left<a.left&&(a.left=e.left),e.top<a.top&&(a.top=e.top),e.right>a.right&&(a.right=e.right),e.bottom>a.bottom&&(a.bottom=e.bottom)}),a.width=a.right-a.left,a.height=a.bottom-a.top,a}}(),$(document).on("click.collapse.data-api","[data-toggle=collapse-show]",function(a){var b,c=$(this),d=c.attr("data-parent"),e=c.attr("data-target")||a.preventDefault()||(b=c.attr("href"))&&b.replace(/.*(?=#[^\s]+$)/,""),f=$(e).data("collapse")?$(this).data("cmethod")||"show":c.data();$(d).removeClass("hide"),$(e).hasClass("in")&&"show"==$(this).data("cmethod")||(c[$(e).hasClass("in")?"addClass":"removeClass"]("collapsed"),$(e).collapse(f))}),jQuery.extendAndMerge=jQuery.fn.extendAndMerge=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[1]||{},h=2),"object"==typeof g||jQuery.isFunction(g)||(g={}),i===h&&(g=this,--h);h<i;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(jQuery.isPlainObject(c)||(b=jQuery.isArray(c)))?(f=b?a&&jQuery.isArray(a)?a:[]:a&&jQuery.isPlainObject(a)?a:{},1==b?g[d]=f.concat(c):g[d]=jQuery.extendAndMerge(j,f,c),b=!1):void 0!==c&&(g[d]=c));return g};var effGenerator={styles:{},nextIndex:0,_generatedEffects:{},generate:function(a,b,c){var d="",e="ease";switch(b.ease){default:e+="Out";break;case"easeIn":e+="In";break;case"easeInOut":e+="InOut"}if(e+=b.tween,!this[e])return!1;for(var f=0;f<=100;f+=4)d+=this.getKeyframe(b,f,this[e](0,f,0,100,100),c),d+="\n";var g,h=document.createElement("style");if(h.type="text/css","alpha"===b.type){if(g=h.id="eff_bs_alpha_"+e+"_"+(c?"show":"hide"),this._generatedEffects[g])return g;this._generatedEffects[g]=!0}else this.nextIndex++,g=h.id="eff_bs_"+this.nextIndex;var i;i="@-webkit-keyframes "+g+"{\n"+d+"\n}",i+="\n@keyframes "+g+"{\n"+d+"\n}",this.styles[g]=h,h.styleSheet?h.styleSheet.cssText=i:h.innerHTML=i;var j=document.getElementsByTagName("head")[0];return j.appendChild(h),g},clearEffect:function(a){if(0!==a.indexOf("eff_bs_alpha")){var b=document.getElementById(a);b.parentNode.removeChild(b),b=null}},getKeyframe:function(a,b,c,d){var e=b+"% {";switch(a.type){case"scale":var f=1,g=1,h=d?c/100:1-c/100;switch(a.direction){case"l2r":case"r2l":f=h;break;case"t2b":case"b2t":g=h;break;case"center":f=h,g=h}e+="transform: scaleX("+f+") scaleY("+g+")";break;case"slide":var i=0,j=0,h=(100-c)/100,k=parseInt(a.slideOffset);switch(a.direction){case"custom":i=parseInt(a.slidePosX*h),j=parseInt(a.slidePosY*h),d||(i=parseInt(a.slidePosX)-i,j=parseInt(a.slidePosY)-j);break;case"l2r":i=-(k*h),d||(i+=k);break;case"r2l":i=k*h,d||(i-=k);break;case"t2b":j=-(k*h),d||(j+=k);break;case"b2t":j=k*h,d||(j-=k)}var l=parseInt(a.alphaOffset)/100,m=l+(1-l)*(c/100);d||(m=1-m+l),e+="transform: translate("+i+"px, "+j+"px);\n",e+="opacity: "+m;break;case"blur":case"blur-words":var n=a.blurAmount*(c/100);d&&(n=a.blurAmount-n);var o="blur("+n+"px)";e+="filter: "+o+"; \n",e+="-webkit-filter: "+o+"; \n";var p;p=d?3.33*b/100:3.33*(100-b)/100,p>1&&(p=1),e+="opacity: "+p;break;case"alpha":case"alpha-words":var p=c/100;d||(p=1-p),e+="opacity: "+p}return e+="}"},easeInElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(1==(b/=e))return c+d;if(g||(g=.3*e),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*(2*Math.PI)/g))+c},easeOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(1==(b/=e))return c+d;if(g||(g=.3*e),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin((b*e-f)*(2*Math.PI)/g)+d+c},easeInOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(2==(b/=e/2))return c+d;if(g||(g=e*(.3*1.5)),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return b<1?-.5*(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*(2*Math.PI)/g))+c:h*Math.pow(2,-10*(b-=1))*Math.sin((b*e-f)*(2*Math.PI)/g)*.5+d+c},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*(7.5625*b*b)+c:b<2/2.75?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:b<2.5/2.75?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInBounce:function(a,b,c,d,e){return d-this.easeOutBounce(a,e-b,0,d,e)+c},easeInOutBounce:function(a,b,c,d,e){return b<e/2?.5*this.easeInBounce(a,2*b,0,d,e)+c:.5*this.easeOutBounce(a,2*b-e,0,d,e)+.5*d+c},easeInStrong:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutStrong:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutStrong:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c}},eff={ceaser:{linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",easeInCubic:"cubic-bezier(.55,.055,.675,.19)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInStrong:"cubic-bezier(.97,.09,.79,.21)",easeOutStrong:"cubic-bezier(.21,.79,.09,.97)",easeInOutStrong:"cubic-bezier(.78,.03,.24,.99)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"},timeouts:{},animationEndCallbacks:{},_blur:function(a,b,c,d){var e=this,f="in"===d,g=function(b){a.style.filter=b,a.style["-webkit-filter"]=b},h=Math.round(3.3*b.duration)/10,i=f?0:b.duration-h;this.setTransition(a,""),this.setAnimation(a,""),a.style.opacity=f?0:1,g(f?"blur("+b.blurAmount+"px)":"blur(0px)"),this.timeouts[c.delayId]=setTimeout(function(){if(a.offsetHeight,"Elastic"===b.tween||"Bounce"===b.tween)a.style.opacity=f?1:0,e.setKeyframeEffect(a,b,c,f,b.effName||null);else{var d=e.getTimingFunction(b),j="filter "+b.duration+"s "+d+" 0s, -webkit-filter "+b.duration+"s "+d+" 0s, opacity "+h+"s linear "+i+"s";e.setTransition(a,j),a.style.opacity=f?1:0,g(f?"blur(0px)":"blur("+b.blurAmount+"px)")}e.timeouts[c.delayId]=setTimeout(function(){g(""),e.onAnimationEnd(a,c)},1e3*b.duration)},1e3*Number(b.delay))},blurIn:function(a,b,c){this._blur(a,b,c,"in")},blurOut:function(a,b,c){this._blur(a,b,c,"out")},_alpha:function(a,b,c,d){var e=this,f="in"===d;this.setTransition(a,""),this.setAnimation(a,""),a.style.opacity=f?0:1,this.timeouts[c.delayId]=setTimeout(function(){if(a.offsetHeight,"Elastic"===b.tween||"Bounce"===b.tween)a.style.opacity=f?1:0,e.setKeyframeEffect(a,b,c,f);else{var d=e.getTimingFunction(b),g="opacity "+Number(b.duration)+"s "+d;e.setTransition(a,g),a.style.opacity=f?1:0}e.timeouts[c.delayId]=setTimeout(function(){b.isWordAnimation||(a.style.opacity=1),e.onAnimationEnd(a,c)},1e3*b.duration)},1e3*Number(b.delay))},alphaIn:function(a,b,c){this._alpha(a,b,c,"in")},alphaOut:function(a,b,c){this._alpha(a,b,c,"out")},setTransition:function(a,b){a.style.transition=b,a.style["-webkit-transition"]=b},setAnimation:function(a,b){a.style.animation=b,a.style["-webkit-animation"]=b},_scale:function(a,b,c,d){function e(a){return a&&f||!a&&!f?"scaleX("+g+") scaleY("+h+")":"scaleX(1) scaleY(1)"}var f="in"===d,g=1,h=1,i="top left";switch(b.direction){case"l2r":g=0,i=f?"left center":"right center";break;case"r2l":g=0,i=f?"right center":"left center";break;case"t2b":h=0,i=f?"center top":"center bottom";break;case"b2t":h=0,i=f?"center bottom":"center top";break;case"center":g=0,h=0,i="center center"}this.setTransition(a,""),this.setAnimation(a,""),a.style.transformOrigin=i,a.style.transform=e(!0);var j=this;this.timeouts[c.delayId]=setTimeout(function(){if(a.offsetHeight,"Elastic"===b.tween||"Bounce"===b.tween)a.style.transform="",j.setKeyframeEffect(a,b,c,f);else{var d=j.getTimingFunction(b),g="transform "+Number(b.duration)+"s "+d;j.setTransition(a,g),a.style.transform=e(!1)}j.timeouts[c.delayId]=setTimeout(function(){j.onAnimationEnd(a,c)},1e3*b.duration)},1e3*Number(b.delay))},scaleIn:function(a,b,c){this._scale(a,b,c,"in")},scaleOut:function(a,b,c){this._scale(a,b,c,"out")},breakWords:function(a){for(var b=a.innerText,c="<span>",d=!1,e=!1,f=0;f<b.length;f++)" "===b[f]||"\n"===b[f]?(e&&(c+="</span>"),d=!0,e=!1):(d&&(c+="<span>"),d=!1,e=!0),c+=b[f];c+="</span>",a.innerHTML=c},effectWords:function(a,b,c,d,e){clearTimeout(eff.timeouts[c.delayId]);var f=this;e&&(a.style.opacity=0),eff.timeouts[c.delayId]=setTimeout(function(){b.onAnimationStart&&b.onAnimationStart(),e&&(a.style.opacity=1);var g=a.querySelector("[data-textcont=true]"),h=g.innerHTML;f.breakWords(g);var i=g.getElementsByTagName("span"),j=(b.duration-b.wordsDuration)/(i.length-1||1),k=b.wordsAppearOrder||"random",l=0,m=0;i=[].slice.call(i);var n;for("Elastic"!==b.tween&&"Bounce"!==b.tween||(n=effGenerator.generate(a,b,e));i.length;){var o,p,q;"r2l"===k?o=i.pop():"l2r"===k?o=i.shift():(m=Math.floor(Math.random()*i.length),o=i.splice(m,1)[0]),p={tween:b.tween,type:d,ease:b.ease,duration:b.wordsDuration,blurAmount:b.blurAmount,isWordAnimation:!0,effName:n,delay:l*j},q={delayId:c.delayId+"_"+l,isWordAnimation:!0},clearTimeout(f.timeouts[q.delayId]);var r=d+(e?"In":"Out");f[r](o,p,q),l++}var s=l,t=Math.max(Number(b.duration),Number(b.wordsDuration));f.animationEndCallbacks[c.delayId]=function(){g.innerHTML=h;for(var a=0;a<s;a++)clearTimeout(f.timeouts[c.delayId+"_"+a])},f.timeouts[c.delayId]=setTimeout(function(){f.onAnimationEnd(a,c)},1e3*t)},1e3*Number(b.delay))},setKeyframeEffect:function(a,b,c,d,e){e||(e=effGenerator.generate(a,b,d),c.effName=e);var f=Number(b.duration)+"s linear 0s "+e;this.setAnimation(a,f)},alphaWordsIn:function(a,b,c){this.effectWords(a,b,c,"alpha",!0)},alphaWordsOut:function(a,b,c){this.effectWords(a,b,c,"alpha",!1)},blurWordsIn:function(a,b,c){this.effectWords(a,b,c,"blur",!0)},blurWordsOut:function(a,b,c){this.effectWords(a,b,c,"blur",!1)},_slide:function(a,b,c,d){function e(a){return a&&f||!a&&!f?"translate("+i+"px, "+j+"px)":"translate(0,0)"}var f="in"===d,g=this,h=parseInt(b.alphaOffset)/100,i=0,j=0;switch(b.direction){case"custom":i=parseInt(b.slidePosX),j=parseInt(b.slidePosY);break;case"l2r":i=-parseInt(b.slideOffset);break;case"r2l":i=parseInt(b.slideOffset);break;case"t2b":j=-parseInt(b.slideOffset);break;case"b2t":j=parseInt(b.slideOffset)}f||"custom"==b.direction||(i*=-1,j*=-1),this.setTransition(a,""),this.setAnimation(a,""),a.style.opacity=f?h:1,a.style.transform=e(!0),this.timeouts[c.delayId]=setTimeout(function(){if(a.offsetHeight,"Elastic"===b.tween||"Bounce"===b.tween)a.style.transform="",g.setKeyframeEffect(a,b,c,f);else{var d=g.getTimingFunction(b),i="opacity "+Number(b.duration)+"s "+d+", transform "+Number(b.duration)+"s "+d;g.setTransition(a,i),a.style.transform=e(!1),a.style.opacity=f?1:h}g.timeouts[c.delayId]=setTimeout(function(){b.isWordAnimation||(a.style.opacity=1),g.onAnimationEnd(a,c)},1e3*b.duration)},1e3*Number(b.delay))},slideIn:function(a,b,c){this._slide(a,b,c,"in")},slideOut:function(a,b,c){this._slide(a,b,c,"out")},none:function(a,b){},getTimingFunction:function(a){var b="ease";switch(a.ease){default:b+="Out";break;case"easeIn":b+="In";break;case"easeInOut":b+="InOut"}return b+=a.tween,"Linear"===a.tween&&(b="linear"),this.ceaser[b]},_els:[],getElementIndex:function(a){var b,c;for(b=0;c=this._els[b];b++)if(c===a)return b+1;return this._els.push(a),this._els.length},onAnimationEnd:function(a,b){this.setTransition(a,""),this.setAnimation(a,""),b.effName&&effGenerator.clearEffect(b.effName),b.onAnimationEnd&&b.onAnimationEnd(),this.animationEndCallbacks[b.delayId]&&(this.animationEndCallbacks[b.delayId].call(),this.animationEndCallbacks[b.delayId]=null),clearTimeout(this.timeouts[b.delayId])},onAnimationStart:function(a,b,c){},animate:function(a,b,c,d){if("none"==b.type)return void(d&&d());var e=this,f="",g=b.type;switch(g){case"alpha-words":g="alphaWords";break;case"blur-words":g="blurWords"}c&&(f="buildIn"==c?"In":"Out"),g+=f;var h=this.getElementIndex(a),i={delayId:"delay_"+h,onAnimationEnd:d};return clearTimeout(this.timeouts[i.delayId]),e.onAnimationStart(a,b,i),e[g](a,b,i),{onAnimationEnd:function(){e.onAnimationEnd(a,i)}.bind(this)}}};!function(){var a=[];window.feedback=function(b){this.parentContainer=b,this.feedbackH3=this.parentContainer.find(".feedback-header h3"),this.feedbackClose=this.parentContainer.find("button.close"),this.feedbackBody=this.parentContainer.find(".feedback-body"),this.feedbackTextArea=this.feedbackBody.find("textarea"),this.feedbackSent=this.feedbackBody.find(".feedback-sent"),this.feedbackButton=this.parentContainer.find(".feedback-footer button"),this.sentTimeout=!1,this.effectsTiming=250,this.checkBoxStatus(),a.push(this),this.getAllElems=function(){return a},this.close(),this.send(),this.addClassLastInspectorGroup()}}(),feedback.prototype.close=function(){var a=this;this.feedbackClose.on("click",function(){a.closeAll()})},feedback.prototype.realClose=function(){var a=this;this.feedbackClose.hide(),this.feedbackTextArea.is(":visible")&&this.setStatus("closed"),this.feedbackButton.addClass("btn-fbk-close"),this.feedbackBody.slideUp(a.effectsTiming,function(){a.closed()})},feedback.prototype.closed=function(){var a=this;this.feedbackTextArea.prop("disabled",!0),this.feedbackH3.show(),this.feedbackButton.show(),this.feedbackSent.hide(),setTimeout(function(){a.parentContainer.parents(".scrollwrap").addClass("feedback-closed")},50)},feedback.prototype.closeAll=function(){for(var a=this.getAllElems(),b=0;b<a.length;b++)a[b].realClose()},feedback.prototype.openAll=function(){for(var a=this.getAllElems(),b=0;b<a.length;b++)a[b].open()},feedback.prototype.checkBoxStatus=function(){var a=this;return"closed"==this.getStatus()?(this.feedbackClose.hide(),this.feedbackBody.hide(),this.feedbackButton.addClass("btn-fbk-close"),void this.closed()):void setTimeout(function(){a.parentContainer.parents(".scrollwrap").removeClass("feedback-closed")},50)},feedback.prototype.send=function(){var a=this;this.feedbackButton.on("click",function(){var b=$(this);b.hasClass("btn-fbk-close")?a.openAll():a.sendMessage()})},feedback.prototype.open=function(){this.stayScrolledToBottom($("#inspector .scrollcontent:visible").get(0)),this.parentContainer.parents(".scrollwrap").removeClass("feedback-closed"),this.sentTimeout&&clearTimeout(this.sentTimeout),this.feedbackTextArea.prop("disabled",!1),this.feedbackTextArea.css("display",""),this.feedbackClose.show(),this.feedbackButton.removeClass("btn-fbk-close"),this.feedbackBody.slideDown(this.effectsTiming),this.setStatus("opened")},feedback.prototype.sendMessage=function(){var a=this,b=$.trim(a.feedbackTextArea.val());if(b){a.feedbackTextArea.attr("disabled",!0);var c=new LoaderHover(a.feedbackTextArea);$.ajax({data:{page:"html5editor/feedback",message:b,hash:editor.config.creativeHash},type:"POST",complete:function(){c.remove(),a.feedbackH3.hide(),a.feedbackTextArea.hide().val(""),a.feedbackButton.hide().addClass("btn-fbk-close"),a.feedbackSent.fadeIn(a.effectsTiming,function(){var b=$(this);a.sentTimeout=setTimeout(function(){a.feedbackClose.hide(),b.slideUp(a.effectsTiming,function(){a.closeAll(),a.setStatus("opened")})},5e3)})},success:function(a){20==a.code||(403==a.code?($("#editor").blockElement(),BSAlert(a.res)):BSAlert(a.res))},error:function(){BSAlert("Saving error.")}})}},feedback.prototype.setStatus=function(a){a||(a="opened");var b=window.klobic_userid;return!(!b||!window.localStorage)&&void localStorage.setItem("feedback"+b,a)},feedback.prototype.getStatus=function(){var a=window.klobic_userid;if(!a||!window.localStorage)return"opened";var b=localStorage.getItem("feedback"+a);return null==b?"opened":b},feedback.prototype.stayScrolledToBottom=function(a){if(!($("#inspector .scrollcontent:visible").outerHeight()>$("#inspector .scrollcontent:visible .scrollwrap").outerHeight()))var b=5,c=0,d=this,e=setInterval(function(){c!=d.effectsTiming/b?(a.scrollTop=a.scrollHeight,c++):clearInterval(e)},b)},feedback.prototype.addClassLastInspectorGroup=function(){var a=this;setTimeout(function(){$(a.parentContainer).prev().addClass("last-inspector-group")},5)},jQuery.fn.blockElement=function(){return $(this).append('<div class="blockedElement" style="position:absolute; left:0px; top:0px; right:0px; bottom:0px; background-color:white; opacity:0.5; z-index:10000"></div>')},jQuery.fn.unblockElement=function(){return $(this).find(".blockedElement").remove()},$.fn.descendantOf=function(a){a=$(a)[0];for(var b=this,c=document.body;b&&b!=a&&b!=c;)b=$(b).parent()[0];return"undefined"!=typeof b&&"null"!=typeof b&&(b==a||b!=c&&void 0)},function(a){a.fn.cssMap=function(b){var c=this;a.each(b,function(a,b){if(b instanceof Array)for(var d=0,e=b.length;d<e;d++)c.css(a,b[d]);else c.css(a,b)})}}(jQuery),function(a){a.fn.refresh=function(){var b=a(this.selector);return this.splice(0,this.length),this.push.apply(this,b),this}}(jQuery),function(a){a.fn.dragsort=function(b){if("destroy"==b)return void a(this).children().trigger("dragsort-uninit");var c=a.extend({},a.fn.dragsort.defaults,b),d=[],e=null,f=null;return this.each(function(b,g){a(g).is("table")&&1==a(g).children().size()&&a(g).children().is("tbody")&&(g=a(g).children().get(0));var h={draggedItem:null,placeHolderItem:null,pos:null,offset:null,offsetLimit:null,scroll:null,container:g,init:function(){var d=0==a(this.container).children().size()?"li":a(this.container).children(":first").get(0).tagName.toLowerCase();""==c.itemSelector&&(c.itemSelector=d),""==c.dragSelector&&(c.dragSelector=d),""==c.placeHolderTemplate&&(c.placeHolderTemplate="<"+d+">&nbsp;</"+d+">"),a(this.container).children(c.itemSelector).attr("data-listidx",b).off("mousedown").mousedown(this.grabItem).bind("dragsort-uninit",this.uninit),this.styleDragHandlers(!0)},uninit:function(){var b=d[a(this).attr("data-listidx")];a(b.container).unbind("mousedown",b.grabItem).unbind("dragsort-uninit"),b.styleDragHandlers(!1)},getItems:function(){return a(this.container).children(c.itemSelector)},styleDragHandlers:function(b){this.getItems().map(function(){return a(this).is(c.dragSelector)?this:a(this).find(c.dragSelector).get()}).css("cursor",b?"pointer":"")},grabItem:function(b){var e=b.currentTarget;if(!(1!=b.which||a(e).is(c.dragSelectorExclude)||a(e).closest(c.dragSelectorExclude).size()>0||0==a(e).closest(c.itemSelector).size())){for(;!a(e).is(c.dragSelector);){if(e==this)return;e=e.parentNode}a(e).attr("data-cursor",a(e).css("cursor")),a(e).css("cursor","move");var f=d[a(this).attr("data-listidx")],g=this,h=function(){f.dragStart.call(g,b),a(f.container).unbind("mousemove",h)};eaUtils.stopEvent(b),this.moveTimeout=setTimeout(function(){clearTimeout(g.moveTimeout),a(f.container).mousemove(h)},250),a(f.container).mouseup(function(){a(f.container).unbind("mousemove",h),a(e).css("cursor",a(e).attr("data-cursor")),clearTimeout(g.moveTimeout)})}},dragStart:function(b){null!=e&&null!=e.draggedItem&&e.dropItem(),e=d[a(this).attr("data-listidx")],e.draggedItem=a(b.currentTarget).closest(c.itemSelector),e.draggedItem.attr("data-origpos",a(this).attr("data-listidx")+"-"+e.getItems().index(e.draggedItem));var f=parseInt(e.draggedItem.css("marginTop")),g=parseInt(e.draggedItem.css("marginLeft"));if(e.offset=e.draggedItem.offset(),e.offset.top=b.pageY-e.offset.top+(isNaN(f)?0:f)-1,e.offset.left=b.pageX-e.offset.left+(isNaN(g)?0:g)-1,!c.dragBetween){0==a(e.container).outerHeight()?Math.max(1,Math.round(.5+e.getItems().size()*e.draggedItem.outerWidth()/a(e.container).outerWidth()))*e.draggedItem.outerHeight():a(e.container).outerHeight();e.offsetLimit=a(e.container).offset(),e.offsetLimit.right=e.offsetLimit.left+a(e.container).outerWidth()-e.draggedItem.outerWidth(),e.offsetLimit.bottom=e.offsetLimit.top+a(e.container).closest(".scrollcontent").scrollTop()+a(e.container).outerHeight()-e.draggedItem.outerHeight()}var h=e.draggedItem.height(),i=e.draggedItem.width();if("tr"==c.itemSelector?(e.draggedItem.children().each(function(){a(this).width(a(this).width())}),e.placeHolderItem=e.draggedItem.clone().attr("data-placeholder",!0),e.draggedItem.after(e.placeHolderItem),e.placeHolderItem.children().each(function(){a(this).css({borderWidth:0,width:a(this).width()+1,height:a(this).height()+1}).html("&nbsp;")})):(e.draggedItem.after(c.placeHolderTemplate),e.placeHolderItem=e.draggedItem.next().css({height:h,width:i}).attr("data-placeholder",!0)),"td"==c.itemSelector){var j=e.draggedItem.closest("table").get(0);a("<table id='"+j.id+"' style='border-width: 0px;' class='dragSortItem "+j.className+"'><tr></tr></table>").appendTo("body").children().append(e.draggedItem)}var k=e.draggedItem.attr("style");e.draggedItem.attr("data-origstyle",k?k:""),e.draggedItem.css({position:"absolute",opacity:.8,"z-index":999,height:h,width:i}),e.scroll={moveX:0,moveY:0,maxX:a(document).width()-a(window).width(),maxY:a(document).height()-a(window).height()},e.scroll.scrollY=window.setInterval(function(){if(c.scrollContainer!=window)return void a(c.scrollContainer).scrollTop(a(c.scrollContainer).scrollTop()+e.scroll.moveY);var b=a(c.scrollContainer).scrollTop();(e.scroll.moveY>0&&b<e.scroll.maxY||e.scroll.moveY<0&&b>0)&&(a(c.scrollContainer).scrollTop(b+e.scroll.moveY),e.draggedItem.css("top",e.draggedItem.offset().top+e.scroll.moveY+1))},10),e.scroll.scrollX=window.setInterval(function(){if(c.scrollContainer!=window)return void a(c.scrollContainer).scrollLeft(a(c.scrollContainer).scrollLeft()+e.scroll.moveX);var b=a(c.scrollContainer).scrollLeft();(e.scroll.moveX>0&&b<e.scroll.maxX||e.scroll.moveX<0&&b>0)&&(a(c.scrollContainer).scrollLeft(b+e.scroll.moveX),e.draggedItem.css("left",e.draggedItem.offset().left+e.scroll.moveX+1))},10),a(d).each(function(a,b){b.createDropTargets(),b.buildPositionTable()}),e.setPos(b.pageX,b.pageY),a(document).bind("mousemove",e.swapItems),a(document).bind("mouseup",e.dropItem),c.scrollContainer!=window&&a(window).bind("DOMMouseScroll mousewheel",e.wheel)},setPos:function(b,d){var f=d-this.offset.top,g=b-this.offset.left;if(c.dragBetween||(f=Math.min(this.offsetLimit.bottom,Math.max(f,this.offsetLimit.top)),g=Math.min(this.offsetLimit.right,Math.max(g,this.offsetLimit.left))),this.draggedItem.parents().each(function(){if("static"!=a(this).css("position")&&(!a.browser.mozilla||"table"!=a(this).css("display"))){var b=a(this).offset();return f-=b.top,g-=b.left,!1}}),this.draggedItem.parents().each(function(){if(this.scrollTop)return void(f-=this.scrollTop)}),c.scrollContainer==window)d-=a(window).scrollTop(),b-=a(window).scrollLeft(),d=Math.max(0,d-a(window).height()+5)+Math.min(0,d-5),b=Math.max(0,b-a(window).width()+5)+Math.min(0,b-5);else{var h=a(c.scrollContainer),i=h.offset();d=Math.max(0,d-h.height()-i.top)+Math.min(0,d-i.top),b=Math.max(0,b-h.width()-i.left)+Math.min(0,b-i.left)}e.scroll.moveX=0==b?0:b*c.scrollSpeed/Math.abs(b),e.scroll.moveY=0==d?0:d*c.scrollSpeed/Math.abs(d),this.draggedItem.css({top:f,left:g})},wheel:function(b){if((a.browser.safari||a.browser.mozilla)&&e&&c.scrollContainer!=window){var d=a(c.scrollContainer),f=d.offset();if(b.pageX>f.left&&b.pageX<f.left+d.width()&&b.pageY>f.top&&b.pageY<f.top+d.height()){var g=b.detail?5*b.detail:b.wheelDelta/-2;d.scrollTop(d.scrollTop()+g),b.preventDefault()}}},buildPositionTable:function(){var b=[];this.getItems().not([e.draggedItem[0],e.placeHolderItem[0]]).each(function(c){var d=a(this).offset();d.right=d.left+a(this).outerWidth(),d.bottom=d.top+a(this).outerHeight(),d.elm=this,b[c]=d}),this.pos=b},dropItem:function(){if(null!=e.draggedItem){var b=e.draggedItem.attr("data-origstyle");return e.draggedItem.attr("style",b),""==b&&e.draggedItem.removeAttr("style"),e.draggedItem.removeAttr("data-origstyle"),e.styleDragHandlers(!0),e.placeHolderItem.before(e.draggedItem),e.placeHolderItem.remove(),a("[data-droptarget], .dragSortItem").remove(),window.clearInterval(e.scroll.scrollY),
window.clearInterval(e.scroll.scrollX),e.draggedItem.attr("data-origpos")!=a(d).index(e)+"-"+e.getItems().index(e.draggedItem)&&c.dragEnd.apply(e.draggedItem),e.draggedItem.removeAttr("data-origpos"),e.draggedItem=null,a(document).unbind("mousemove",e.swapItems),a(document).unbind("mouseup",e.dropItem),c.scrollContainer!=window&&a(window).unbind("DOMMouseScroll mousewheel",e.wheel),!1}},swapItems:function(b){if(null==e.draggedItem)return!1;var g=a(e.container).closest(".scrollcontent").scrollTop(),h=a(e.container).closest(".scrollcontent").scrollLeft(),i=b.pageX+h,j=b.pageY+g;e.setPos(i,j);for(var k=e.findPos(b.pageX,b.pageY),l=e,m=0;k==-1&&c.dragBetween&&m<d.length;m++)k=d[m].findPos(b.pageX,b.pageY),l=d[m];if(k==-1)return!1;var n=function(){return a(l.container).children().not(l.draggedItem)},o=n().not(c.itemSelector).each(function(a){this.idx=n().index(this)});return null==f||f.top>e.draggedItem.offset().top||f.left>e.draggedItem.offset().left?a(l.pos[k].elm).before(e.placeHolderItem):a(l.pos[k].elm).after(e.placeHolderItem),o.each(function(){var b=n().eq(this.idx).get(0);this!=b&&n().index(this)<this.idx?a(this).insertAfter(b):this!=b&&a(this).insertBefore(b)}),a(d).each(function(a,b){b.createDropTargets(),b.buildPositionTable()}),f=e.draggedItem.offset(),!1},findPos:function(a,b){for(var c=0;c<this.pos.length;c++)if(this.pos[c].left<a&&this.pos[c].right>a&&this.pos[c].top<b&&this.pos[c].bottom>b)return c;return-1},createDropTargets:function(){c.dragBetween&&a(d).each(function(){var b=a(this.container).find("[data-placeholder]"),d=a(this.container).find("[data-droptarget]");b.size()>0&&d.size()>0?d.remove():0==b.size()&&0==d.size()&&("td"==c.itemSelector?a(c.placeHolderTemplate).attr("data-droptarget",!0).appendTo(this.container):a(this.container).append(e.placeHolderItem.removeAttr("data-placeholder").clone().attr("data-droptarget",!0)),e.placeHolderItem.attr("data-placeholder",!0))})}};h.init(),d.push(h)}),this},a.fn.dragsort.defaults={itemSelector:"",dragSelector:"",dragSelectorExclude:"input, textarea",dragEnd:function(){},dragBetween:!1,placeHolderTemplate:"",scrollContainer:window,scrollSpeed:5}}(jQuery),function(a){a.fn.dragsortdrop=function(b){if("destroy"==b)return void a(this).children().trigger("dragsort-uninit");var c=a.extend({},a.fn.dragsort.defaults,b),d=[],e=null,f=null,g=function(b,g){a(g).is("table")&&1==a(g).children().size()&&a(g).children().is("tbody")&&(g=a(g).children().get(0));var h={draggedItem:null,placeHolderItem:null,pos:null,offset:null,offsetLimit:null,scroll:null,container:g,init:function(){var d=0==a(this.container).children().size()?"li":a(this.container).children(":first").get(0).tagName.toLowerCase();""==c.itemSelector&&(c.itemSelector=d),""==c.dragSelector&&(c.dragSelector=d),""==c.placeHolderTemplate&&(c.placeHolderTemplate="<"+d+">&nbsp;</"+d+">"),a(this.container).children(c.itemSelector).attr("data-listidx",b).off("mousedown").mousedown(this.grabItem).bind("dragsort-uninit",this.uninit),this.styleDragHandlers(!0)},uninit:function(){var b=d[a(this).attr("data-listidx")];a(b.container).unbind("mousedown",b.grabItem).unbind("dragsort-uninit"),b.styleDragHandlers(!1)},getItems:function(){return a(this.container).children(c.itemSelector)},styleDragHandlers:function(b){this.getItems().map(function(){return a(this).is(c.dragSelector)?this:a(this).find(c.dragSelector).get()}).css("cursor",b?"pointer":"")},grabItem:function(b){var e=b.currentTarget;if(!(1!=b.which||a(e).is(c.dragSelectorExclude)||a(e).closest(c.dragSelectorExclude).size()>0||0==a(e).closest(c.itemSelector).size())){for(b.stopPropagation(),b.preventDefault();!a(e).is(c.dragSelector);){if(e==this)return;e=e.parentNode}a(e).attr("data-cursor",a(e).css("cursor")),a(e).css("cursor","move");var f=d[a(this).attr("data-listidx")],g=this,h=function(){f.dragStart.call(g,b),a(f.container).unbind("mousemove",h)};a(f.container).mousemove(h).mouseup(function(){a(f.container).unbind("mousemove",h),a(e).css("cursor",a(e).attr("data-cursor"))})}},dragStart:function(b){null!=e&&null!=e.draggedItem&&e.dropItem(),e=d[a(this).attr("data-listidx")],e.draggedItem=a(b.currentTarget).closest(c.itemSelector),e.draggedItem.attr("data-origpos",a(this).attr("data-listidx")+"-"+e.getItems().index(e.draggedItem));var f=parseInt(e.draggedItem.css("marginTop")),g=parseInt(e.draggedItem.css("marginLeft"));if(e.offset=e.draggedItem.offset(),e.offset.top=b.pageY-e.offset.top+(isNaN(f)?0:f)-1,e.offset.left=b.pageX-e.offset.left+(isNaN(g)?0:g)-1,!c.dragBetween){var h=0==a(e.container).outerHeight()?Math.max(1,Math.round(.5+e.getItems().size()*e.draggedItem.outerWidth()/a(e.container).outerWidth()))*e.draggedItem.outerHeight():a(e.container).outerHeight();e.offsetLimit=a(e.container).offset(),e.offsetLimit.right=e.offsetLimit.left+a(e.container).outerWidth()-e.draggedItem.outerWidth(),e.offsetLimit.bottom=e.offsetLimit.top+h-e.draggedItem.outerHeight()}var i=e.draggedItem.height(),j=e.draggedItem.width();if("tr"==c.itemSelector?(e.draggedItem.children().each(function(){a(this).width(a(this).width())}),e.placeHolderItem=e.draggedItem.clone().attr("data-placeholder",!0),e.draggedItem.after(e.placeHolderItem),e.placeHolderItem.children().each(function(){a(this).css({borderWidth:0,width:a(this).width()+1,height:a(this).height()+1}).html("&nbsp;")})):(e.draggedItem.after(c.placeHolderTemplate),e.placeHolderItem=e.draggedItem.next().css({height:i,width:j}).attr("data-placeholder",!0)),"td"==c.itemSelector){var k=e.draggedItem.closest("table").get(0);a("<table id='"+k.id+"' style='border-width: 0px;' class='dragSortItem "+k.className+"'><tr></tr></table>").appendTo("body").children().append(e.draggedItem)}var l=e.draggedItem.attr("style");e.draggedItem.attr("data-origstyle",l?l:""),e.draggedItem.css({position:"absolute",opacity:.8,"z-index":999,height:i,width:j}),e.scroll={moveX:0,moveY:0,maxX:a(document).width()-a(window).width(),maxY:a(document).height()-a(window).height()},e.scroll.scrollY=window.setInterval(function(){if(c.scrollContainer!=window)return void a(c.scrollContainer).scrollTop(a(c.scrollContainer).scrollTop()+e.scroll.moveY);var b=a(c.scrollContainer).scrollTop();(e.scroll.moveY>0&&b<e.scroll.maxY||e.scroll.moveY<0&&b>0)&&(a(c.scrollContainer).scrollTop(b+e.scroll.moveY),e.draggedItem.css("top",e.draggedItem.offset().top+e.scroll.moveY+1))},10),e.scroll.scrollX=window.setInterval(function(){if(c.scrollContainer!=window)return void a(c.scrollContainer).scrollLeft(a(c.scrollContainer).scrollLeft()+e.scroll.moveX);var b=a(c.scrollContainer).scrollLeft();(e.scroll.moveX>0&&b<e.scroll.maxX||e.scroll.moveX<0&&b>0)&&(a(c.scrollContainer).scrollLeft(b+e.scroll.moveX),e.draggedItem.css("left",e.draggedItem.offset().left+e.scroll.moveX+1))},10),a(d).each(function(a,b){b.createDropTargets(),b.buildPositionTable()}),e.setPos(b.pageX,b.pageY),a(document).bind("mousemove",e.swapItems),a(document).bind("mouseup",e.dropItem),c.scrollContainer!=window&&a(window).bind("DOMMouseScroll mousewheel",e.wheel)},setPos:function(b,d){var f=d-this.offset.top,g=b-this.offset.left;if(c.dragBetween||(f=Math.min(this.offsetLimit.bottom,Math.max(f,this.offsetLimit.top)),g=Math.min(this.offsetLimit.right,Math.max(g,this.offsetLimit.left))),this.draggedItem.parents().each(function(){if("static"!=a(this).css("position")&&(!a.browser.mozilla||"table"!=a(this).css("display"))){var b=a(this).offset();return f-=b.top,g-=b.left,!1}}),c.scrollContainer==window)d-=a(window).scrollTop(),b-=a(window).scrollLeft(),d=Math.max(0,d-a(window).height()+5)+Math.min(0,d-5),b=Math.max(0,b-a(window).width()+5)+Math.min(0,b-5);else{var h=a(c.scrollContainer),i=h.offset();d=Math.max(0,d-h.height()-i.top)+Math.min(0,d-i.top),b=Math.max(0,b-h.width()-i.left)+Math.min(0,b-i.left)}e.scroll.moveX=0==b?0:b*c.scrollSpeed/Math.abs(b),e.scroll.moveY=0==d?0:d*c.scrollSpeed/Math.abs(d),this.draggedItem.css({top:f,left:g})},wheel:function(b){if((a.browser.safari||a.browser.mozilla)&&e&&c.scrollContainer!=window){var d=a(c.scrollContainer),f=d.offset();if(b.pageX>f.left&&b.pageX<f.left+d.width()&&b.pageY>f.top&&b.pageY<f.top+d.height()){var g=b.detail?5*b.detail:b.wheelDelta/-2;d.scrollTop(d.scrollTop()+g),b.preventDefault()}}},buildPositionTable:function(){var b=[];this.getItems().not([e.draggedItem[0],e.placeHolderItem[0]]).each(function(c){var d=a(this).offset();d.right=d.left+a(this).outerWidth(),d.bottom=d.top+a(this).outerHeight(),d.elm=this,b[c]=d}),this.pos=b},dropItem:function(){if(null!=e.draggedItem){var b=e.draggedItem.attr("data-origstyle");return e.draggedItem.attr("style",b),""==b&&e.draggedItem.removeAttr("style"),e.draggedItem.removeAttr("data-origstyle"),e.styleDragHandlers(!0),e.placeHolderItem.before(e.draggedItem),e.placeHolderItem.remove(),a("[data-droptarget], .dragSortItem").remove(),window.clearInterval(e.scroll.scrollY),window.clearInterval(e.scroll.scrollX),e.draggedItem.attr("data-origpos")!=a(d).index(e)+"-"+e.getItems().index(e.draggedItem)&&c.dragEnd.apply(e.draggedItem),c.callback&&c.callback.apply(e.draggedItem),e.draggedItem.removeAttr("data-origpos"),e.draggedItem=null,a(document).unbind("mousemove",e.swapItems),a(document).unbind("mouseup",e.dropItem),c.scrollContainer!=window&&a(window).unbind("DOMMouseScroll mousewheel",e.wheel),!1}},swapItems:function(b){if(null==e.draggedItem)return!1;e.setPos(b.pageX,b.pageY);for(var g=e.findPos(b.pageX,b.pageY),h=e,i=0;g==-1&&c.dragBetween&&i<d.length;i++)g=d[i].findPos(b.pageX,b.pageY),h=d[i];if(g==-1)return!1;var j=function(){return a(h.container).children().not(h.draggedItem)},k=j().not(c.itemSelector).each(function(a){this.idx=j().index(this)});return null==f||f.top>e.draggedItem.offset().top||f.left>e.draggedItem.offset().left?a(h.pos[g].elm).before(e.placeHolderItem):a(h.pos[g].elm).after(e.placeHolderItem),k.each(function(){var b=j().eq(this.idx).get(0);this!=b&&j().index(this)<this.idx?a(this).insertAfter(b):this!=b&&a(this).insertBefore(b)}),a(d).each(function(a,b){b.createDropTargets(),b.buildPositionTable()}),f=e.draggedItem.offset(),!1},findPos:function(a,b){for(var c=0;c<this.pos.length;c++)if(this.pos[c].left<a&&this.pos[c].right>a&&this.pos[c].top<b&&this.pos[c].bottom>b)return c;return-1},createDropTargets:function(){c.dragBetween&&a(d).each(function(){var b=a(this.container).find("[data-placeholder]"),d=a(this.container).find("[data-droptarget]");b.size()>0&&d.size()>0?d.remove():0==b.size()&&0==d.size()&&("td"==c.itemSelector?a(c.placeHolderTemplate).attr("data-droptarget",!0).appendTo(this.container):a(this.container).append(e.placeHolderItem.removeAttr("data-placeholder").clone().attr("data-droptarget",!0)),e.placeHolderItem.attr("data-placeholder",!0))})}};h.init(),d.push(h)};return this.each(function(a,b){g(a,b)}),b&&b.refresh&&b.refresh===!0?void 0:this},a.fn.dragsort.defaults={itemSelector:"",dragSelector:"",dragSelectorExclude:"input, textarea",dragEnd:function(){},dragBetween:!1,placeHolderTemplate:"",scrollContainer:window,scrollSpeed:5}}(jQuery),function(a){a.fn.drag=function(b,c,d){var e="string"==typeof b?b:"",f=a.isFunction(b)?b:a.isFunction(c)?c:null;return 0!==e.indexOf("drag")&&(e="drag"+e),d=(b==f?c:d)||{},f?this.bind(e,d,f):this.trigger(e)};var b=a.event,c=b.special,d=c.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(b){var c=a.data(this,d.datakey),e=b.data||{};c.related+=1,a.each(d.defaults,function(a,b){void 0!==e[a]&&(c[a]=e[a])})},remove:function(){a.data(this,d.datakey).related-=1},setup:function(){if(!a.data(this,d.datakey)){var c=a.extend({related:0},d.defaults);a.data(this,d.datakey,c),b.add(this,"touchstart mousedown",d.init,c),this.attachEvent&&this.attachEvent("ondragstart",d.dontstart)}},teardown:function(){var c=a.data(this,d.datakey)||{};c.related||(a.removeData(this,d.datakey),b.remove(this,"touchstart mousedown",d.init),d.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",d.dontstart))},init:function(e){if(!d.touched){var f,g=e.data;0!=e.which&&g.which>0&&e.which!=g.which||a(e.target).is(g.not)||g.handle&&!a(e.target).closest(g.handle,e.currentTarget).length||(d.touched="touchstart"==e.type?this:null,g.propagates=1,g.mousedown=this,g.interactions=[d.interaction(this,g)],g.target=e.target,g.pageX=e.pageX,g.pageY=e.pageY,g.dragging=null,f=d.hijack(e,"draginit",g),g.propagates&&(f=d.flatten(f),f&&f.length&&(g.interactions=[],a.each(f,function(){g.interactions.push(d.interaction(this,g))})),g.propagates=g.interactions.length,g.drop!==!1&&c.drop&&c.drop.handler(e,g),d.textselect(!1),d.touched?b.add(d.touched,"touchmove touchend",d.handler,g):b.add(document,"mousemove mouseup",d.handler,g)))}},interaction:function(b,c){var e=a(b)[c.relative?"position":"offset"]()||{top:0,left:0};return{drag:b,callback:new d.callback,droppable:[],offset:e}},handler:function(e){var f=e.data;switch(e.type){case!f.dragging&&"touchmove":e.preventDefault();case!f.dragging&&"mousemove":if(Math.pow(e.pageX-f.pageX,2)+Math.pow(e.pageY-f.pageY,2)<Math.pow(f.distance,2))break;e.target=f.target,d.hijack(e,"dragstart",f),f.propagates&&(f.dragging=!0);case"touchmove":e.preventDefault();case"mousemove":if(f.dragging){if(d.hijack(e,"drag",f),f.propagates){f.drop!==!1&&c.drop&&c.drop.handler(e,f);break}e.type="mouseup"}case"touchend":case"mouseup":default:d.touched?b.remove(d.touched,"touchmove touchend",d.handler):b.remove(document,"mousemove mouseup",d.handler),f.dragging&&(f.drop!==!1&&c.drop&&c.drop.handler(e,f),d.hijack(e,"dragend",f)),d.textselect(!0),f.click===!1&&f.dragging&&a.data(f.mousedown,"suppress.click",(new Date).getTime()+5),f.dragging=d.touched=!1}},hijack:function(c,e,f,g,h){if(f){var i,j,k,l={event:c.originalEvent,type:c.type},m=e.indexOf("drop")?"drag":"drop",n=g||0,o=isNaN(g)?f.interactions.length:g;c.type=e,c.originalEvent=null,f.results=[];do if(j=f.interactions[n]){if("dragend"!==e&&j.cancelled)continue;k=d.properties(c,f,j),j.results=[],a(h||j[m]||f.droppable).each(function(g,h){if(k.target=h,c.isPropagationStopped=function(){return!1},i=h?b.dispatch.call(h,c,k):null,i===!1?("drag"==m&&(j.cancelled=!0,f.propagates-=1),"drop"==e&&(j[m][g]=null)):"dropinit"==e&&j.droppable.push(d.element(i)||h),"dragstart"==e&&(j.proxy=a(d.element(i)||j.drag)[0]),j.results.push(i),delete c.result,"dropinit"!==e)return i}),j.results.length>0&&"idle"!=j.results[0]&&(f.results[n]=d.flatten(j.results)),"dropinit"==e&&(j.droppable=d.flatten(j.droppable)),"dragstart"!=e||j.cancelled||k.update()}while(++n<o);return c.type=l.type,c.originalEvent=l.event,d.flatten(f.results)}},properties:function(a,b,c){var e=c.callback;return e.drag=c.drag,e.proxy=c.proxy||c.drag,e.startX=b.pageX,e.startY=b.pageY,e.deltaX=a.pageX-b.pageX,e.deltaY=a.pageY-b.pageY,e.originalX=c.offset.left,e.originalY=c.offset.top,e.offsetX=e.originalX+e.deltaX,e.offsetY=e.originalY+e.deltaY,e.drop=d.flatten((c.drop||[]).slice()),e.available=d.flatten((c.droppable||[]).slice()),e},element:function(a){if(a&&(a.jquery||1==a.nodeType))return a},flatten:function(b){return a.map(b,function(b){return b&&b.jquery?a.makeArray(b):b&&b.length?d.flatten(b):b})},textselect:function(b){a(document)[b?"unbind":"bind"]("selectstart",d.dontstart).css("MozUserSelect",b?"":"none"),document.unselectable=b?"off":"on"},dontstart:function(){return!1},callback:function(){}};d.callback.prototype={update:function(){c.drop&&this.available.length&&a.each(this.available,function(a){c.drop.locate(this,a)})}};var e=b.dispatch;b.dispatch=function(b){return a.data(this,"suppress."+b.type)-(new Date).getTime()>0?void a.removeData(this,"suppress."+b.type):e.apply(this,arguments)};var f=b.fixHooks.touchstart=b.fixHooks.touchmove=b.fixHooks.touchend=b.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(b,c){if(c){var d=c.touches&&c.touches[0]||c.changedTouches&&c.changedTouches[0]||null;d&&a.each(f.props,function(a,c){b[c]=d[c]})}return b}};c.draginit=c.dragstart=c.dragend=d}(jQuery),function(a){var b=a.event,c=b.special.drag,d=c.add,e=c.teardown;c.noBubble=!1,c.livekey="livedrag",c.add=function(e){d.apply(this,arguments);var f=a.data(this,c.datakey);!f.live&&e.selector&&(f.live=!0,b.add(this,"draginit."+c.livekey,c.delegate))},c.teardown=function(){e.apply(this,arguments);var d=a.data(this,c.datakey)||{};d.live&&(b.remove(this,"draginit."+c.livekey,c.delegate),d.live=!1)},c.delegate=function(d){var e,f=[],g=a.data(this,"events")||{};return a.each(g||[],function(g,h){0===g.indexOf("drag")&&a.each(h||[],function(g,h){e=a(d.target).closest(h.selector,d.currentTarget)[0],e&&(b.add(e,h.origType+"."+c.livekey,h.origHandler||h.handler,h.data),a.inArray(e,f)<0&&f.push(e))})}),!!f.length&&a(f).bind("dragend."+c.livekey,function(){b.remove(this,"."+c.livekey)})}}(jQuery),function(a){a.fn.drop=function(b,c,d){var e="string"==typeof b?b:"",f=a.isFunction(b)?b:a.isFunction(c)?c:null;return 0!==e.indexOf("drop")&&(e="drop"+e),d=(b==f?c:d)||{},f?this.bind(e,d,f):this.trigger(e)},a.drop=function(b){b=b||{},d.multi=b.multi===!0?1/0:b.multi===!1?1:isNaN(b.multi)?d.multi:b.multi,d.delay=b.delay||d.delay,d.tolerance=a.isFunction(b.tolerance)?b.tolerance:null===b.tolerance?null:d.tolerance,d.mode=b.mode||d.mode||"intersect"};var b=a.event,c=b.special,d=a.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(b){var c=a.data(this,d.datakey);c.related+=1},remove:function(){a.data(this,d.datakey).related-=1},setup:function(){if(!a.data(this,d.datakey)){var b={related:0,active:[],anyactive:0,winner:0,location:{}};a.data(this,d.datakey,b),d.targets.push(this)}},teardown:function(){var b=a.data(this,d.datakey)||{};if(!b.related){a.removeData(this,d.datakey);var c=this;d.targets=a.grep(d.targets,function(a){return a!==c})}},handler:function(b,e){var f;if(e)switch(b.type){case"mousedown":case"touchstart":f=a(d.targets),"string"==typeof e.drop&&(f=f.filter(e.drop)),f.each(function(){var b=a.data(this,d.datakey);b.active=[],b.anyactive=0,b.winner=0}),e.droppable=f,c.drag.hijack(b,"dropinit",e);break;case"mousemove":case"touchmove":d.event=b,d.timer||d.tolerate(e);break;case"mouseup":case"touchend":d.timer=clearTimeout(d.timer),e.propagates&&(c.drag.hijack(b,"drop",e),c.drag.hijack(b,"dropend",e))}},locate:function(b,c){var e=a.data(b,d.datakey),f=a(b),g=f.offset()||{},h=f.outerHeight(),i=f.outerWidth(),j={elem:b,width:i,height:h,top:g.top,left:g.left,right:g.left+i,bottom:g.top+h};return e&&(e.location=j,e.index=c,e.elem=b),j},contains:function(a,b){return(b[0]||b.left)>=a.left&&(b[0]||b.right)<=a.right&&(b[1]||b.top)>=a.top&&(b[1]||b.bottom)<=a.bottom},modes:{intersect:function(a,b,c){return this.contains(c,[a.pageX,a.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(a,b,c){return Math.max(0,Math.min(c.bottom,b.bottom)-Math.max(c.top,b.top))*Math.max(0,Math.min(c.right,b.right)-Math.max(c.left,b.left))},fit:function(a,b,c){return this.contains(c,b)?1:0},middle:function(a,b,c){return this.contains(c,[b.left+.5*b.width,b.top+.5*b.height])?1:0}},sort:function(a,b){return b.winner-a.winner||a.index-b.index},tolerate:function(b){var e,f,g,h,i,j,k,l,m=0,n=b.interactions.length,o=[d.event.pageX,d.event.pageY],p=d.tolerance||d.modes[d.mode];do if(l=b.interactions[m]){if(!l)return;l.drop=[],i=[],j=l.droppable.length,p&&(g=d.locate(l.proxy)),e=0;do if(k=l.droppable[e]){if(h=a.data(k,d.datakey),f=h.location,!f)continue;h.winner=p?p.call(d,d.event,g,f):d.contains(f,o)?1:0,i.push(h)}while(++e<j);i.sort(d.sort),e=0;do(h=i[e])&&(h.winner&&l.drop.length<d.multi?(h.active[m]||h.anyactive||(c.drag.hijack(d.event,"dropstart",b,m,h.elem)[0]!==!1?(h.active[m]=1,h.anyactive+=1):h.winner=0),h.winner&&l.drop.push(h.elem)):h.active[m]&&1==h.anyactive&&(c.drag.hijack(d.event,"dropend",b,m,h.elem),h.active[m]=0,h.anyactive-=1));while(++e<j)}while(++m<n);d.last&&o[0]==d.last.pageX&&o[1]==d.last.pageY?delete d.timer:d.timer=setTimeout(function(){d.tolerate(b)},d.delay),d.last=d.event}};c.dropinit=c.dropstart=c.dropend=d}(jQuery),function(a){var b=a.event,c=b.special.drop,d=c.add,e=c.teardown;c.noBubble=!1,c.livekey="livedrop",c.add=function(e){d.apply(this,arguments);var f=a.data(this,c.datakey);!f.live&&e.selector&&(f.live=!0,b.add(this,"dropinit."+c.livekey,c.delegate))},c.teardown=function(){e.apply(this,arguments);var d=a.data(this,c.datakey)||{};d.live&&(b.remove(this,"dropinit",c.delegate),d.live=!1)},c.delegate=function(d,e){var f,g=[],h=a.data(this,"events")||{};return a.each(h||[],function(e,h){0===e.indexOf("drop")&&a.each(h,function(e,h){f=a(d.currentTarget).find(h.selector),f.length&&f.each(function(){b.add(this,h.origType+"."+c.livekey,h.origHandler||h.handler,h.data),a.inArray(this,g)<0&&g.push(this)})})}),e&&b.add(e.drag,"dragend."+c.livekey,function(){a.each(g.concat(this),function(){b.remove(this,"."+c.livekey)})}),!!g.length&&a(g)}}(jQuery),jQuery&&function(a){function b(b,c){var d=a('<span class="minicolors" />'),e=a.minicolors.defaultSettings;b.data("minicolors-initialized")||(c=a.extend(!0,{},e,c),d.addClass("minicolors-theme-"+c.theme).addClass("minicolors-swatch-position-"+c.swatchPosition).toggleClass("minicolors-swatch-left","left"===c.swatchPosition).toggleClass("minicolors-with-opacity",c.opacity),void 0!==c.position&&a.each(c.position.split(" "),function(){d.addClass("minicolors-position-"+this)}),b.addClass("minicolors-input").data("minicolors-initialized",!0).data("minicolors-settings",c).prop("size",7).prop("maxlength",7).wrap(d).after('<span class="minicolors-panel minicolors-slider-'+c.control+'"><span class="minicolors-slider"><span class="minicolors-picker"></span></span><span class="minicolors-opacity-slider"><span class="minicolors-picker"></span></span><span class="minicolors-grid"><span class="minicolors-grid-inner"></span><span class="minicolors-picker"><span></span></span></span></span>'),b.parent().find(".minicolors-panel").on("selectstart",function(){return!1}).end(),"left"===c.swatchPosition?b.before('<span class="minicolors-swatch"><span></span></span>'):b.after('<span class="minicolors-swatch"><span></span></span>'),c.textfield||b.addClass("minicolors-hidden"),c.inline&&b.parent().addClass("minicolors-inline"),i(b))}function c(a){var b=a.parent();a.removeData("minicolors-initialized").removeData("minicolors-settings").removeProp("size").removeProp("maxlength").removeClass("minicolors-input"),b.before(a).remove()}function d(a){i(a)}function e(a){var b=a.parent(),c=b.find(".minicolors-panel"),d=a.data("minicolors-settings");!a.data("minicolors-initialized")||a.prop("disabled")||b.hasClass("minicolors-focus")||(f(),b.addClass("minicolors-focus"),c.stop(!0,!0).fadeIn(d.showSpeed,function(){d.show&&d.show.call(a)}))}function f(){a(".minicolors-input").each(function(){var b=a(this),c=b.data("minicolors-settings"),d=b.parent();c.inline||d.find(".minicolors-panel").fadeOut(c.hideSpeed,function(){d.hasClass("minicolors-focus")&&c.hide&&c.hide.call(b),d.removeClass("minicolors-focus")})})}function g(a,b,c){var d,e,f,g,i=a.parents(".minicolors").find(".minicolors-input"),j=i.data("minicolors-settings"),k=a.find("[class$=-picker]"),l=a.offset().left,m=a.offset().top,n=Math.round(b.pageX-l),o=Math.round(b.pageY-m),p=c?j.animationSpeed:0;b.originalEvent.changedTouches&&(n=b.originalEvent.changedTouches[0].pageX-l,o=b.originalEvent.changedTouches[0].pageY-m),n<0&&(n=0),o<0&&(o=0),n>a.width()&&(n=a.width()),o>a.height()&&(o=a.height()),a.parent().is(".minicolors-slider-wheel")&&k.parent().is(".minicolors-grid")&&(d=75-n,e=75-o,f=Math.sqrt(d*d+e*e),g=Math.atan2(e,d),g<0&&(g+=2*Math.PI),f>75&&(f=75,n=75-75*Math.cos(g),o=75-75*Math.sin(g)),n=Math.round(n),o=Math.round(o)),a.is(".minicolors-grid")?k.stop(!0).animate({top:o+"px",left:n+"px"},p,j.animationEasing,function(){h(i)}):k.stop(!0).animate({top:o+"px"},p,j.animationEasing,function(){h(i)})}function h(a){function b(a,b){var c,d;return a.length&&b?(c=a.offset().left,d=a.offset().top,{x:c-b.offset().left+a.outerWidth()/2,y:d-b.offset().top+a.outerHeight()/2}):null}var c,d,e,f,g,h,i,j,k,m=a.parent(),o=a.data("minicolors-settings"),p=(m.find(".minicolors-panel"),m.find(".minicolors-swatch")),r=m.find(".minicolors-grid"),s=m.find(".minicolors-slider"),t=m.find(".minicolors-opacity-slider"),u=r.find("[class$=-picker]"),v=s.find("[class$=-picker]"),w=t.find("[class$=-picker]"),x=b(u,r),y=b(v,s),z=b(w,t);switch(o.control){case"wheel":h=r.width()/2-x.x,i=r.height()/2-x.y,j=Math.sqrt(h*h+i*i),k=Math.atan2(i,h),k<0&&(k+=2*Math.PI),j>75&&(j=75,x.x=69-75*Math.cos(k),x.y=69-75*Math.sin(k)),d=n(j/.75,0,100),c=n(180*k/Math.PI,0,360),e=n(100-Math.floor(y.y*(100/s.height())),0,100),g=q({h:c,s:d,b:e}),s.css("backgroundColor",q({h:c,s:d,b:100}));break;case"saturation":c=n(parseInt(x.x*(360/r.width())),0,360),d=n(100-Math.floor(y.y*(100/s.height())),0,100),e=n(100-Math.floor(x.y*(100/r.height())),0,100),g=q({h:c,s:d,b:e}),s.css("backgroundColor",q({h:c,s:100,b:e})),m.find(".minicolors-grid-inner").css("opacity",d/100);break;case"brightness":c=n(parseInt(x.x*(360/r.width())),0,360),d=n(100-Math.floor(x.y*(100/r.height())),0,100),e=n(100-Math.floor(y.y*(100/s.height())),0,100),g=q({h:c,s:d,b:e}),s.css("backgroundColor",q({h:c,s:d,b:100})),m.find(".minicolors-grid-inner").css("opacity",1-e/100);break;default:c=n(360-parseInt(y.y*(360/s.height())),0,360),d=n(Math.floor(x.x*(100/r.width())),0,100),e=n(100-Math.floor(x.y*(100/r.height())),0,100),g=q({h:c,s:d,b:e}),r.css("backgroundColor",q({h:c,s:100,b:100}))}f=o.opacity?parseFloat(1-z.y/t.height()).toFixed(2):1,a.val(l(g,o.letterCase)),o.opacity&&a.attr("data-opacity",f),p.find("SPAN").css({backgroundColor:g,opacity:f}),g+f!==a.data("minicolors-lastChange")&&(a.data("minicolors-lastChange",g+f),o.change&&(o.changeDelay?(clearTimeout(a.data("minicolors-changeTimeout")),a.data("minicolors-changeTimeout",setTimeout(function(){o.change.call(a,g,f)},o.changeDelay))):o.change.call(a,g,f)))}function i(a,b){var c,d,e,f,g,h,i,j=a.parent(),k=a.data("minicolors-settings"),o=j.find(".minicolors-swatch"),p=j.find(".minicolors-grid"),s=j.find(".minicolors-slider"),t=j.find(".minicolors-opacity-slider"),u=p.find("[class$=-picker]"),v=s.find("[class$=-picker]"),w=t.find("[class$=-picker]");switch(c=l(m(a.val(),!0),k.letterCase),c||(c=l(m(k.defaultValue,!0))),d=r(c),b||a.val(c),k.opacity&&(e=""===a.attr("data-opacity")?1:n(parseFloat(a.attr("data-opacity")).toFixed(2),0,1),a.attr("data-opacity",e),o.find("SPAN").css("opacity",e),g=n(t.height()-t.height()*e,0,t.height()),w.css("top",g+"px")),o.find("SPAN").css("backgroundColor",c),k.control){case"wheel":h=n(Math.ceil(.75*d.s),0,p.height()/2),i=d.h*Math.PI/180,f=n(75-Math.cos(i)*h,0,p.width()),g=n(75-Math.sin(i)*h,0,p.height()),u.css({top:g+"px",left:f+"px"}),g=150-d.b/(100/p.height()),""===c&&(g=0),v.css("top",g+"px"),s.css("backgroundColor",q({h:d.h,s:d.s,b:100}));break;case"saturation":f=n(5*d.h/12,0,150),g=n(p.height()-Math.ceil(d.b/(100/p.height())),0,p.height()),u.css({top:g+"px",left:f+"px"}),g=n(s.height()-d.s*(s.height()/100),0,s.height()),v.css("top",g+"px"),s.css("backgroundColor",q({h:d.h,s:100,b:d.b})),j.find(".minicolors-grid-inner").css("opacity",d.s/100);break;case"brightness":f=n(5*d.h/12,0,150),g=n(p.height()-Math.ceil(d.s/(100/p.height())),0,p.height()),u.css({top:g+"px",left:f+"px"}),g=n(s.height()-d.b*(s.height()/100),0,s.height()),v.css("top",g+"px"),s.css("backgroundColor",q({h:d.h,s:d.s,b:100})),j.find(".minicolors-grid-inner").css("opacity",1-d.b/100);break;default:f=n(Math.ceil(d.s/(100/p.width())),0,p.width()),g=n(p.height()-Math.ceil(d.b/(100/p.height())),0,p.height()),u.css({top:g+"px",left:f+"px"}),g=n(s.height()-d.h/(360/s.height()),0,s.height()),v.css("top",g+"px"),p.css("backgroundColor",q({h:d.h,s:100,b:100}))}}function j(b){var c=m(a(b).val(),!0),d=t(c),e=a(b).attr("data-opacity");return d?(void 0!==e&&a.extend(d,{a:parseFloat(e)}),d):null}function k(b,c){var d=m(a(b).val(),!0),e=t(d),f=a(b).attr("data-opacity");return e?(void 0===f&&(f=1),c?"rgba("+e.r+", "+e.g+", "+e.b+", "+parseFloat(f)+")":"rgb("+e.r+", "+e.g+", "+e.b+")"):null}function l(a,b){return"uppercase"===b?a.toUpperCase():a.toLowerCase()}function m(a,b){return a=a.replace(/[^A-F0-9]/gi,""),3!==a.length&&6!==a.length?"":(3===a.length&&b&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),"#"+a)}function n(a,b,c){return a<b&&(a=b),a>c&&(a=c),a}function o(a){var b={},c=Math.round(a.h),d=Math.round(255*a.s/100),e=Math.round(255*a.b/100);if(0===d)b.r=b.g=b.b=e;else{var f=e,g=(255-d)*e/255,h=(f-g)*(c%60)/60;360===c&&(c=0),c<60?(b.r=f,b.b=g,b.g=g+h):c<120?(b.g=f,b.b=g,b.r=f-h):c<180?(b.g=f,b.r=g,b.b=g+h):c<240?(b.b=f,b.r=g,b.g=f-h):c<300?(b.b=f,b.g=g,b.r=g+h):c<360?(b.r=f,b.g=g,b.b=f-h):(b.r=0,b.g=0,b.b=0)}return{r:Math.round(b.r),g:Math.round(b.g),b:Math.round(b.b)}}function p(b){var c=[b.r.toString(16),b.g.toString(16),b.b.toString(16)];return a.each(c,function(a,b){1===b.length&&(c[a]="0"+b)}),"#"+c.join("")}function q(a){return p(o(a))}function r(a){var b=s(t(a));return 0===b.s&&(b.h=360),b}function s(a){var b={h:0,s:0,b:0},c=Math.min(a.r,a.g,a.b),d=Math.max(a.r,a.g,a.b),e=d-c;return b.b=d,b.s=0!==d?255*e/d:0,0!==b.s?a.r===d?b.h=(a.g-a.b)/e:a.g===d?b.h=2+(a.b-a.r)/e:b.h=4+(a.r-a.g)/e:b.h=-1,b.h*=60,b.h<0&&(b.h+=360),b.s*=100/255,b.b*=100/255,b}function t(a){return a=parseInt(a.indexOf("#")>-1?a.substring(1):a,16),{r:a>>16,g:(65280&a)>>8,b:255&a}}a.minicolors={defaultSettings:{animationSpeed:100,animationEasing:"swing",change:null,changeDelay:0,control:"hue",defaultValue:"",hide:null,hideSpeed:100,inline:!1,letterCase:"lowercase",opacity:!1,position:"default",show:null,showSpeed:100,swatchPosition:"left",textfield:!0,theme:"default"}},a.extend(a.fn,{minicolors:function(e,f){switch(e){case"destroy":return a(this).each(function(){c(a(this))}),a(this);case"opacity":return void 0===f?a(this).attr("data-opacity"):(a(this).each(function(){d(a(this).attr("data-opacity",f))}),a(this));case"rgbObject":return j(a(this),"rgbaObject"===e);case"rgbString":case"rgbaString":return k(a(this),"rgbaString"===e);case"settings":return void 0===f?a(this).data("minicolors-settings"):(a(this).each(function(){var b=a(this).data("minicolors-settings")||{};c(a(this)),a(this).minicolors(a.extend(!0,b,f))}),a(this));case"value":return void 0===f?a(this).val():(a(this).each(function(){d(a(this).val(f))}),a(this));case"create":default:return"create"!==e&&(f=e),a(this).each(function(){b(a(this),f)}),a(this)}}}),a(document).on("mousedown.minicolors touchstart.minicolors",function(b){a(b.target).parents().add(b.target).hasClass("minicolors")||f()}).on("mousedown.minicolors touchstart.minicolors",".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider",function(b){var c=a(this);b.preventDefault(),a(document).data("minicolors-target",c),g(c,b,!0)}).on("mousemove.minicolors touchmove.minicolors",function(b){var c=a(document).data("minicolors-target");c&&g(c,b)}).on("mouseup.minicolors touchend.minicolors",function(){a(this).removeData("minicolors-target")}).on("mousedown.minicolors touchstart.minicolors",".minicolors-swatch",function(b){var c=a(this).parent().find(".minicolors-input"),d=c.parent();d.hasClass("minicolors-focus")?f(c):e(c)}).on("focus.minicolors",".minicolors-input",function(b){var c=a(this);c.data("minicolors-initialized")&&e(c)}).on("blur.minicolors",".minicolors-input",function(b){var c=a(this),d=c.data("minicolors-settings");c.data("minicolors-initialized")&&(c.val(m(c.val(),!0)),""===c.val()&&c.val(m(d.defaultValue,!0)),c.val(l(c.val(),d.letterCase)),f(c))}).on("keydown.minicolors",".minicolors-input",function(b){var c=a(this);if(c.data("minicolors-initialized"))switch(b.keyCode){case 9:f();break;case 27:f(),c.blur()}}).on("keyup.minicolors",".minicolors-input",function(b){var c=a(this);c.data("minicolors-initialized")&&i(c,!0)}).on("paste.minicolors",".minicolors-input",function(b){var c=a(this);c.data("minicolors-initialized")&&setTimeout(function(){i(c,!0)},1)})}(jQuery),function(a){function b(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=0,g=0;return b=a.event.fix(c),b.type="mousewheel",
c.wheelDelta&&(e=c.wheelDelta/120),c.detail&&(e=-c.detail/3),g=e,void 0!==c.axis&&c.axis===c.HORIZONTAL_AXIS&&(g=0,f=-1*e),void 0!==c.wheelDeltaY&&(g=c.wheelDeltaY/120),void 0!==c.wheelDeltaX&&(f=-1*c.wheelDeltaX/120),d.unshift(b,e,f,g),(a.event.dispatch||a.event.handle).apply(this,d)}var c=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var d=c.length;d;)a.event.fixHooks[c[--d]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=c.length;a;)this.addEventListener(c[--a],b,!1);else this.onmousewheel=b},teardown:function(){if(this.removeEventListener)for(var a=c.length;a;)this.removeEventListener(c[--a],b,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}(jQuery),function(){window.limitation=function(a){var b=this;this.parentContainer=a,this.limitationH3=$("<h3></h3>"),this.limitationHeader=this.parentContainer.find(".limitation-header"),this.limitationHeader.html(this.limitationH3),this.limitationBody=this.parentContainer.find(".limitation-body"),this.limitationButton=this.parentContainer.find(".limitation-footer button"),this.addContent(),this.limitationButton.on("click",function(){window.BSLimitationPopinRedirect(),loggedUser.setNewTimeout(3),b.activateControlsMenuItems()})}}(),limitation.prototype.addContent=function(){var a=loggedUser&&loggedUser.serviceType?loggedUser.serviceType:"free";a=a.charAt(0).toUpperCase()+a.slice(1);var b="This feature is not available in the "+a+" Plan",c="<p>For the existing premium elements in your banner we've disabled the Edit and Customize options.</p><p>You can get access to this feature by upgrading your membership.</p>",d="Upgrade";this.limitationH3.text(b),this.limitationBody.html(c),this.limitationButton.text(d)},limitation.activateControlsMenuItems=function(){var a=this,b=null;b=setInterval(function(){if(userData.serviceType!==loggedUser.serviceType){var c=loggedUser&&loggedUser.featuresAccess;if(!c)return!1;for(var d=$("#controls").children(),e=0;e<d.length;e++){var f=$(d[e]);(f.hasClass("control-add-menu")&&"yes"==c.bm_menu||f.hasClass("control-add-video")&&"yes"==c.bm_video||f.hasClass("control-add-embed")&&"yes"==c.bm_embed_elements)&&f.hasClass("feature-limited")&&(f.removeClass("feature-limited"),f.find("sup").remove())}a.refreshElement(),clearInterval(b)}},500)},limitation.refreshElement=function(){var a=editor.stage.$el;a.click()},function(){function a(b,c){return{x:b||0,y:c||0,equal:function(a){return this.x===a.x&&this.y===a.y},add:function(b){return a(this.x+b.x,this.y+b.y)},subtract:function(b){return a(this.x-b.x,this.y-b.y)},scale:function(b){return a(this.x*b,this.y*b)},magnitude:function(){return a.distance(a(0,0),this)}}}function b(c,d,e,f,g,h){return c=void 0!==c?c:1,f=void 0!==f?f:1,{a:c,b:d||0,c:e||0,d:f,tx:g||0,ty:h||0,concat:function(a){return b(this.a*a.a+this.c*a.b,this.b*a.a+this.d*a.b,this.a*a.c+this.c*a.d,this.b*a.c+this.d*a.d,this.a*a.tx+this.c*a.ty+this.tx,this.b*a.tx+this.d*a.ty+this.ty)},deltaTransformPoint:function(b){return a(this.a*b.x+this.c*b.y,this.b*b.x+this.d*b.y)},inverse:function(){var a=this.a*this.d-this.b*this.c;return b(this.d/a,-this.b/a,-this.c/a,this.a/a,(this.c*this.ty-this.d*this.tx)/a,(this.b*this.tx-this.a*this.ty)/a)},rotate:function(a,c){return this.concat(b.rotation(a,c))},scale:function(a,c,d){return this.concat(b.scale(a,c,d))},transformPoint:function(b){return a(this.a*b.x+this.c*b.y+this.tx,this.b*b.x+this.d*b.y+this.ty)},translate:function(a,c){return this.concat(b.translation(a,c))}}}a.distance=function(a,b){return Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2))},a.direction=function(a,b){return Math.atan2(b.y-a.y,b.x-a.x)},b.rotation=function(a,c){var d=b(Math.cos(a),Math.sin(a),-Math.sin(a),Math.cos(a));return c&&(d=b.translation(c.x,c.y).concat(d).concat(b.translation(-c.x,-c.y))),d},b.scale=function(a,c,d){c=c||a;var e=b(a,0,0,c);return d&&(e=b.translation(d.x,d.y).concat(e).concat(b.translation(-d.x,-d.y))),e},b.translation=function(a,c){return b(1,0,0,1,a,c)},b.IDENTITY=b(),b.HORIZONTAL_FLIP=b(-1,0,0,1),b.VERTICAL_FLIP=b(1,0,0,-1),window.Point=a,window.Matrix=b}();var mobileArray=["Mobile","Android","Kindle","Silk","iPod","iPad","iPhone","BlackBerry","PlayBook","RIM","Tablet"],noFontFace=["Windows Phone","IEMobile","BlackBerry","BlackBerry","PlayBook","RIM","Tablet"];window.MOBILE=navigator.userAgent.match(/mobile/i);